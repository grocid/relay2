/* main_window.c generated by valac 0.34.4, the Vala compiler
 * generated from main_window.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: t; c-basic-offset: 4; tab-width: 4 -*-  */
/*
 * main_window.vala
 * Copyright (C) 2015 Kyle Agronick <stack@kyle-ele>
 *
 * KyRC is free software: you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the
 * Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * KyRC is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <glib.h>
#include <glib-object.h>
#include <granite.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <gee.h>
#include <gio/gio.h>
#include <unity.h>
#include "config.h"
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gdk/gdk.h>
#include <glib/gi18n-lib.h>
#include <pango/pango.h>
#include <math.h>
#include <float.h>
#include <glib/gstdio.h>


#define TYPE_MAIN_WINDOW (main_window_get_type ())
#define MAIN_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_MAIN_WINDOW, MainWindow))
#define MAIN_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_MAIN_WINDOW, MainWindowClass))
#define IS_MAIN_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_MAIN_WINDOW))
#define IS_MAIN_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_MAIN_WINDOW))
#define MAIN_WINDOW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_MAIN_WINDOW, MainWindowClass))

typedef struct _MainWindow MainWindow;
typedef struct _MainWindowClass MainWindowClass;
typedef struct _MainWindowPrivate MainWindowPrivate;

#define TYPE_RELAY (relay_get_type ())
#define RELAY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_RELAY, Relay))
#define RELAY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_RELAY, RelayClass))
#define IS_RELAY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_RELAY))
#define IS_RELAY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_RELAY))
#define RELAY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_RELAY, RelayClass))

typedef struct _Relay Relay;
typedef struct _RelayClass RelayClass;

#define TYPE_DRAG_FILE (drag_file_get_type ())
#define DRAG_FILE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_DRAG_FILE, DragFile))
#define DRAG_FILE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_DRAG_FILE, DragFileClass))
#define IS_DRAG_FILE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_DRAG_FILE))
#define IS_DRAG_FILE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_DRAG_FILE))
#define DRAG_FILE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_DRAG_FILE, DragFileClass))

typedef struct _DragFile DragFile;
typedef struct _DragFileClass DragFileClass;

#define TYPE_CHANNEL_TAB (channel_tab_get_type ())
#define CHANNEL_TAB(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CHANNEL_TAB, ChannelTab))
#define CHANNEL_TAB_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CHANNEL_TAB, ChannelTabClass))
#define IS_CHANNEL_TAB(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CHANNEL_TAB))
#define IS_CHANNEL_TAB_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CHANNEL_TAB))
#define CHANNEL_TAB_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CHANNEL_TAB, ChannelTabClass))

typedef struct _ChannelTab ChannelTab;
typedef struct _ChannelTabClass ChannelTabClass;

#define TYPE_CONNECTION (connection_get_type ())
#define CONNECTION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CONNECTION, Connection))
#define CONNECTION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CONNECTION, ConnectionClass))
#define IS_CONNECTION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CONNECTION))
#define IS_CONNECTION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CONNECTION))
#define CONNECTION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CONNECTION, ConnectionClass))

typedef struct _Connection Connection;
typedef struct _ConnectionClass ConnectionClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

#define TYPE_SQL_CLIENT (sql_client_get_type ())
#define SQL_CLIENT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_SQL_CLIENT, SqlClient))
#define SQL_CLIENT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_SQL_CLIENT, SqlClientClass))
#define IS_SQL_CLIENT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_SQL_CLIENT))
#define IS_SQL_CLIENT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_SQL_CLIENT))
#define SQL_CLIENT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_SQL_CLIENT, SqlClientClass))

typedef struct _SqlClient SqlClient;
typedef struct _SqlClientClass SqlClientClass;

#define TYPE_SETTINGS (settings_get_type ())
#define SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_SETTINGS, Settings))
#define SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_SETTINGS, SettingsClass))
#define IS_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_SETTINGS))
#define IS_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_SETTINGS))
#define SETTINGS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_SETTINGS, SettingsClass))

typedef struct _Settings Settings;
typedef struct _SettingsClass SettingsClass;

#define TYPE_SERVER_MANAGER (server_manager_get_type ())
#define SERVER_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_SERVER_MANAGER, ServerManager))
#define SERVER_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_SERVER_MANAGER, ServerManagerClass))
#define IS_SERVER_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_SERVER_MANAGER))
#define IS_SERVER_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_SERVER_MANAGER))
#define SERVER_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_SERVER_MANAGER, ServerManagerClass))

typedef struct _ServerManager ServerManager;
typedef struct _ServerManagerClass ServerManagerClass;

#define TYPE_MAIN_ENTRY (main_entry_get_type ())
#define MAIN_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_MAIN_ENTRY, MainEntry))
#define MAIN_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_MAIN_ENTRY, MainEntryClass))
#define IS_MAIN_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_MAIN_ENTRY))
#define IS_MAIN_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_MAIN_ENTRY))
#define MAIN_ENTRY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_MAIN_ENTRY, MainEntryClass))

typedef struct _MainEntry MainEntry;
typedef struct _MainEntryClass MainEntryClass;
typedef struct _ChannelTabPrivate ChannelTabPrivate;
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))

#define TYPE_MESSAGE (message_get_type ())
#define MESSAGE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_MESSAGE, Message))
#define MESSAGE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_MESSAGE, MessageClass))
#define IS_MESSAGE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_MESSAGE))
#define IS_MESSAGE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_MESSAGE))
#define MESSAGE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_MESSAGE, MessageClass))

typedef struct _Message Message;
typedef struct _MessageClass MessageClass;
typedef struct _Block1Data Block1Data;
typedef struct _Block2Data Block2Data;
typedef struct _Block3Data Block3Data;
typedef struct _ConnectionPrivate ConnectionPrivate;

#define SQL_CLIENT_TYPE_SERVER (sql_client_server_get_type ())
#define SQL_CLIENT_SERVER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SQL_CLIENT_TYPE_SERVER, SqlClientServer))
#define SQL_CLIENT_SERVER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SQL_CLIENT_TYPE_SERVER, SqlClientServerClass))
#define SQL_CLIENT_IS_SERVER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SQL_CLIENT_TYPE_SERVER))
#define SQL_CLIENT_IS_SERVER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SQL_CLIENT_TYPE_SERVER))
#define SQL_CLIENT_SERVER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SQL_CLIENT_TYPE_SERVER, SqlClientServerClass))

typedef struct _SqlClientServer SqlClientServer;
typedef struct _SqlClientServerClass SqlClientServerClass;
#define __vala_PangoFontDescription_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoFontDescription_free (var), NULL)))
#define __vala_PangoTabArray_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoTabArray_free (var), NULL)))
typedef struct _SqlClientServerPrivate SqlClientServerPrivate;

#define SQL_CLIENT_TYPE_CHANNEL (sql_client_channel_get_type ())
#define SQL_CLIENT_CHANNEL(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SQL_CLIENT_TYPE_CHANNEL, SqlClientChannel))
#define SQL_CLIENT_CHANNEL_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SQL_CLIENT_TYPE_CHANNEL, SqlClientChannelClass))
#define SQL_CLIENT_IS_CHANNEL(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SQL_CLIENT_TYPE_CHANNEL))
#define SQL_CLIENT_IS_CHANNEL_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SQL_CLIENT_TYPE_CHANNEL))
#define SQL_CLIENT_CHANNEL_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SQL_CLIENT_TYPE_CHANNEL, SqlClientChannelClass))

typedef struct _SqlClientChannel SqlClientChannel;
typedef struct _SqlClientChannelClass SqlClientChannelClass;
typedef struct _Block4Data Block4Data;
#define _sql_client_server_unref0(var) ((var == NULL) ? NULL : (var = (sql_client_server_unref (var), NULL)))
typedef struct _Block5Data Block5Data;
#define _g_thread_unref0(var) ((var == NULL) ? NULL : (var = (g_thread_unref (var), NULL)))
typedef struct _Block6Data Block6Data;
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))
typedef struct _Block7Data Block7Data;
typedef struct _SqlClientChannelPrivate SqlClientChannelPrivate;
#define _sql_client_channel_unref0(var) ((var == NULL) ? NULL : (var = (sql_client_channel_unref (var), NULL)))
typedef struct _Block8Data Block8Data;
typedef struct _MessagePrivate MessagePrivate;

struct _MainWindow {
	GObject parent_instance;
	MainWindowPrivate * priv;
};

struct _MainWindowClass {
	GObjectClass parent_class;
};

struct _MainWindowPrivate {
	Relay* app;
	GtkPaned* panel;
	GtkMenu* tab_rightclick;
	GtkMenu* tab_channel_list;
	DragFile* drag_file;
	GtkButton* channel_users;
	GtkLabel* subject_text;
	GtkButton* channel_subject;
	GtkHeaderBar* toolbar;
	GtkPopover* users_popover;
	GtkLabel* users_header;
	GtkBox* users_list;
	GtkScrolledWindow* users_scrolled;
	GtkMenu* user_menu;
	gchar* channel_user_selected;
	GtkSearchEntry* users_search;
	GraniteWidgetsDynamicNotebook* tabs;
	GeeHashMap* outputs;
	GeeHashMap* clients;
	GraniteWidgetsSourceList* servers;
	gint invoke_count;
	gint sliding;
};

struct _ChannelTab {
	GObject parent_instance;
	ChannelTabPrivate * priv;
	GraniteWidgetsTab* tab;
	gboolean is_server_tab;
	gboolean has_subject;
	gchar* channel_subject;
	gboolean is_locked;
	GeeLinkedList* users;
	GeeLinkedList* ops;
	GeeLinkedList* half_ops;
	GeeLinkedList* owners;
	GeeLinkedList* blocked_users;
	gint message_count;
	gchar* channel_url;
	gboolean needs_spacer;
};

struct _ChannelTabClass {
	GObjectClass parent_class;
};

struct _Block1Data {
	int _ref_count_;
	MainWindow* self;
	GeeMapEntry* tab;
};

struct _Block2Data {
	int _ref_count_;
	MainWindow* self;
	ChannelTab* new_tab;
	gchar* name;
};

struct _Block3Data {
	int _ref_count_;
	Block2Data * _data2_;
	GtkTextView* output;
};

struct _Connection {
	GObject parent_instance;
	ConnectionPrivate * priv;
	ChannelTab* server_tab;
	GeeHashMap* channel_tabs;
	GeeLinkedList* channel_autoconnect;
	gboolean exit;
	gboolean error_state;
	gboolean autoconnect_ran;
	SqlClientServer* server;
};

struct _ConnectionClass {
	GObjectClass parent_class;
};

struct _SqlClientServer {
	GTypeInstance parent_instance;
	volatile int ref_count;
	SqlClientServerPrivate * priv;
	gint id;
	gchar* host;
	gint port;
	gchar* nickname;
	gchar* realname;
	gchar* username;
	gchar* password;
	gchar* on_connect;
	gboolean encryption;
	gboolean autoconnect;
	gboolean validate_server;
	gchar* connect_cmds;
	GeeLinkedList* channels;
};

struct _SqlClientServerClass {
	GTypeClass parent_class;
	void (*finalize) (SqlClientServer *self);
};

struct _Block4Data {
	int _ref_count_;
	MainWindow* self;
	GtkDialog* dialog;
	GtkEntry* server_name;
};

struct _Block5Data {
	int _ref_count_;
	MainWindow* self;
	gchar* search_str;
};

struct _Block6Data {
	int _ref_count_;
	MainWindow* self;
	gint PER_BOX;
	gint BOX_WIDTH;
	gint MAX_COLS;
	GeeLinkedList* lb_wrappers;
	gint i;
};

struct _Block7Data {
	int _ref_count_;
	MainWindow* self;
	GtkEventBox* eb;
	gchar* user;
};

struct _SqlClientChannel {
	GTypeInstance parent_instance;
	volatile int ref_count;
	SqlClientChannelPrivate * priv;
	gint id;
	gint server_id;
	gchar* channel;
	gboolean autoconnect;
};

struct _SqlClientChannelClass {
	GTypeClass parent_class;
	void (*finalize) (SqlClientChannel *self);
};

struct _Block8Data {
	int _ref_count_;
	MainWindow* self;
	ChannelTab* tab;
};

struct _Message {
	GObject parent_instance;
	MessagePrivate * priv;
	gchar* user_name;
	gboolean internal;
	gboolean usr_private_message;
};

struct _MessageClass {
	GObjectClass parent_class;
};


static gpointer main_window_parent_class = NULL;
extern GtkWindow* main_window_window;
GtkWindow* main_window_window = NULL;
extern GtkEntry* main_window_input;
GtkEntry* main_window_input = NULL;
extern GIcon* main_window_inactive_channel;
GIcon* main_window_inactive_channel = NULL;
extern GIcon* main_window_active_channel;
GIcon* main_window_active_channel = NULL;
extern GIcon* main_window_loading_channel;
GIcon* main_window_loading_channel = NULL;
extern GIcon* main_window_channel_tab_icon_new_msg;
GIcon* main_window_channel_tab_icon_new_msg = NULL;
extern gboolean main_window_network_state;
gboolean main_window_network_state = TRUE;
extern GeeHashMap* main_window_items_sidebar;
GeeHashMap* main_window_items_sidebar = NULL;
extern GtkButton* main_window_paste;
GtkButton* main_window_paste = NULL;
extern GtkBox* main_window_paste_box;
GtkBox* main_window_paste_box = NULL;
extern SqlClient* main_window_sql_client;
SqlClient* main_window_sql_client = NULL;
extern Settings* main_window_settings;
Settings* main_window_settings = NULL;
extern ServerManager* main_window_server_manager;
ServerManager* main_window_server_manager = NULL;
extern UnityLauncherEntry* main_window_launcher;
UnityLauncherEntry* main_window_launcher = NULL;
extern gint main_window_current_tab;
gint main_window_current_tab = -1;
static GraniteWidgetsSourceListItem* main_window_current_selected_item;
static GraniteWidgetsSourceListItem* main_window_current_selected_item = NULL;
extern gint main_window_index;
gint main_window_index = 0;
extern gboolean relay_on_kde;
extern gboolean relay_on_ubuntu;
extern GeeHashMap* sql_client_servers;

GType main_window_get_type (void) G_GNUC_CONST;
GType relay_get_type (void) G_GNUC_CONST;
GType drag_file_get_type (void) G_GNUC_CONST;
GType channel_tab_get_type (void) G_GNUC_CONST;
GType connection_get_type (void) G_GNUC_CONST;
#define MAIN_WINDOW_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), TYPE_MAIN_WINDOW, MainWindowPrivate))
enum  {
	MAIN_WINDOW_DUMMY_PROPERTY
};
DragFile* drag_file_new (void);
DragFile* drag_file_construct (GType object_type);
GType sql_client_get_type (void) G_GNUC_CONST;
SqlClient* sql_client_get_instance (void);
GType settings_get_type (void) G_GNUC_CONST;
Settings* settings_new (void);
Settings* settings_construct (GType object_type);
GType server_manager_get_type (void) G_GNUC_CONST;
ServerManager* server_manager_new (void);
ServerManager* server_manager_construct (GType object_type);
#define MAIN_WINDOW_UI_FILE "ui/relay.ui"
#define MAIN_WINDOW_UI_FILE_SERVERS "ui/server_window.ui"
#define MAIN_WINDOW_UI_FILE_SETTINGS "ui/settings_window.ui"
MainWindow* main_window_new (Relay* application);
MainWindow* main_window_construct (GType object_type, Relay* application);
gchar* relay_get_asset_file (const gchar* name);
gboolean settings_show_window (Settings* self);
static gboolean _settings_show_window_gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
void main_window_tags_refresh (MainWindow* self);
static void _main_window_tags_refresh_settings_changed_color (Settings* _sender, gpointer self);
static void ___lambda30_ (MainWindow* self, gboolean state);
static void ____lambda30__settings_show_hide_tabs (Settings* _sender, gboolean show, gpointer self);
gboolean settings_get_bool (Settings* self, const gchar* name);
void main_window_new_tab_requested (MainWindow* self);
static void _main_window_new_tab_requested_granite_widgets_dynamic_notebook_new_tab_requested (GraniteWidgetsDynamicNotebook* _sender, gpointer self);
gboolean relay_set_color_mode (GdkRGBA* color);
void settings_set_colors_defaults (Settings* self);
void main_window_relay_close_program (MainWindow* self);
static void _main_window_relay_close_program_gtk_widget_destroy (GtkWidget* _sender, gpointer self);
MainEntry* main_entry_new (void);
MainEntry* main_entry_construct (GType object_type);
GType main_entry_get_type (void) G_GNUC_CONST;
static void ___lambda40_ (MainWindow* self);
void main_window_send_text_out (MainWindow* self, const gchar* text);
static void ____lambda40__gtk_entry_activate (GtkEntry* _sender, gpointer self);
static void main_window_set_item_selected (MainWindow* self, GraniteWidgetsSourceListItem* item);
static void _main_window_set_item_selected_granite_widgets_source_list_item_selected (GraniteWidgetsSourceList* _sender, GraniteWidgetsSourceListItem* item, gpointer self);
void main_window_set_up_add_sever (MainWindow* self, GtkBuilder* builder);
static void main_window_tab_remove (MainWindow* self, GraniteWidgetsTab* tab);
static void _main_window_tab_remove_granite_widgets_dynamic_notebook_tab_removed (GraniteWidgetsDynamicNotebook* _sender, GraniteWidgetsTab* tab, gpointer self);
static void main_window_tab_switch (MainWindow* self, GraniteWidgetsTab* old_tab, GraniteWidgetsTab* new_tab);
static void _main_window_tab_switch_granite_widgets_dynamic_notebook_tab_switched (GraniteWidgetsDynamicNotebook* _sender, GraniteWidgetsTab* old_tab, GraniteWidgetsTab* new_tab, gpointer self);
void main_window_refresh_server_list (MainWindow* self);
static void main_window_load_autoconnect (MainWindow* self);
static void ___lambda43_ (MainWindow* self);
static void ____lambda43__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static void _main_window_new_tab_requested_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static void ___lambda44_ (MainWindow* self);
static void ____lambda44__server_manager_close (ServerManager* _sender, gpointer self);
gboolean main_window_slide_panel (MainWindow* self);
static void __lambda45_ (MainWindow* self, gboolean on);
static gboolean ___lambda46_ (MainWindow* self, GeeMapEntry* output);
GType message_get_type (void) G_GNUC_CONST;
Message* message_new (const gchar* _message);
Message* message_construct (GType object_type, const gchar* _message);
void message_set_message (Message* self, const gchar* value);
void main_window_add_text (MainWindow* self, ChannelTab* tab, Message* message, gboolean _error_);
static gboolean ____lambda46__gee_forall_func (gpointer g, gpointer self);
static void ___lambda45__g_network_monitor_network_changed (GNetworkMonitor* _sender, gboolean available, gpointer self);
void main_window_rebuild_channel_list_menu (MainWindow* self);
static void __lambda37_ (MainWindow* self, GtkWidget* widget);
static void ___lambda37__gtk_callback (GtkWidget* widget, gpointer self);
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
static void ____lambda38_ (Block1Data* _data1_);
static void _____lambda38__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
GtkPopover* main_window_make_popover (MainWindow* self, GtkButton* parent);
static void main_window_sidebar_item_activated (MainWindow* self);
void main_window_add_tab (MainWindow* self, ChannelTab* new_tab, const gchar* name);
static Block2Data* block2_data_ref (Block2Data* _data2_);
static void block2_data_unref (void * _userdata_);
static gboolean __lambda33_ (Block2Data* _data2_);
static Block3Data* block3_data_ref (Block3Data* _data3_);
static void block3_data_unref (void * _userdata_);
Connection* channel_tab_get_connection (ChannelTab* self);
gpointer sql_client_server_ref (gpointer instance);
void sql_client_server_unref (gpointer instance);
GParamSpec* sql_client_param_spec_server (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void sql_client_value_set_server (GValue* value, gpointer v_object);
void sql_client_value_take_server (GValue* value, gpointer v_object);
gpointer sql_client_value_get_server (const GValue* value);
GType sql_client_server_get_type (void) G_GNUC_CONST;
#define IRC_USER_WIDTH 126
static void _vala_PangoFontDescription_free (PangoFontDescription* self);
static void __lambda34_ (Block3Data* _data3_, GtkMenu* menu);
static void __lambda35_ (Block3Data* _data3_);
static void main_window_save_output_to_file (MainWindow* self, const gchar* text);
static void ___lambda35__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static void __lambda36_ (Block3Data* _data3_);
static void ___lambda36__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static void ___lambda34__gtk_text_view_populate_popup (GtkTextView* _sender, GtkMenu* popup, gpointer self);
static void main_window_new_subject (MainWindow* self, gint tab_id, const gchar* message);
static void _main_window_new_subject_channel_tab_new_subject (ChannelTab* _sender, gint tab_id, const gchar* subject, gpointer self);
void channel_tab_set_output (ChannelTab* self, GtkTextView* _output);
void channel_tab_set_tab_index (ChannelTab* self, gint value);
static void _vala_PangoTabArray_free (PangoTabArray* self);
static gboolean ___lambda33__gsource_func (gpointer self);
gpointer sql_client_channel_ref (gpointer instance);
void sql_client_channel_unref (gpointer instance);
GParamSpec* sql_client_param_spec_channel (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void sql_client_value_set_channel (GValue* value, gpointer v_object);
void sql_client_value_take_channel (GValue* value, gpointer v_object);
gpointer sql_client_value_get_channel (const GValue* value);
GType sql_client_channel_get_type (void) G_GNUC_CONST;
void connection_send_output (Connection* self, const gchar* output);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (void * _userdata_);
static void __lambda31_ (Block4Data* _data4_);
static void ___lambda31__gtk_entry_activate (GtkEntry* _sender, gpointer self);
static void __lambda32_ (Block4Data* _data4_, gint id);
SqlClientServer* sql_client_server_new (void);
SqlClientServer* sql_client_server_construct (GType object_type);
void main_window_add_server (MainWindow* self, SqlClientServer* server, GeeLinkedList* connect_channels);
static void ___lambda32__gtk_dialog_response (GtkDialog* _sender, gint response_id, gpointer self);
gint main_window_lookup_channel_id (MainWindow* self, GraniteWidgetsTab* tab);
const gchar* channel_tab_get_channel_name (ChannelTab* self);
void connection_do_exit (Connection* self);
static void main_window_show_welcome_screen (MainWindow* self);
void main_window_refresh_icon (MainWindow* self, gint add);
static void main_window_make_user_popover (MainWindow* self, const gchar* search_str, gboolean need_show);
static Block5Data* block5_data_ref (Block5Data* _data5_);
static void block5_data_unref (void * _userdata_);
static gint __lambda47_ (Block5Data* _data5_);
static void main_window_make_user_popover_idle (MainWindow* self, ChannelTab* using_tab, const gchar* _search_str);
static gpointer ___lambda47__gthread_func (gpointer self);
static Block6Data* block6_data_ref (Block6Data* _data6_);
static void block6_data_unref (void * _userdata_);
GeeLinkedList* channel_tab_get_all_user_lists (ChannelTab* self);
static GtkEventBox* main_window_make_user_eventbox (MainWindow* self, const gchar* user, gint type);
static gboolean __lambda51_ (Block6Data* _data6_);
static gboolean ___lambda51__gsource_func (gpointer self);
static Block7Data* block7_data_ref (Block7Data* _data7_);
static void block7_data_unref (void * _userdata_);
static gboolean __lambda48_ (Block7Data* _data7_);
static gboolean ___lambda48__gtk_widget_enter_notify_event (GtkWidget* _sender, GdkEventCrossing* event, gpointer self);
static gboolean __lambda49_ (Block7Data* _data7_);
static gboolean ___lambda49__gtk_widget_leave_notify_event (GtkWidget* _sender, GdkEventCrossing* event, gpointer self);
#define IRC_USER_LENGTH 18
static gboolean __lambda50_ (Block7Data* _data7_, GdkEventButton* event);
void main_window_fill_input (const gchar* message);
static gboolean ___lambda50__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static gboolean main_window_click_private_message (MainWindow* self, GdkEventButton* event);
ChannelTab* connection_add_channel_tab (Connection* self, const gchar* _name, gboolean primsg);
gchar* irc_remove_user_prefix (const gchar* name);
static gboolean main_window_click_block (MainWindow* self, GdkEventButton* event);
void channel_tab_remove_block_list (ChannelTab* self, const gchar* name);
void channel_tab_add_block_list (ChannelTab* self, const gchar* name);
Connection* connection_new (void);
Connection* connection_construct (GType object_type);
static void _main_window_add_tab_connection_new_tab (Connection* _sender, ChannelTab* tab, const gchar* name, gpointer self);
static void _main_window_add_text_connection_new_message (Connection* _sender, ChannelTab* tab, Message* message, gboolean is_error, gpointer self);
static void main_window_sidebar_state (MainWindow* self, const gchar* name, const gchar* state);
static void _main_window_sidebar_state_connection_change_channel_state (Connection* _sender, const gchar* chan_name, const gchar* state, gpointer self);
gboolean connection_connect_to_server (Connection* self, SqlClientServer* _server);
static void _main_window_sidebar_item_activated_granite_widgets_source_list_item_activated (GraniteWidgetsSourceListItem* _sender, gpointer self);
void connection_join (Connection* self, const gchar* channel);
static Block8Data* block8_data_ref (Block8Data* _data8_);
static void block8_data_unref (void * _userdata_);
const gchar* message_get_message (Message* self);
void channel_tab_display_error (ChannelTab* self, Message* message);
void channel_tab_display_message (ChannelTab* self, Message* message);
gint channel_tab_get_tab_index (ChannelTab* self);
const gchar* message_get_command (Message* self);
#define IRC_PRIVATE_MESSAGE "PRIVMSG"
gchar** message_get_parameters (Message* self, int* result_length1);
static gboolean ___lambda39_ (Block8Data* _data8_);
static gboolean ____lambda39__gsource_func (gpointer self);
void channel_tab_send_text_out (ChannelTab* self, const gchar* message);
void message_user_name_set (Message* self, const gchar* name);
void message_set_command (Message* self, const gchar* value);
gint main_window_move_slider_t (MainWindow* self);
static gpointer _main_window_move_slider_t_gthread_func (gpointer self);
gdouble relay_ease_out_elastic (gfloat t, gfloat b, gfloat c, gfloat d);
gfloat relay_ease_in_bounce (gfloat t, gfloat b, gfloat c, gfloat d);
void main_window_file_uploaded (MainWindow* self, const gchar* url);
GeeLinkedList* sql_client_server_get_autoconnect_channels (SqlClientServer* self);
static void __lambda42_ (MainWindow* self, gint index);
gboolean server_manager_open_window (ServerManager* self);
static void ___lambda42__granite_widgets_welcome_activated (GraniteWidgetsWelcome* _sender, gint index, gpointer self);
static gboolean __lambda41_ (MainWindow* self, GdkEventButton* event);
static gboolean ___lambda41__gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static gboolean __lambda29_ (MainWindow* self, GeeMapEntry* tab);
void channel_tab_update_tag_table (ChannelTab* self);
static gboolean ___lambda29__gee_forall_func (gpointer g, gpointer self);
void relay_show_error_window (const gchar* error_msg);
void main_window_on_destroy (GtkWidget* window, MainWindow* self);
static void main_window_finalize (GObject* obj);


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static gboolean _settings_show_window_gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = settings_show_window ((Settings*) self);
	return result;
}


static void _main_window_tags_refresh_settings_changed_color (Settings* _sender, gpointer self) {
	main_window_tags_refresh ((MainWindow*) self);
}


static void ___lambda30_ (MainWindow* self, gboolean state) {
	GraniteWidgetsDynamicNotebook* _tmp0_ = NULL;
	gboolean _tmp1_ = FALSE;
	_tmp0_ = self->priv->tabs;
	_tmp1_ = state;
	granite_widgets_dynamic_notebook_set_show_tabs (_tmp0_, _tmp1_);
}


static void ____lambda30__settings_show_hide_tabs (Settings* _sender, gboolean show, gpointer self) {
	___lambda30_ ((MainWindow*) self, show);
}


static void _main_window_new_tab_requested_granite_widgets_dynamic_notebook_new_tab_requested (GraniteWidgetsDynamicNotebook* _sender, gpointer self) {
	main_window_new_tab_requested ((MainWindow*) self);
}


static void _main_window_relay_close_program_gtk_widget_destroy (GtkWidget* _sender, gpointer self) {
	main_window_relay_close_program ((MainWindow*) self);
}


static void ___lambda40_ (MainWindow* self) {
	GtkEntry* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	GtkEntry* _tmp2_ = NULL;
	_tmp0_ = main_window_input;
	_tmp1_ = gtk_entry_get_text (_tmp0_);
	main_window_send_text_out (self, _tmp1_);
	_tmp2_ = main_window_input;
	gtk_entry_set_text (_tmp2_, "");
}


static void ____lambda40__gtk_entry_activate (GtkEntry* _sender, gpointer self) {
	___lambda40_ ((MainWindow*) self);
}


static void _main_window_set_item_selected_granite_widgets_source_list_item_selected (GraniteWidgetsSourceList* _sender, GraniteWidgetsSourceListItem* item, gpointer self) {
	main_window_set_item_selected ((MainWindow*) self, item);
}


static void _main_window_tab_remove_granite_widgets_dynamic_notebook_tab_removed (GraniteWidgetsDynamicNotebook* _sender, GraniteWidgetsTab* tab, gpointer self) {
	main_window_tab_remove ((MainWindow*) self, tab);
}


static void _main_window_tab_switch_granite_widgets_dynamic_notebook_tab_switched (GraniteWidgetsDynamicNotebook* _sender, GraniteWidgetsTab* old_tab, GraniteWidgetsTab* new_tab, gpointer self) {
	main_window_tab_switch ((MainWindow*) self, old_tab, new_tab);
}


static void ___lambda43_ (MainWindow* self) {
	{
		GeeHashMap* _item_list = NULL;
		GeeHashMap* _tmp0_ = NULL;
		GeeHashMap* _tmp1_ = NULL;
		gint _item_size = 0;
		GeeHashMap* _tmp2_ = NULL;
		gint _tmp3_ = 0;
		gint _tmp4_ = 0;
		gint _item_index = 0;
		_tmp0_ = self->priv->outputs;
		_tmp1_ = _g_object_ref0 (_tmp0_);
		_item_list = _tmp1_;
		_tmp2_ = _item_list;
		_tmp3_ = gee_abstract_map_get_size ((GeeMap*) _tmp2_);
		_tmp4_ = _tmp3_;
		_item_size = _tmp4_;
		_item_index = -1;
		while (TRUE) {
			gint _tmp5_ = 0;
			gint _tmp6_ = 0;
			gint _tmp7_ = 0;
			ChannelTab* item = NULL;
			GeeHashMap* _tmp8_ = NULL;
			gint _tmp9_ = 0;
			gpointer _tmp10_ = NULL;
			gboolean _tmp11_ = FALSE;
			ChannelTab* _tmp12_ = NULL;
			_tmp5_ = _item_index;
			_item_index = _tmp5_ + 1;
			_tmp6_ = _item_index;
			_tmp7_ = _item_size;
			if (!(_tmp6_ < _tmp7_)) {
				break;
			}
			_tmp8_ = _item_list;
			_tmp9_ = _item_index;
			_tmp10_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp8_, (gpointer) ((gintptr) _tmp9_));
			item = (ChannelTab*) _tmp10_;
			_tmp12_ = item;
			if (_tmp12_ != NULL) {
				ChannelTab* _tmp13_ = NULL;
				GraniteWidgetsTab* _tmp14_ = NULL;
				_tmp13_ = item;
				_tmp14_ = _tmp13_->tab;
				_tmp11_ = _tmp14_ != NULL;
			} else {
				_tmp11_ = FALSE;
			}
			if (_tmp11_) {
				GraniteWidgetsDynamicNotebook* _tmp15_ = NULL;
				ChannelTab* _tmp16_ = NULL;
				GraniteWidgetsTab* _tmp17_ = NULL;
				_tmp15_ = self->priv->tabs;
				_tmp16_ = item;
				_tmp17_ = _tmp16_->tab;
				granite_widgets_dynamic_notebook_remove_tab (_tmp15_, _tmp17_);
			}
			_g_object_unref0 (item);
		}
		_g_object_unref0 (_item_list);
	}
}


static void ____lambda43__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	___lambda43_ ((MainWindow*) self);
}


static void _main_window_new_tab_requested_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	main_window_new_tab_requested ((MainWindow*) self);
}


static void ___lambda44_ (MainWindow* self) {
	main_window_refresh_server_list (self);
}


static void ____lambda44__server_manager_close (ServerManager* _sender, gpointer self) {
	___lambda44_ ((MainWindow*) self);
}


static gboolean ___lambda46_ (MainWindow* self, GeeMapEntry* output) {
	gboolean result = FALSE;
	Message* msg = NULL;
	Message* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	GeeMapEntry* _tmp2_ = NULL;
	gconstpointer _tmp3_ = NULL;
	ChannelTab* _tmp4_ = NULL;
	g_return_val_if_fail (output != NULL, FALSE);
	_tmp0_ = message_new ("");
	msg = _tmp0_;
	_tmp1_ = _ ("You have lost network connectivity.");
	message_set_message (msg, _tmp1_);
	_tmp2_ = output;
	_tmp3_ = gee_map_entry_get_value (_tmp2_);
	_tmp4_ = _tmp3_;
	main_window_add_text (self, (ChannelTab*) _tmp4_, msg, TRUE);
	result = TRUE;
	_g_object_unref0 (msg);
	_g_object_unref0 (output);
	return result;
}


static gboolean ____lambda46__gee_forall_func (gpointer g, gpointer self) {
	gboolean result;
	result = ___lambda46_ ((MainWindow*) self, (GeeMapEntry*) g);
	return result;
}


static void __lambda45_ (MainWindow* self, gboolean on) {
	gboolean _tmp0_ = FALSE;
	_tmp0_ = on;
	if (!_tmp0_) {
		gboolean _tmp1_ = FALSE;
		GeeHashMap* _tmp2_ = NULL;
		_tmp1_ = main_window_network_state;
		if (!_tmp1_) {
			return;
		}
		main_window_network_state = FALSE;
		_tmp2_ = self->priv->outputs;
		gee_abstract_map_foreach ((GeeAbstractMap*) _tmp2_, ____lambda46__gee_forall_func, self);
	} else {
		main_window_network_state = TRUE;
	}
}


static void ___lambda45__g_network_monitor_network_changed (GNetworkMonitor* _sender, gboolean available, gpointer self) {
	__lambda45_ ((MainWindow*) self, available);
}


MainWindow* main_window_construct (GType object_type, Relay* application) {
	MainWindow * self = NULL;
	GNetworkMonitor* network_monitor = NULL;
	GNetworkMonitor* _tmp111_ = NULL;
	GNetworkMonitor* _tmp112_ = NULL;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (application != NULL, NULL);
	self = (MainWindow*) g_object_new (object_type, NULL);
	{
		Relay* _tmp0_ = NULL;
		Relay* _tmp1_ = NULL;
		GdkPixbuf* _tmp2_ = NULL;
		gchar* _tmp3_ = NULL;
		gchar* _tmp4_ = NULL;
		GdkPixbuf* _tmp5_ = NULL;
		GdkPixbuf* _tmp6_ = NULL;
		GdkPixbuf* _tmp7_ = NULL;
		GdkPixbuf* _tmp8_ = NULL;
		gchar* _tmp9_ = NULL;
		gchar* _tmp10_ = NULL;
		GdkPixbuf* _tmp11_ = NULL;
		GdkPixbuf* _tmp12_ = NULL;
		GdkPixbuf* _tmp13_ = NULL;
		GdkPixbuf* _tmp14_ = NULL;
		gchar* _tmp15_ = NULL;
		gchar* _tmp16_ = NULL;
		GdkPixbuf* _tmp17_ = NULL;
		GdkPixbuf* _tmp18_ = NULL;
		GdkPixbuf* _tmp19_ = NULL;
		GtkBuilder* builder = NULL;
		GtkBuilder* _tmp20_ = NULL;
		GtkBuilder* _tmp21_ = NULL;
		gchar* _tmp22_ = NULL;
		gchar* _tmp23_ = NULL;
		GtkBuilder* _tmp24_ = NULL;
		GtkButton* settings_btn = NULL;
		GtkBuilder* _tmp25_ = NULL;
		GObject* _tmp26_ = NULL;
		GtkButton* _tmp27_ = NULL;
		GtkButton* _tmp28_ = NULL;
		Settings* _tmp29_ = NULL;
		Settings* _tmp30_ = NULL;
		Settings* _tmp31_ = NULL;
		gboolean _tmp32_ = FALSE;
		GraniteWidgetsDynamicNotebook* _tmp36_ = NULL;
		const gchar* _tmp37_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp38_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp39_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp40_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp41_ = NULL;
		Settings* _tmp42_ = NULL;
		gboolean _tmp43_ = FALSE;
		GraniteWidgetsDynamicNotebook* _tmp44_ = NULL;
		GtkBuilder* _tmp45_ = NULL;
		GObject* _tmp46_ = NULL;
		GtkWindow* _tmp47_ = NULL;
		GtkWindow* _tmp48_ = NULL;
		GtkWindow* _tmp49_ = NULL;
		GtkStyleContext* _tmp50_ = NULL;
		GdkRGBA _tmp51_ = {0};
		Settings* _tmp52_ = NULL;
		GtkWindow* _tmp53_ = NULL;
		Relay* _tmp54_ = NULL;
		GtkWindow* _tmp55_ = NULL;
		GtkBox* nb_wrapper = NULL;
		GtkBuilder* _tmp56_ = NULL;
		GObject* _tmp57_ = NULL;
		GtkBox* _tmp58_ = NULL;
		GtkBox* _tmp59_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp60_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp61_ = NULL;
		GtkBuilder* _tmp62_ = NULL;
		GObject* _tmp63_ = NULL;
		GtkPaned* _tmp64_ = NULL;
		GtkBox* server_list_container = NULL;
		GtkBuilder* _tmp65_ = NULL;
		GObject* _tmp66_ = NULL;
		GtkBox* _tmp67_ = NULL;
		GtkBox* _tmp68_ = NULL;
		GraniteWidgetsSourceList* _tmp69_ = NULL;
		GtkPaned* _tmp70_ = NULL;
		GtkBox* entry_wrapper = NULL;
		GtkBuilder* _tmp71_ = NULL;
		GObject* _tmp72_ = NULL;
		GtkBox* _tmp73_ = NULL;
		MainEntry* _tmp74_ = NULL;
		GtkBox* _tmp75_ = NULL;
		GtkEntry* _tmp76_ = NULL;
		GtkEntry* _tmp77_ = NULL;
		GraniteWidgetsSourceList* _tmp78_ = NULL;
		GtkBuilder* _tmp79_ = NULL;
		GtkHeaderBar* _tmp80_ = NULL;
		Relay* _tmp81_ = NULL;
		const gchar* _tmp82_ = NULL;
		gboolean _tmp83_ = FALSE;
		GtkWindow* _tmp85_ = NULL;
		GtkHeaderBar* _tmp86_ = NULL;
		GtkWindow* _tmp87_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp88_ = NULL;
		GraniteWidgetsDynamicNotebook* _tmp89_ = NULL;
		GtkMenuItem* close_all = NULL;
		const gchar* _tmp90_ = NULL;
		GtkMenuItem* _tmp91_ = NULL;
		GtkMenuItem* _tmp92_ = NULL;
		GtkMenuItem* new_tab = NULL;
		const gchar* _tmp93_ = NULL;
		GtkMenuItem* _tmp94_ = NULL;
		GtkMenuItem* _tmp95_ = NULL;
		GtkMenuItem* channel_list_menu = NULL;
		const gchar* _tmp96_ = NULL;
		GtkMenuItem* _tmp97_ = NULL;
		GtkMenuItem* _tmp98_ = NULL;
		GtkMenu* _tmp99_ = NULL;
		GtkMenu* _tmp100_ = NULL;
		GtkMenuItem* _tmp101_ = NULL;
		GtkMenu* _tmp102_ = NULL;
		GtkMenuItem* _tmp103_ = NULL;
		GtkMenu* _tmp104_ = NULL;
		GtkMenuItem* _tmp105_ = NULL;
		GtkMenu* _tmp106_ = NULL;
		ServerManager* _tmp107_ = NULL;
		Settings* _tmp108_ = NULL;
		gboolean _tmp109_ = FALSE;
		_tmp0_ = application;
		_tmp1_ = _g_object_ref0 (_tmp0_);
		_g_object_unref0 (self->priv->app);
		self->priv->app = _tmp1_;
		_tmp3_ = relay_get_asset_file ("assets/user-offline.svg");
		_tmp4_ = _tmp3_;
		_tmp5_ = gdk_pixbuf_new_from_file (_tmp4_, &_inner_error_);
		_tmp6_ = _tmp5_;
		_g_free0 (_tmp4_);
		_tmp2_ = _tmp6_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			goto __catch0_g_error;
		}
		_tmp7_ = _tmp2_;
		_tmp2_ = NULL;
		_g_object_unref0 (main_window_inactive_channel);
		main_window_inactive_channel = (GIcon*) _tmp7_;
		_tmp9_ = relay_get_asset_file ("assets/user-idle.svg");
		_tmp10_ = _tmp9_;
		_tmp11_ = gdk_pixbuf_new_from_file (_tmp10_, &_inner_error_);
		_tmp12_ = _tmp11_;
		_g_free0 (_tmp10_);
		_tmp8_ = _tmp12_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_object_unref0 (_tmp2_);
			goto __catch0_g_error;
		}
		_tmp13_ = _tmp8_;
		_tmp8_ = NULL;
		_g_object_unref0 (main_window_active_channel);
		main_window_active_channel = (GIcon*) _tmp13_;
		_tmp15_ = relay_get_asset_file ("assets/channel-loading.svg");
		_tmp16_ = _tmp15_;
		_tmp17_ = gdk_pixbuf_new_from_file (_tmp16_, &_inner_error_);
		_tmp18_ = _tmp17_;
		_g_free0 (_tmp16_);
		_tmp14_ = _tmp18_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_object_unref0 (_tmp8_);
			_g_object_unref0 (_tmp2_);
			goto __catch0_g_error;
		}
		_tmp19_ = _tmp14_;
		_tmp14_ = NULL;
		_g_object_unref0 (main_window_loading_channel);
		main_window_loading_channel = (GIcon*) _tmp19_;
		_tmp20_ = gtk_builder_new ();
		builder = _tmp20_;
		_tmp21_ = builder;
		_tmp22_ = relay_get_asset_file (MAIN_WINDOW_UI_FILE);
		_tmp23_ = _tmp22_;
		gtk_builder_add_from_file (_tmp21_, _tmp23_, &_inner_error_);
		_g_free0 (_tmp23_);
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_object_unref0 (builder);
			_g_object_unref0 (_tmp14_);
			_g_object_unref0 (_tmp8_);
			_g_object_unref0 (_tmp2_);
			goto __catch0_g_error;
		}
		_tmp24_ = builder;
		gtk_builder_connect_signals (_tmp24_, self);
		_tmp25_ = builder;
		_tmp26_ = gtk_builder_get_object (_tmp25_, "settings_btn");
		_tmp27_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp26_, gtk_button_get_type ()) ? ((GtkButton*) _tmp26_) : NULL);
		settings_btn = _tmp27_;
		_tmp28_ = settings_btn;
		_tmp29_ = main_window_settings;
		g_signal_connect_object ((GtkWidget*) _tmp28_, "button-release-event", (GCallback) _settings_show_window_gtk_widget_button_release_event, _tmp29_, 0);
		_tmp30_ = main_window_settings;
		g_signal_connect_object (_tmp30_, "changed-color", (GCallback) _main_window_tags_refresh_settings_changed_color, self, 0);
		_tmp31_ = main_window_settings;
		g_signal_connect_object (_tmp31_, "show-hide-tabs", (GCallback) ____lambda30__settings_show_hide_tabs, self, 0);
		_tmp32_ = relay_on_kde;
		if (_tmp32_) {
			GtkHeaderBar* _tmp33_ = NULL;
			_tmp33_ = self->priv->toolbar;
			gtk_header_bar_set_decoration_layout (_tmp33_, "");
		} else {
			gboolean _tmp34_ = FALSE;
			_tmp34_ = relay_on_ubuntu;
			if (_tmp34_) {
				GtkHeaderBar* _tmp35_ = NULL;
				_tmp35_ = self->priv->toolbar;
				gtk_header_bar_set_decoration_layout (_tmp35_, "close,maximize");
			}
		}
		_tmp36_ = self->priv->tabs;
		_tmp37_ = _ ("Connect to a server");
		granite_widgets_dynamic_notebook_set_add_button_tooltip (_tmp36_, _tmp37_);
		_tmp38_ = self->priv->tabs;
		granite_widgets_dynamic_notebook_set_add_button_visible (_tmp38_, FALSE);
		_tmp39_ = self->priv->tabs;
		granite_widgets_dynamic_notebook_set_allow_drag (_tmp39_, TRUE);
		_tmp40_ = self->priv->tabs;
		granite_widgets_dynamic_notebook_set_show_icons (_tmp40_, TRUE);
		_tmp41_ = self->priv->tabs;
		_tmp42_ = main_window_settings;
		_tmp43_ = settings_get_bool (_tmp42_, "show_tabs");
		granite_widgets_dynamic_notebook_set_show_tabs (_tmp41_, _tmp43_);
		_tmp44_ = self->priv->tabs;
		g_signal_connect_object (_tmp44_, "new-tab-requested", (GCallback) _main_window_new_tab_requested_granite_widgets_dynamic_notebook_new_tab_requested, self, 0);
		_tmp45_ = builder;
		_tmp46_ = gtk_builder_get_object (_tmp45_, "window");
		_tmp47_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp46_, gtk_window_get_type ()) ? ((GtkWindow*) _tmp46_) : NULL);
		_g_object_unref0 (main_window_window);
		main_window_window = _tmp47_;
		_tmp48_ = main_window_window;
		gtk_window_set_position (_tmp48_, GTK_WIN_POS_CENTER);
		_tmp49_ = main_window_window;
		_tmp50_ = gtk_widget_get_style_context ((GtkWidget*) _tmp49_);
		gtk_style_context_get_color (_tmp50_, GTK_STATE_FLAG_NORMAL, &_tmp51_);
		relay_set_color_mode (&_tmp51_);
		_tmp52_ = main_window_settings;
		settings_set_colors_defaults (_tmp52_);
		_tmp53_ = main_window_window;
		g_signal_connect_object ((GtkWidget*) _tmp53_, "destroy", (GCallback) _main_window_relay_close_program_gtk_widget_destroy, self, 0);
		_tmp54_ = application;
		_tmp55_ = main_window_window;
		gtk_application_add_window ((GtkApplication*) _tmp54_, _tmp55_);
		_tmp56_ = builder;
		_tmp57_ = gtk_builder_get_object (_tmp56_, "notebook_wrapper");
		_tmp58_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp57_, gtk_box_get_type ()) ? ((GtkBox*) _tmp57_) : NULL);
		nb_wrapper = _tmp58_;
		_tmp59_ = nb_wrapper;
		_tmp60_ = self->priv->tabs;
		gtk_box_pack_start (_tmp59_, (GtkWidget*) _tmp60_, TRUE, TRUE, (guint) 0);
		_tmp61_ = self->priv->tabs;
		gtk_widget_show_all ((GtkWidget*) _tmp61_);
		_tmp62_ = builder;
		_tmp63_ = gtk_builder_get_object (_tmp62_, "panel");
		_tmp64_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp63_, gtk_paned_get_type ()) ? ((GtkPaned*) _tmp63_) : NULL);
		_g_object_unref0 (self->priv->panel);
		self->priv->panel = _tmp64_;
		_tmp65_ = builder;
		_tmp66_ = gtk_builder_get_object (_tmp65_, "server_list_container");
		_tmp67_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp66_, gtk_box_get_type ()) ? ((GtkBox*) _tmp66_) : NULL);
		server_list_container = _tmp67_;
		_tmp68_ = server_list_container;
		_tmp69_ = self->priv->servers;
		gtk_box_pack_start (_tmp68_, (GtkWidget*) _tmp69_, TRUE, TRUE, (guint) 0);
		_tmp70_ = self->priv->panel;
		gtk_paned_set_position (_tmp70_, 1);
		_tmp71_ = builder;
		_tmp72_ = gtk_builder_get_object (_tmp71_, "entry_wrapper");
		_tmp73_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp72_, gtk_box_get_type ()) ? ((GtkBox*) _tmp72_) : NULL);
		entry_wrapper = _tmp73_;
		_tmp74_ = main_entry_new ();
		g_object_ref_sink (_tmp74_);
		_g_object_unref0 (main_window_input);
		main_window_input = (GtkEntry*) _tmp74_;
		_tmp75_ = entry_wrapper;
		_tmp76_ = main_window_input;
		gtk_box_pack_start (_tmp75_, (GtkWidget*) _tmp76_, TRUE, TRUE, (guint) 0);
		_tmp77_ = main_window_input;
		g_signal_connect_object (_tmp77_, "activate", (GCallback) ____lambda40__gtk_entry_activate, self, 0);
		_tmp78_ = self->priv->servers;
		g_signal_connect_object (_tmp78_, "item-selected", (GCallback) _main_window_set_item_selected_granite_widgets_source_list_item_selected, self, 0);
		_tmp79_ = builder;
		main_window_set_up_add_sever (self, _tmp79_);
		_tmp80_ = self->priv->toolbar;
		_tmp81_ = self->priv->app;
		_tmp82_ = ((GraniteApplication*) _tmp81_)->program_name;
		gtk_header_bar_set_title (_tmp80_, _tmp82_);
		_tmp83_ = relay_on_kde;
		if (!_tmp83_) {
			GtkHeaderBar* _tmp84_ = NULL;
			_tmp84_ = self->priv->toolbar;
			gtk_header_bar_set_show_close_button (_tmp84_, TRUE);
		}
		_tmp85_ = main_window_window;
		_tmp86_ = self->priv->toolbar;
		gtk_window_set_titlebar (_tmp85_, (GtkWidget*) _tmp86_);
		_tmp87_ = main_window_window;
		gtk_widget_show_all ((GtkWidget*) _tmp87_);
		_tmp88_ = self->priv->tabs;
		g_signal_connect_object (_tmp88_, "tab-removed", (GCallback) _main_window_tab_remove_granite_widgets_dynamic_notebook_tab_removed, self, 0);
		_tmp89_ = self->priv->tabs;
		g_signal_connect_object (_tmp89_, "tab-switched", (GCallback) _main_window_tab_switch_granite_widgets_dynamic_notebook_tab_switched, self, 0);
		main_window_refresh_server_list (self);
		main_window_load_autoconnect (self);
		_tmp90_ = _ ("Close All");
		_tmp91_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp90_);
		g_object_ref_sink (_tmp91_);
		close_all = _tmp91_;
		_tmp92_ = close_all;
		g_signal_connect_object (_tmp92_, "activate", (GCallback) ____lambda43__gtk_menu_item_activate, self, 0);
		_tmp93_ = _ ("New Tab");
		_tmp94_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp93_);
		g_object_ref_sink (_tmp94_);
		new_tab = _tmp94_;
		_tmp95_ = new_tab;
		g_signal_connect_object (_tmp95_, "activate", (GCallback) _main_window_new_tab_requested_gtk_menu_item_activate, self, 0);
		_tmp96_ = _ ("Switch");
		_tmp97_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp96_);
		g_object_ref_sink (_tmp97_);
		channel_list_menu = _tmp97_;
		_tmp98_ = channel_list_menu;
		_tmp99_ = self->priv->tab_channel_list;
		gtk_menu_item_set_submenu (_tmp98_, (GtkWidget*) _tmp99_);
		_tmp100_ = self->priv->tab_rightclick;
		_tmp101_ = channel_list_menu;
		gtk_container_add ((GtkContainer*) _tmp100_, (GtkWidget*) _tmp101_);
		_tmp102_ = self->priv->tab_rightclick;
		_tmp103_ = close_all;
		gtk_container_add ((GtkContainer*) _tmp102_, (GtkWidget*) _tmp103_);
		_tmp104_ = self->priv->tab_rightclick;
		_tmp105_ = new_tab;
		gtk_container_add ((GtkContainer*) _tmp104_, (GtkWidget*) _tmp105_);
		_tmp106_ = self->priv->tab_rightclick;
		gtk_widget_show_all ((GtkWidget*) _tmp106_);
		_tmp107_ = main_window_server_manager;
		g_signal_connect_object (_tmp107_, "close", (GCallback) ____lambda44__server_manager_close, self, 0);
		_tmp108_ = main_window_settings;
		_tmp109_ = settings_get_bool (_tmp108_, "show_sidebar");
		if (_tmp109_) {
			main_window_slide_panel (self);
		}
		_g_object_unref0 (channel_list_menu);
		_g_object_unref0 (new_tab);
		_g_object_unref0 (close_all);
		_g_object_unref0 (entry_wrapper);
		_g_object_unref0 (server_list_container);
		_g_object_unref0 (nb_wrapper);
		_g_object_unref0 (settings_btn);
		_g_object_unref0 (builder);
		_g_object_unref0 (_tmp14_);
		_g_object_unref0 (_tmp8_);
		_g_object_unref0 (_tmp2_);
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		const gchar* _tmp110_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp110_ = e->message;
		g_error ("main_window.vala:294: Could not load UI: %s\n", _tmp110_);
		_g_error_free0 (e);
	}
	__finally0:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp111_ = g_network_monitor_get_default ();
	_tmp112_ = _g_object_ref0 (_tmp111_);
	network_monitor = _tmp112_;
	g_signal_connect_object (network_monitor, "network-changed", (GCallback) ___lambda45__g_network_monitor_network_changed, self, 0);
	_g_object_unref0 (network_monitor);
	return self;
}


MainWindow* main_window_new (Relay* application) {
	return main_window_construct (TYPE_MAIN_WINDOW, application);
}


static void __lambda37_ (MainWindow* self, GtkWidget* widget) {
	GtkMenu* _tmp0_ = NULL;
	GtkWidget* _tmp1_ = NULL;
	g_return_if_fail (widget != NULL);
	_tmp0_ = self->priv->tab_channel_list;
	_tmp1_ = widget;
	gtk_container_remove ((GtkContainer*) _tmp0_, _tmp1_);
}


static void ___lambda37__gtk_callback (GtkWidget* widget, gpointer self) {
	__lambda37_ ((MainWindow*) self, widget);
}


static Block1Data* block1_data_ref (Block1Data* _data1_) {
	g_atomic_int_inc (&_data1_->_ref_count_);
	return _data1_;
}


static void block1_data_unref (void * _userdata_) {
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
		MainWindow* self;
		self = _data1_->self;
		_g_object_unref0 (_data1_->tab);
		_g_object_unref0 (self);
		g_slice_free (Block1Data, _data1_);
	}
}


static void ____lambda38_ (Block1Data* _data1_) {
	MainWindow* self;
	GraniteWidgetsDynamicNotebook* _tmp0_ = NULL;
	GeeMapEntry* _tmp1_ = NULL;
	gconstpointer _tmp2_ = NULL;
	ChannelTab* _tmp3_ = NULL;
	GraniteWidgetsTab* _tmp4_ = NULL;
	self = _data1_->self;
	_tmp0_ = self->priv->tabs;
	_tmp1_ = _data1_->tab;
	_tmp2_ = gee_map_entry_get_value (_tmp1_);
	_tmp3_ = _tmp2_;
	_tmp4_ = ((ChannelTab*) _tmp3_)->tab;
	granite_widgets_dynamic_notebook_set_current (_tmp0_, _tmp4_);
}


static void _____lambda38__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	____lambda38_ (self);
}


void main_window_rebuild_channel_list_menu (MainWindow* self) {
	GtkMenu* _tmp0_ = NULL;
	GtkMenu* _tmp22_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->tab_channel_list;
	gtk_container_forall ((GtkContainer*) _tmp0_, ___lambda37__gtk_callback, self);
	{
		GeeIterator* _tab_it = NULL;
		GeeHashMap* _tmp1_ = NULL;
		GeeSet* _tmp2_ = NULL;
		GeeSet* _tmp3_ = NULL;
		GeeSet* _tmp4_ = NULL;
		GeeIterator* _tmp5_ = NULL;
		GeeIterator* _tmp6_ = NULL;
		_tmp1_ = self->priv->outputs;
		_tmp2_ = gee_abstract_map_get_entries ((GeeMap*) _tmp1_);
		_tmp3_ = _tmp2_;
		_tmp4_ = _tmp3_;
		_tmp5_ = gee_iterable_iterator ((GeeIterable*) _tmp4_);
		_tmp6_ = _tmp5_;
		_g_object_unref0 (_tmp4_);
		_tab_it = _tmp6_;
		while (TRUE) {
			Block1Data* _data1_;
			GeeIterator* _tmp7_ = NULL;
			gboolean _tmp8_ = FALSE;
			GeeIterator* _tmp9_ = NULL;
			gpointer _tmp10_ = NULL;
			GtkMenuItem* item = NULL;
			GeeMapEntry* _tmp11_ = NULL;
			gconstpointer _tmp12_ = NULL;
			ChannelTab* _tmp13_ = NULL;
			GraniteWidgetsTab* _tmp14_ = NULL;
			const gchar* _tmp15_ = NULL;
			const gchar* _tmp16_ = NULL;
			GtkMenuItem* _tmp17_ = NULL;
			GtkMenuItem* _tmp18_ = NULL;
			GtkMenu* _tmp19_ = NULL;
			GtkMenuItem* _tmp20_ = NULL;
			GtkMenuItem* _tmp21_ = NULL;
			_data1_ = g_slice_new0 (Block1Data);
			_data1_->_ref_count_ = 1;
			_data1_->self = g_object_ref (self);
			_tmp7_ = _tab_it;
			_tmp8_ = gee_iterator_next (_tmp7_);
			if (!_tmp8_) {
				block1_data_unref (_data1_);
				_data1_ = NULL;
				break;
			}
			_tmp9_ = _tab_it;
			_tmp10_ = gee_iterator_get (_tmp9_);
			_data1_->tab = (GeeMapEntry*) _tmp10_;
			_tmp11_ = _data1_->tab;
			_tmp12_ = gee_map_entry_get_value (_tmp11_);
			_tmp13_ = _tmp12_;
			_tmp14_ = ((ChannelTab*) _tmp13_)->tab;
			_tmp15_ = granite_widgets_tab_get_label (_tmp14_);
			_tmp16_ = _tmp15_;
			_tmp17_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp16_);
			g_object_ref_sink (_tmp17_);
			item = _tmp17_;
			_tmp18_ = item;
			g_signal_connect_data (_tmp18_, "activate", (GCallback) _____lambda38__gtk_menu_item_activate, block1_data_ref (_data1_), (GClosureNotify) block1_data_unref, 0);
			_tmp19_ = self->priv->tab_channel_list;
			_tmp20_ = item;
			gtk_container_add ((GtkContainer*) _tmp19_, (GtkWidget*) _tmp20_);
			_tmp21_ = item;
			gtk_widget_show_all ((GtkWidget*) _tmp21_);
			_g_object_unref0 (item);
			block1_data_unref (_data1_);
			_data1_ = NULL;
		}
		_g_object_unref0 (_tab_it);
	}
	_tmp22_ = self->priv->tab_channel_list;
	gtk_widget_show_all ((GtkWidget*) _tmp22_);
}


GtkPopover* main_window_make_popover (MainWindow* self, GtkButton* parent) {
	GtkPopover* result = NULL;
	GtkPopover* popover = NULL;
	GtkButton* _tmp0_ = NULL;
	GtkPopover* _tmp1_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (parent != NULL, NULL);
	_tmp0_ = parent;
	_tmp1_ = (GtkPopover*) gtk_popover_new ((GtkWidget*) _tmp0_);
	g_object_ref_sink (_tmp1_);
	popover = _tmp1_;
	gtk_widget_set_no_show_all ((GtkWidget*) popover, TRUE);
	gtk_widget_hide ((GtkWidget*) popover);
	result = popover;
	return result;
}


static void main_window_set_item_selected (MainWindow* self, GraniteWidgetsSourceListItem* item) {
	GraniteWidgetsSourceListItem* _tmp0_ = NULL;
	GraniteWidgetsSourceListItem* _tmp1_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = item;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (main_window_current_selected_item);
	main_window_current_selected_item = _tmp1_;
	main_window_sidebar_item_activated (self);
}


static Block2Data* block2_data_ref (Block2Data* _data2_) {
	g_atomic_int_inc (&_data2_->_ref_count_);
	return _data2_;
}


static void block2_data_unref (void * _userdata_) {
	Block2Data* _data2_;
	_data2_ = (Block2Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data2_->_ref_count_)) {
		MainWindow* self;
		self = _data2_->self;
		_g_object_unref0 (_data2_->new_tab);
		_g_free0 (_data2_->name);
		_g_object_unref0 (self);
		g_slice_free (Block2Data, _data2_);
	}
}


static Block3Data* block3_data_ref (Block3Data* _data3_) {
	g_atomic_int_inc (&_data3_->_ref_count_);
	return _data3_;
}


static void block3_data_unref (void * _userdata_) {
	Block3Data* _data3_;
	_data3_ = (Block3Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data3_->_ref_count_)) {
		MainWindow* self;
		self = _data3_->_data2_->self;
		_g_object_unref0 (_data3_->output);
		block2_data_unref (_data3_->_data2_);
		_data3_->_data2_ = NULL;
		g_slice_free (Block3Data, _data3_);
	}
}


static void _vala_PangoFontDescription_free (PangoFontDescription* self) {
	g_boxed_free (pango_font_description_get_type (), self);
}


static void __lambda35_ (Block3Data* _data3_) {
	Block2Data* _data2_;
	MainWindow* self;
	GtkTextIter start = {0};
	GtkTextIter end = {0};
	GtkTextView* _tmp0_ = NULL;
	GtkTextBuffer* _tmp1_ = NULL;
	GtkTextBuffer* _tmp2_ = NULL;
	GtkTextIter _tmp3_ = {0};
	GtkTextIter _tmp4_ = {0};
	GtkTextView* _tmp5_ = NULL;
	GtkTextBuffer* _tmp6_ = NULL;
	GtkTextBuffer* _tmp7_ = NULL;
	GtkTextIter _tmp8_ = {0};
	GtkTextIter _tmp9_ = {0};
	gchar* _tmp10_ = NULL;
	gchar* _tmp11_ = NULL;
	_data2_ = _data3_->_data2_;
	self = _data2_->self;
	_tmp0_ = _data3_->output;
	_tmp1_ = gtk_text_view_get_buffer (_tmp0_);
	_tmp2_ = _tmp1_;
	gtk_text_buffer_get_selection_bounds (_tmp2_, &_tmp3_, &_tmp4_);
	start = _tmp3_;
	end = _tmp4_;
	_tmp5_ = _data3_->output;
	_tmp6_ = gtk_text_view_get_buffer (_tmp5_);
	_tmp7_ = _tmp6_;
	_tmp8_ = start;
	_tmp9_ = end;
	_tmp10_ = gtk_text_buffer_get_text (_tmp7_, &_tmp8_, &_tmp9_, FALSE);
	_tmp11_ = _tmp10_;
	main_window_save_output_to_file (self, _tmp11_);
	_g_free0 (_tmp11_);
}


static void ___lambda35__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	__lambda35_ (self);
}


static void __lambda36_ (Block3Data* _data3_) {
	Block2Data* _data2_;
	MainWindow* self;
	GtkTextView* _tmp0_ = NULL;
	GtkTextBuffer* _tmp1_ = NULL;
	GtkTextBuffer* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	gchar* _tmp4_ = NULL;
	gchar* _tmp5_ = NULL;
	_data2_ = _data3_->_data2_;
	self = _data2_->self;
	_tmp0_ = _data3_->output;
	_tmp1_ = gtk_text_view_get_buffer (_tmp0_);
	_tmp2_ = _tmp1_;
	g_object_get (_tmp2_, "text", &_tmp3_, NULL);
	_tmp4_ = _tmp3_;
	_tmp5_ = _tmp4_;
	main_window_save_output_to_file (self, _tmp5_);
	_g_free0 (_tmp5_);
}


static void ___lambda36__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	__lambda36_ (self);
}


static void __lambda34_ (Block3Data* _data3_, GtkMenu* menu) {
	Block2Data* _data2_;
	MainWindow* self;
	GtkSeparatorMenuItem* seperator = NULL;
	GtkSeparatorMenuItem* _tmp0_ = NULL;
	GtkMenuItem* save_selection = NULL;
	const gchar* _tmp1_ = NULL;
	GtkMenuItem* _tmp2_ = NULL;
	GtkMenuItem* save_conversation = NULL;
	const gchar* _tmp3_ = NULL;
	GtkMenuItem* _tmp4_ = NULL;
	GtkMenu* _tmp5_ = NULL;
	GtkSeparatorMenuItem* _tmp6_ = NULL;
	GtkMenu* _tmp7_ = NULL;
	GtkMenuItem* _tmp8_ = NULL;
	GtkMenu* _tmp9_ = NULL;
	GtkMenuItem* _tmp10_ = NULL;
	GtkMenu* _tmp11_ = NULL;
	GtkTextView* _tmp12_ = NULL;
	GtkTextBuffer* _tmp13_ = NULL;
	GtkTextBuffer* _tmp14_ = NULL;
	gboolean _tmp15_ = FALSE;
	gboolean _tmp16_ = FALSE;
	GtkMenuItem* _tmp18_ = NULL;
	GtkMenuItem* _tmp19_ = NULL;
	_data2_ = _data3_->_data2_;
	self = _data2_->self;
	g_return_if_fail (menu != NULL);
	_tmp0_ = (GtkSeparatorMenuItem*) gtk_separator_menu_item_new ();
	g_object_ref_sink (_tmp0_);
	seperator = _tmp0_;
	_tmp1_ = _ ("Save Selection");
	_tmp2_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp1_);
	g_object_ref_sink (_tmp2_);
	save_selection = _tmp2_;
	_tmp3_ = _ ("Save Conversation");
	_tmp4_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_tmp3_);
	g_object_ref_sink (_tmp4_);
	save_conversation = _tmp4_;
	_tmp5_ = menu;
	_tmp6_ = seperator;
	gtk_container_add ((GtkContainer*) _tmp5_, (GtkWidget*) _tmp6_);
	_tmp7_ = menu;
	_tmp8_ = save_selection;
	gtk_container_add ((GtkContainer*) _tmp7_, (GtkWidget*) _tmp8_);
	_tmp9_ = menu;
	_tmp10_ = save_conversation;
	gtk_container_add ((GtkContainer*) _tmp9_, (GtkWidget*) _tmp10_);
	_tmp11_ = menu;
	gtk_widget_show_all ((GtkWidget*) _tmp11_);
	_tmp12_ = _data3_->output;
	_tmp13_ = gtk_text_view_get_buffer (_tmp12_);
	_tmp14_ = _tmp13_;
	_tmp15_ = gtk_text_buffer_get_has_selection (_tmp14_);
	_tmp16_ = _tmp15_;
	if (!_tmp16_) {
		GtkMenuItem* _tmp17_ = NULL;
		_tmp17_ = save_selection;
		gtk_widget_set_sensitive ((GtkWidget*) _tmp17_, FALSE);
	}
	_tmp18_ = save_selection;
	g_signal_connect_data (_tmp18_, "activate", (GCallback) ___lambda35__gtk_menu_item_activate, block3_data_ref (_data3_), (GClosureNotify) block3_data_unref, 0);
	_tmp19_ = save_conversation;
	g_signal_connect_data (_tmp19_, "activate", (GCallback) ___lambda36__gtk_menu_item_activate, block3_data_ref (_data3_), (GClosureNotify) block3_data_unref, 0);
	_g_object_unref0 (save_conversation);
	_g_object_unref0 (save_selection);
	_g_object_unref0 (seperator);
}


static void ___lambda34__gtk_text_view_populate_popup (GtkTextView* _sender, GtkMenu* popup, gpointer self) {
	__lambda34_ (self, popup);
}


static void _main_window_new_subject_channel_tab_new_subject (ChannelTab* _sender, gint tab_id, const gchar* subject, gpointer self) {
	main_window_new_subject ((MainWindow*) self, tab_id, subject);
}


static void _vala_PangoTabArray_free (PangoTabArray* self) {
	g_boxed_free (pango_tab_array_get_type (), self);
}


static gboolean __lambda33_ (Block2Data* _data2_) {
	MainWindow* self;
	gboolean result = FALSE;
	Block3Data* _data3_;
	ChannelTab* _tmp0_ = NULL;
	GraniteWidgetsTab* _tmp1_ = NULL;
	ChannelTab* _tmp2_ = NULL;
	GraniteWidgetsTab* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	ChannelTab* _tmp5_ = NULL;
	GraniteWidgetsTab* _tmp6_ = NULL;
	GtkMenu* _tmp7_ = NULL;
	ChannelTab* _tmp8_ = NULL;
	GraniteWidgetsTab* _tmp9_ = NULL;
	ChannelTab* _tmp10_ = NULL;
	gboolean _tmp11_ = FALSE;
	GtkTextView* _tmp21_ = NULL;
	GtkTextView* _tmp22_ = NULL;
	GtkTextView* _tmp23_ = NULL;
	GtkTextView* _tmp24_ = NULL;
	GtkTextView* _tmp25_ = NULL;
	GtkTextView* _tmp26_ = NULL;
	GtkTextView* _tmp27_ = NULL;
	PangoFontDescription* _tmp28_ = NULL;
	PangoFontDescription* _tmp29_ = NULL;
	GtkTextView* _tmp30_ = NULL;
	GtkScrolledWindow* scrolled = NULL;
	GtkScrolledWindow* _tmp31_ = NULL;
	gboolean _tmp32_ = FALSE;
	GtkScrolledWindow* _tmp34_ = NULL;
	GtkTextView* _tmp35_ = NULL;
	PangoTabArray* ptabs = NULL;
	PangoTabArray* _tmp36_ = NULL;
	PangoTabArray* _tmp37_ = NULL;
	GtkTextView* _tmp38_ = NULL;
	PangoTabArray* _tmp39_ = NULL;
	ChannelTab* _tmp40_ = NULL;
	GraniteWidgetsTab* _tmp41_ = NULL;
	GtkScrolledWindow* _tmp42_ = NULL;
	ChannelTab* _tmp43_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp44_ = NULL;
	ChannelTab* _tmp45_ = NULL;
	GraniteWidgetsTab* _tmp46_ = NULL;
	ChannelTab* _tmp47_ = NULL;
	GtkTextView* _tmp48_ = NULL;
	GeeHashMap* _tmp49_ = NULL;
	gint _tmp50_ = 0;
	ChannelTab* _tmp51_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp52_ = NULL;
	ChannelTab* _tmp53_ = NULL;
	gint _tmp54_ = 0;
	ChannelTab* _tmp55_ = NULL;
	gboolean _tmp56_ = FALSE;
	GraniteWidgetsDynamicNotebook* _tmp62_ = NULL;
	gint _tmp63_ = 0;
	gint _tmp64_ = 0;
	gint _tmp67_ = 0;
	GeeHashMap* _tmp68_ = NULL;
	ChannelTab* _tmp69_ = NULL;
	GraniteWidgetsTab* _tmp70_ = NULL;
	const gchar* _tmp71_ = NULL;
	const gchar* _tmp72_ = NULL;
	gboolean _tmp73_ = FALSE;
	Settings* _tmp82_ = NULL;
	gboolean _tmp83_ = FALSE;
	GraniteWidgetsDynamicNotebook* _tmp87_ = NULL;
	Settings* _tmp88_ = NULL;
	gboolean _tmp89_ = FALSE;
	self = _data2_->self;
	_data3_ = g_slice_new0 (Block3Data);
	_data3_->_ref_count_ = 1;
	_data3_->_data2_ = block2_data_ref (_data2_);
	_tmp0_ = _data2_->new_tab;
	_tmp1_ = granite_widgets_tab_new ("", NULL, NULL);
	g_object_ref_sink (_tmp1_);
	_g_object_unref0 (_tmp0_->tab);
	_tmp0_->tab = _tmp1_;
	_tmp2_ = _data2_->new_tab;
	_tmp3_ = _tmp2_->tab;
	_tmp4_ = _data2_->name;
	granite_widgets_tab_set_label (_tmp3_, _tmp4_);
	_tmp5_ = _data2_->new_tab;
	_tmp6_ = _tmp5_->tab;
	_tmp7_ = self->priv->tab_rightclick;
	granite_widgets_tab_set_menu (_tmp6_, _tmp7_);
	_tmp8_ = _data2_->new_tab;
	_tmp9_ = _tmp8_->tab;
	granite_widgets_tab_set_ellipsize_mode (_tmp9_, PANGO_ELLIPSIZE_NONE);
	_tmp10_ = _data2_->new_tab;
	_tmp11_ = _tmp10_->is_server_tab;
	if (_tmp11_) {
		ChannelTab* _tmp12_ = NULL;
		GraniteWidgetsTab* _tmp13_ = NULL;
		ChannelTab* _tmp14_ = NULL;
		Connection* _tmp15_ = NULL;
		Connection* _tmp16_ = NULL;
		gboolean _tmp17_ = FALSE;
		_tmp12_ = _data2_->new_tab;
		_tmp13_ = _tmp12_->tab;
		granite_widgets_tab_set_working (_tmp13_, TRUE);
		_tmp14_ = _data2_->new_tab;
		_tmp15_ = channel_tab_get_connection (_tmp14_);
		_tmp16_ = _tmp15_;
		_tmp17_ = _tmp16_->error_state;
		if (_tmp17_) {
			GraniteWidgetsDynamicNotebook* _tmp18_ = NULL;
			ChannelTab* _tmp19_ = NULL;
			GraniteWidgetsTab* _tmp20_ = NULL;
			_tmp18_ = self->priv->tabs;
			_tmp19_ = _data2_->new_tab;
			_tmp20_ = _tmp19_->tab;
			granite_widgets_dynamic_notebook_remove_tab (_tmp18_, _tmp20_);
			result = FALSE;
			block3_data_unref (_data3_);
			_data3_ = NULL;
			return result;
		}
	}
	_tmp21_ = (GtkTextView*) gtk_text_view_new ();
	g_object_ref_sink (_tmp21_);
	_data3_->output = _tmp21_;
	_tmp22_ = _data3_->output;
	gtk_text_view_set_editable (_tmp22_, FALSE);
	_tmp23_ = _data3_->output;
	gtk_text_view_set_cursor_visible (_tmp23_, FALSE);
	_tmp24_ = _data3_->output;
	gtk_text_view_set_wrap_mode (_tmp24_, GTK_WRAP_WORD_CHAR);
	_tmp25_ = _data3_->output;
	gtk_text_view_set_left_margin (_tmp25_, IRC_USER_WIDTH);
	_tmp26_ = _data3_->output;
	gtk_text_view_set_indent (_tmp26_, IRC_USER_WIDTH * -1);
	_tmp27_ = _data3_->output;
	_tmp28_ = pango_font_description_from_string ("Open Sans Regular 10");
	_tmp29_ = _tmp28_;
	gtk_widget_override_font ((GtkWidget*) _tmp27_, _tmp29_);
	__vala_PangoFontDescription_free0 (_tmp29_);
	_tmp30_ = _data3_->output;
	g_signal_connect_data (_tmp30_, "populate-popup", (GCallback) ___lambda34__gtk_text_view_populate_popup, block3_data_ref (_data3_), (GClosureNotify) block3_data_unref, 0);
	_tmp31_ = (GtkScrolledWindow*) gtk_scrolled_window_new (NULL, NULL);
	g_object_ref_sink (_tmp31_);
	scrolled = _tmp31_;
	_tmp32_ = relay_on_ubuntu;
	if (!_tmp32_) {
		GtkScrolledWindow* _tmp33_ = NULL;
		_tmp33_ = scrolled;
		g_object_set ((GtkWidget*) _tmp33_, "margin", 0, NULL);
	}
	_tmp34_ = scrolled;
	_tmp35_ = _data3_->output;
	gtk_container_add ((GtkContainer*) _tmp34_, (GtkWidget*) _tmp35_);
	_tmp36_ = pango_tab_array_new (1, TRUE);
	ptabs = _tmp36_;
	_tmp37_ = ptabs;
	pango_tab_array_set_tab (_tmp37_, 0, PANGO_TAB_LEFT, IRC_USER_WIDTH);
	_tmp38_ = _data3_->output;
	_tmp39_ = ptabs;
	gtk_text_view_set_tabs (_tmp38_, _tmp39_);
	_tmp40_ = _data2_->new_tab;
	_tmp41_ = _tmp40_->tab;
	_tmp42_ = scrolled;
	granite_widgets_tab_set_page (_tmp41_, (GtkWidget*) _tmp42_);
	_tmp43_ = _data2_->new_tab;
	g_signal_connect_object (_tmp43_, "new-subject", (GCallback) _main_window_new_subject_channel_tab_new_subject, self, 0);
	_tmp44_ = self->priv->tabs;
	_tmp45_ = _data2_->new_tab;
	_tmp46_ = _tmp45_->tab;
	granite_widgets_dynamic_notebook_insert_tab (_tmp44_, _tmp46_, -1);
	_tmp47_ = _data2_->new_tab;
	_tmp48_ = _data3_->output;
	channel_tab_set_output (_tmp47_, _tmp48_);
	_tmp49_ = self->priv->outputs;
	_tmp50_ = main_window_index;
	_tmp51_ = _data2_->new_tab;
	gee_abstract_map_set ((GeeAbstractMap*) _tmp49_, (gpointer) ((gintptr) _tmp50_), _tmp51_);
	_tmp52_ = self->priv->tabs;
	gtk_widget_show_all ((GtkWidget*) _tmp52_);
	_tmp53_ = _data2_->new_tab;
	_tmp54_ = main_window_index;
	channel_tab_set_tab_index (_tmp53_, _tmp54_);
	_tmp55_ = _data2_->new_tab;
	_tmp56_ = _tmp55_->is_server_tab;
	if (!_tmp56_) {
		ChannelTab* _tmp57_ = NULL;
		Connection* _tmp58_ = NULL;
		Connection* _tmp59_ = NULL;
		ChannelTab* _tmp60_ = NULL;
		GraniteWidgetsTab* _tmp61_ = NULL;
		_tmp57_ = _data2_->new_tab;
		_tmp58_ = channel_tab_get_connection (_tmp57_);
		_tmp59_ = _tmp58_;
		_tmp60_ = _tmp59_->server_tab;
		_tmp61_ = _tmp60_->tab;
		granite_widgets_tab_set_working (_tmp61_, FALSE);
	}
	_tmp62_ = self->priv->tabs;
	_tmp63_ = granite_widgets_dynamic_notebook_get_n_tabs (_tmp62_);
	_tmp64_ = _tmp63_;
	if (_tmp64_ == 1) {
		ChannelTab* _tmp65_ = NULL;
		GraniteWidgetsTab* _tmp66_ = NULL;
		_tmp65_ = _data2_->new_tab;
		_tmp66_ = _tmp65_->tab;
		main_window_tab_switch (self, NULL, _tmp66_);
	}
	_tmp67_ = main_window_index;
	main_window_index = _tmp67_ + 1;
	_tmp68_ = main_window_items_sidebar;
	_tmp69_ = _data2_->new_tab;
	_tmp70_ = _tmp69_->tab;
	_tmp71_ = granite_widgets_tab_get_label (_tmp70_);
	_tmp72_ = _tmp71_;
	_tmp73_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp68_, _tmp72_);
	if (_tmp73_) {
		GeeHashMap* _tmp74_ = NULL;
		ChannelTab* _tmp75_ = NULL;
		GraniteWidgetsTab* _tmp76_ = NULL;
		const gchar* _tmp77_ = NULL;
		const gchar* _tmp78_ = NULL;
		gpointer _tmp79_ = NULL;
		GraniteWidgetsSourceListItem* _tmp80_ = NULL;
		GIcon* _tmp81_ = NULL;
		_tmp74_ = main_window_items_sidebar;
		_tmp75_ = _data2_->new_tab;
		_tmp76_ = _tmp75_->tab;
		_tmp77_ = granite_widgets_tab_get_label (_tmp76_);
		_tmp78_ = _tmp77_;
		_tmp79_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp74_, _tmp78_);
		_tmp80_ = (GraniteWidgetsSourceListItem*) _tmp79_;
		_tmp81_ = main_window_active_channel;
		granite_widgets_source_list_item_set_icon (_tmp80_, _tmp81_);
		_g_object_unref0 (_tmp80_);
	}
	_tmp82_ = main_window_settings;
	_tmp83_ = settings_get_bool (_tmp82_, "change_tab");
	if (_tmp83_) {
		GraniteWidgetsDynamicNotebook* _tmp84_ = NULL;
		ChannelTab* _tmp85_ = NULL;
		GraniteWidgetsTab* _tmp86_ = NULL;
		_tmp84_ = self->priv->tabs;
		_tmp85_ = _data2_->new_tab;
		_tmp86_ = _tmp85_->tab;
		granite_widgets_dynamic_notebook_set_current (_tmp84_, _tmp86_);
	}
	main_window_rebuild_channel_list_menu (self);
	_tmp87_ = self->priv->tabs;
	_tmp88_ = main_window_settings;
	_tmp89_ = settings_get_bool (_tmp88_, "show_tabs");
	granite_widgets_dynamic_notebook_set_show_tabs (_tmp87_, _tmp89_);
	result = FALSE;
	__vala_PangoTabArray_free0 (ptabs);
	_g_object_unref0 (scrolled);
	block3_data_unref (_data3_);
	_data3_ = NULL;
	return result;
}


static gboolean ___lambda33__gsource_func (gpointer self) {
	gboolean result;
	result = __lambda33_ (self);
	return result;
}


void main_window_add_tab (MainWindow* self, ChannelTab* new_tab, const gchar* name) {
	Block2Data* _data2_;
	ChannelTab* _tmp0_ = NULL;
	ChannelTab* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	ChannelTab* _tmp5_ = NULL;
	Connection* _tmp6_ = NULL;
	Connection* _tmp7_ = NULL;
	SqlClientServer* _tmp8_ = NULL;
	const gchar* _tmp9_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (new_tab != NULL);
	g_return_if_fail (name != NULL);
	_data2_ = g_slice_new0 (Block2Data);
	_data2_->_ref_count_ = 1;
	_data2_->self = g_object_ref (self);
	_tmp0_ = new_tab;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (_data2_->new_tab);
	_data2_->new_tab = _tmp1_;
	_tmp2_ = name;
	_tmp3_ = g_strdup (_tmp2_);
	_g_free0 (_data2_->name);
	_data2_->name = _tmp3_;
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda33__gsource_func, block2_data_ref (_data2_), block2_data_unref);
	_tmp4_ = _data2_->name;
	_tmp5_ = _data2_->new_tab;
	_tmp6_ = channel_tab_get_connection (_tmp5_);
	_tmp7_ = _tmp6_;
	_tmp8_ = _tmp7_->server;
	_tmp9_ = _tmp8_->host;
	if (g_strcmp0 (_tmp4_, _tmp9_) != 0) {
		ChannelTab* _tmp10_ = NULL;
		Connection* _tmp11_ = NULL;
		Connection* _tmp12_ = NULL;
		const gchar* _tmp13_ = NULL;
		gchar* _tmp14_ = NULL;
		gchar* _tmp15_ = NULL;
		_tmp10_ = _data2_->new_tab;
		_tmp11_ = channel_tab_get_connection (_tmp10_);
		_tmp12_ = _tmp11_;
		_tmp13_ = _data2_->name;
		_tmp14_ = g_strconcat ("TOPIC ", _tmp13_, NULL);
		_tmp15_ = _tmp14_;
		connection_send_output (_tmp12_, _tmp15_);
		_g_free0 (_tmp15_);
	}
	block2_data_unref (_data2_);
	_data2_ = NULL;
}


static Block4Data* block4_data_ref (Block4Data* _data4_) {
	g_atomic_int_inc (&_data4_->_ref_count_);
	return _data4_;
}


static void block4_data_unref (void * _userdata_) {
	Block4Data* _data4_;
	_data4_ = (Block4Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
		MainWindow* self;
		self = _data4_->self;
		_g_object_unref0 (_data4_->server_name);
		_g_object_unref0 (_data4_->dialog);
		_g_object_unref0 (self);
		g_slice_free (Block4Data, _data4_);
	}
}


static void __lambda31_ (Block4Data* _data4_) {
	MainWindow* self;
	self = _data4_->self;
	gtk_dialog_response (_data4_->dialog, (gint) GTK_RESPONSE_ACCEPT);
}


static void ___lambda31__gtk_entry_activate (GtkEntry* _sender, gpointer self) {
	__lambda31_ (self);
}


static gchar* string_strip (const gchar* self) {
	gchar* result = NULL;
	gchar* _result_ = NULL;
	gchar* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_strdup (self);
	_result_ = _tmp0_;
	_tmp1_ = _result_;
	g_strstrip (_tmp1_);
	result = _result_;
	return result;
}


static void __lambda32_ (Block4Data* _data4_, gint id) {
	MainWindow* self;
	gint _tmp0_ = 0;
	self = _data4_->self;
	_tmp0_ = id;
	switch (_tmp0_) {
		case GTK_RESPONSE_ACCEPT:
		{
			gchar* name = NULL;
			const gchar* _tmp1_ = NULL;
			gchar* _tmp2_ = NULL;
			const gchar* _tmp3_ = NULL;
			gint _tmp4_ = 0;
			gint _tmp5_ = 0;
			_tmp1_ = gtk_entry_get_text (_data4_->server_name);
			_tmp2_ = string_strip (_tmp1_);
			name = _tmp2_;
			_tmp3_ = name;
			_tmp4_ = strlen (_tmp3_);
			_tmp5_ = _tmp4_;
			if (_tmp5_ > 2) {
				SqlClientServer* server = NULL;
				SqlClientServer* _tmp6_ = NULL;
				SqlClientServer* _tmp7_ = NULL;
				const gchar* _tmp8_ = NULL;
				gchar* _tmp9_ = NULL;
				SqlClientServer* _tmp10_ = NULL;
				SqlClientServer* _tmp11_ = NULL;
				const gchar* _tmp12_ = NULL;
				gchar* _tmp13_ = NULL;
				const gchar* _tmp14_ = NULL;
				gchar* _tmp15_ = NULL;
				SqlClientServer* _tmp16_ = NULL;
				_tmp6_ = sql_client_server_new ();
				server = _tmp6_;
				_tmp7_ = server;
				_tmp8_ = name;
				_tmp9_ = g_strdup (_tmp8_);
				_g_free0 (_tmp7_->host);
				_tmp7_->host = _tmp9_;
				_tmp10_ = server;
				_tmp11_ = server;
				_tmp12_ = g_get_user_name ();
				_tmp13_ = g_strdup (_tmp12_);
				_g_free0 (_tmp11_->username);
				_tmp11_->username = _tmp13_;
				_tmp14_ = _tmp11_->username;
				_tmp15_ = g_strdup (_tmp14_);
				_g_free0 (_tmp10_->nickname);
				_tmp10_->nickname = _tmp15_;
				_tmp16_ = server;
				main_window_add_server (self, _tmp16_, NULL);
				g_signal_emit_by_name (_data4_->dialog, "close");
				_sql_client_server_unref0 (server);
			}
			_g_free0 (name);
			break;
		}
		case GTK_RESPONSE_CANCEL:
		{
			g_signal_emit_by_name (_data4_->dialog, "close");
			break;
		}
		default:
		break;
	}
}


static void ___lambda32__gtk_dialog_response (GtkDialog* _sender, gint response_id, gpointer self) {
	__lambda32_ (self, response_id);
}


void main_window_new_tab_requested (MainWindow* self) {
	Block4Data* _data4_;
	const gchar* _tmp0_ = NULL;
	GtkWindow* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	GtkDialog* _tmp3_ = NULL;
	GtkBox* content = NULL;
	GtkBox* _tmp4_ = NULL;
	GtkBox* _tmp5_ = NULL;
	const gchar* _tmp6_ = NULL;
	GtkLabel* _tmp7_ = NULL;
	GtkLabel* _tmp8_ = NULL;
	GtkEntry* _tmp9_ = NULL;
	g_return_if_fail (self != NULL);
	_data4_ = g_slice_new0 (Block4Data);
	_data4_->_ref_count_ = 1;
	_data4_->self = g_object_ref (self);
	_tmp0_ = _ ("New Connection");
	_tmp1_ = main_window_window;
	_tmp2_ = _ ("Connect");
	_tmp3_ = (GtkDialog*) gtk_dialog_new_with_buttons (_tmp0_, _tmp1_, GTK_DIALOG_DESTROY_WITH_PARENT, _tmp2_, GTK_RESPONSE_ACCEPT, "_Cancel", GTK_RESPONSE_CANCEL, NULL);
	g_object_ref_sink (_tmp3_);
	_data4_->dialog = _tmp3_;
	_tmp4_ = (GtkBox*) gtk_dialog_get_content_area (_data4_->dialog);
	_tmp5_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp4_, gtk_box_get_type ()) ? ((GtkBox*) _tmp4_) : NULL);
	content = _tmp5_;
	_tmp6_ = _ ("Server address");
	_tmp7_ = (GtkLabel*) gtk_label_new (_tmp6_);
	g_object_ref_sink (_tmp7_);
	_tmp8_ = _tmp7_;
	gtk_box_pack_start (content, (GtkWidget*) _tmp8_, FALSE, FALSE, (guint) 5);
	_g_object_unref0 (_tmp8_);
	_tmp9_ = (GtkEntry*) gtk_entry_new ();
	g_object_ref_sink (_tmp9_);
	_data4_->server_name = _tmp9_;
	g_signal_connect_data (_data4_->server_name, "activate", (GCallback) ___lambda31__gtk_entry_activate, block4_data_ref (_data4_), (GClosureNotify) block4_data_unref, 0);
	gtk_box_pack_start (content, (GtkWidget*) _data4_->server_name, FALSE, FALSE, (guint) 5);
	gtk_widget_show_all ((GtkWidget*) _data4_->dialog);
	g_signal_connect_data (_data4_->dialog, "response", (GCallback) ___lambda32__gtk_dialog_response, block4_data_ref (_data4_), (GClosureNotify) block4_data_unref, 0);
	_g_object_unref0 (content);
	block4_data_unref (_data4_);
	_data4_ = NULL;
}


static void main_window_tab_remove (MainWindow* self, GraniteWidgetsTab* tab) {
	GraniteWidgetsTab* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	const gchar* _tmp3_ = NULL;
	gint id = 0;
	GraniteWidgetsTab* _tmp4_ = NULL;
	gint _tmp5_ = 0;
	Connection* tab_server = NULL;
	GeeHashMap* _tmp6_ = NULL;
	gint _tmp7_ = 0;
	gpointer _tmp8_ = NULL;
	ChannelTab* _tmp9_ = NULL;
	Connection* _tmp10_ = NULL;
	Connection* _tmp11_ = NULL;
	Connection* _tmp12_ = NULL;
	Connection* _tmp13_ = NULL;
	GeeHashMap* _tmp14_ = NULL;
	gint _tmp15_ = 0;
	gpointer _tmp16_ = NULL;
	ChannelTab* _tmp17_ = NULL;
	gboolean _tmp18_ = FALSE;
	gboolean _tmp19_ = FALSE;
	Connection* _tmp29_ = NULL;
	GeeHashMap* _tmp30_ = NULL;
	GraniteWidgetsTab* _tmp31_ = NULL;
	const gchar* _tmp32_ = NULL;
	const gchar* _tmp33_ = NULL;
	Connection* _tmp34_ = NULL;
	GeeHashMap* _tmp35_ = NULL;
	gint _tmp36_ = 0;
	gint _tmp37_ = 0;
	GeeHashMap* _tmp43_ = NULL;
	gint _tmp44_ = 0;
	GeeHashMap* _tmp45_ = NULL;
	GraniteWidgetsTab* _tmp46_ = NULL;
	const gchar* _tmp47_ = NULL;
	const gchar* _tmp48_ = NULL;
	gboolean _tmp49_ = FALSE;
	GraniteWidgetsDynamicNotebook* _tmp57_ = NULL;
	gint _tmp58_ = 0;
	gint _tmp59_ = 0;
	g_return_if_fail (self != NULL);
	g_return_if_fail (tab != NULL);
	_tmp0_ = tab;
	_tmp1_ = granite_widgets_tab_get_label (_tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = _ ("Welcome");
	if (g_strcmp0 (_tmp2_, _tmp3_) == 0) {
		return;
	}
	_tmp4_ = tab;
	_tmp5_ = main_window_lookup_channel_id (self, _tmp4_);
	id = _tmp5_;
	_tmp6_ = self->priv->outputs;
	_tmp7_ = id;
	_tmp8_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp6_, (gpointer) ((gintptr) _tmp7_));
	_tmp9_ = (ChannelTab*) _tmp8_;
	_tmp10_ = channel_tab_get_connection (_tmp9_);
	_tmp11_ = _tmp10_;
	_tmp12_ = _g_object_ref0 (_tmp11_);
	_tmp13_ = _tmp12_;
	_g_object_unref0 (_tmp9_);
	tab_server = _tmp13_;
	_tmp14_ = self->priv->outputs;
	_tmp15_ = id;
	_tmp16_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp14_, (gpointer) ((gintptr) _tmp15_));
	_tmp17_ = (ChannelTab*) _tmp16_;
	_tmp18_ = _tmp17_->is_server_tab;
	_tmp19_ = !_tmp18_;
	_g_object_unref0 (_tmp17_);
	if (_tmp19_) {
		Connection* _tmp20_ = NULL;
		GeeHashMap* _tmp21_ = NULL;
		gint _tmp22_ = 0;
		gpointer _tmp23_ = NULL;
		ChannelTab* _tmp24_ = NULL;
		const gchar* _tmp25_ = NULL;
		const gchar* _tmp26_ = NULL;
		gchar* _tmp27_ = NULL;
		gchar* _tmp28_ = NULL;
		_tmp20_ = tab_server;
		_tmp21_ = self->priv->outputs;
		_tmp22_ = id;
		_tmp23_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp21_, (gpointer) ((gintptr) _tmp22_));
		_tmp24_ = (ChannelTab*) _tmp23_;
		_tmp25_ = channel_tab_get_channel_name (_tmp24_);
		_tmp26_ = _tmp25_;
		_tmp27_ = g_strconcat ("PART ", _tmp26_, NULL);
		_tmp28_ = _tmp27_;
		connection_send_output (_tmp20_, _tmp28_);
		_g_free0 (_tmp28_);
		_g_object_unref0 (_tmp24_);
	}
	_tmp29_ = tab_server;
	_tmp30_ = _tmp29_->channel_tabs;
	_tmp31_ = tab;
	_tmp32_ = granite_widgets_tab_get_label (_tmp31_);
	_tmp33_ = _tmp32_;
	gee_abstract_map_unset ((GeeAbstractMap*) _tmp30_, _tmp33_, NULL);
	_tmp34_ = tab_server;
	_tmp35_ = _tmp34_->channel_tabs;
	_tmp36_ = gee_abstract_map_get_size ((GeeMap*) _tmp35_);
	_tmp37_ = _tmp36_;
	if (_tmp37_ < 1) {
		Connection* _tmp38_ = NULL;
		GeeHashMap* _tmp39_ = NULL;
		Connection* _tmp40_ = NULL;
		SqlClientServer* _tmp41_ = NULL;
		const gchar* _tmp42_ = NULL;
		g_info ("main_window.vala:484: Closing server");
		_tmp38_ = tab_server;
		connection_do_exit (_tmp38_);
		_tmp39_ = self->priv->clients;
		_tmp40_ = tab_server;
		_tmp41_ = _tmp40_->server;
		_tmp42_ = _tmp41_->host;
		gee_abstract_map_unset ((GeeAbstractMap*) _tmp39_, _tmp42_, NULL);
	}
	_tmp43_ = self->priv->outputs;
	_tmp44_ = id;
	gee_abstract_map_unset ((GeeAbstractMap*) _tmp43_, (gpointer) ((gintptr) _tmp44_), NULL);
	_tmp45_ = main_window_items_sidebar;
	_tmp46_ = tab;
	_tmp47_ = granite_widgets_tab_get_label (_tmp46_);
	_tmp48_ = _tmp47_;
	_tmp49_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp45_, _tmp48_);
	if (_tmp49_) {
		GeeHashMap* _tmp50_ = NULL;
		GraniteWidgetsTab* _tmp51_ = NULL;
		const gchar* _tmp52_ = NULL;
		const gchar* _tmp53_ = NULL;
		gpointer _tmp54_ = NULL;
		GraniteWidgetsSourceListItem* _tmp55_ = NULL;
		GIcon* _tmp56_ = NULL;
		_tmp50_ = main_window_items_sidebar;
		_tmp51_ = tab;
		_tmp52_ = granite_widgets_tab_get_label (_tmp51_);
		_tmp53_ = _tmp52_;
		_tmp54_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp50_, _tmp53_);
		_tmp55_ = (GraniteWidgetsSourceListItem*) _tmp54_;
		_tmp56_ = main_window_inactive_channel;
		granite_widgets_source_list_item_set_icon (_tmp55_, _tmp56_);
		_g_object_unref0 (_tmp55_);
	}
	_tmp57_ = self->priv->tabs;
	_tmp58_ = granite_widgets_dynamic_notebook_get_n_tabs (_tmp57_);
	_tmp59_ = _tmp58_;
	if (_tmp59_ == 0) {
		main_window_show_welcome_screen (self);
	}
	_g_object_unref0 (tab_server);
}


static void main_window_tab_switch (MainWindow* self, GraniteWidgetsTab* old_tab, GraniteWidgetsTab* new_tab) {
	gboolean _tmp0_ = FALSE;
	GraniteWidgetsTab* _tmp1_ = NULL;
	GraniteWidgetsTab* _tmp15_ = NULL;
	const gchar* _tmp16_ = NULL;
	const gchar* _tmp17_ = NULL;
	const gchar* _tmp18_ = NULL;
	GtkEntry* _tmp28_ = NULL;
	GraniteWidgetsTab* _tmp29_ = NULL;
	GraniteWidgetsTab* _tmp30_ = NULL;
	gint _tmp31_ = 0;
	GeeHashMap* _tmp32_ = NULL;
	gint _tmp33_ = 0;
	gboolean _tmp34_ = FALSE;
	ChannelTab* using_tab = NULL;
	GeeHashMap* _tmp35_ = NULL;
	gint _tmp36_ = 0;
	gpointer _tmp37_ = NULL;
	ChannelTab* _tmp38_ = NULL;
	GeeHashMap* _tmp39_ = NULL;
	ChannelTab* _tmp40_ = NULL;
	GraniteWidgetsTab* _tmp41_ = NULL;
	const gchar* _tmp42_ = NULL;
	const gchar* _tmp43_ = NULL;
	gboolean _tmp44_ = FALSE;
	ChannelTab* _tmp63_ = NULL;
	gboolean _tmp64_ = FALSE;
	ChannelTab* _tmp77_ = NULL;
	gboolean _tmp78_ = FALSE;
	g_return_if_fail (self != NULL);
	g_return_if_fail (new_tab != NULL);
	_tmp1_ = old_tab;
	if (_tmp1_ != NULL) {
		GraniteWidgetsTab* _tmp2_ = NULL;
		const gchar* _tmp3_ = NULL;
		const gchar* _tmp4_ = NULL;
		const gchar* _tmp5_ = NULL;
		_tmp2_ = old_tab;
		_tmp3_ = granite_widgets_tab_get_label (_tmp2_);
		_tmp4_ = _tmp3_;
		_tmp5_ = _ ("Welcome");
		_tmp0_ = g_strcmp0 (_tmp4_, _tmp5_) != 0;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		gint last_tab = 0;
		GraniteWidgetsTab* _tmp6_ = NULL;
		gint _tmp7_ = 0;
		GeeHashMap* _tmp8_ = NULL;
		gint _tmp9_ = 0;
		gboolean _tmp10_ = FALSE;
		_tmp6_ = old_tab;
		_tmp7_ = main_window_lookup_channel_id (self, _tmp6_);
		last_tab = _tmp7_;
		_tmp8_ = self->priv->outputs;
		_tmp9_ = last_tab;
		_tmp10_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp8_, (gpointer) ((gintptr) _tmp9_));
		if (_tmp10_) {
			GeeHashMap* _tmp11_ = NULL;
			gint _tmp12_ = 0;
			gpointer _tmp13_ = NULL;
			ChannelTab* _tmp14_ = NULL;
			_tmp11_ = self->priv->outputs;
			_tmp12_ = last_tab;
			_tmp13_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp11_, (gpointer) ((gintptr) _tmp12_));
			_tmp14_ = (ChannelTab*) _tmp13_;
			_tmp14_->needs_spacer = TRUE;
			_g_object_unref0 (_tmp14_);
		}
	}
	_tmp15_ = new_tab;
	_tmp16_ = granite_widgets_tab_get_label (_tmp15_);
	_tmp17_ = _tmp16_;
	_tmp18_ = _ ("Welcome");
	if (g_strcmp0 (_tmp17_, _tmp18_) == 0) {
		GtkButton* _tmp19_ = NULL;
		GtkButton* _tmp20_ = NULL;
		GtkEntry* _tmp21_ = NULL;
		GtkHeaderBar* _tmp22_ = NULL;
		Relay* _tmp23_ = NULL;
		const gchar* _tmp24_ = NULL;
		GtkHeaderBar* _tmp25_ = NULL;
		GtkHeaderBar* _tmp26_ = NULL;
		GtkButton* _tmp27_ = NULL;
		_tmp19_ = self->priv->channel_subject;
		gtk_widget_hide ((GtkWidget*) _tmp19_);
		_tmp20_ = self->priv->channel_users;
		gtk_widget_hide ((GtkWidget*) _tmp20_);
		_tmp21_ = main_window_input;
		gtk_widget_hide ((GtkWidget*) _tmp21_);
		_tmp22_ = self->priv->toolbar;
		_tmp23_ = self->priv->app;
		_tmp24_ = ((GraniteApplication*) _tmp23_)->program_name;
		gtk_header_bar_set_title (_tmp22_, _tmp24_);
		_tmp25_ = self->priv->toolbar;
		gtk_header_bar_set_has_subtitle (_tmp25_, FALSE);
		_tmp26_ = self->priv->toolbar;
		gtk_header_bar_set_subtitle (_tmp26_, "");
		_tmp27_ = main_window_paste;
		gtk_widget_hide ((GtkWidget*) _tmp27_);
		return;
	}
	_tmp28_ = main_window_input;
	gtk_widget_show ((GtkWidget*) _tmp28_);
	_tmp29_ = new_tab;
	granite_widgets_tab_set_icon (_tmp29_, NULL);
	_tmp30_ = new_tab;
	_tmp31_ = main_window_lookup_channel_id (self, _tmp30_);
	main_window_current_tab = _tmp31_;
	_tmp32_ = self->priv->outputs;
	_tmp33_ = main_window_current_tab;
	_tmp34_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp32_, (gpointer) ((gintptr) _tmp33_));
	if (!_tmp34_) {
		return;
	}
	_tmp35_ = self->priv->outputs;
	_tmp36_ = main_window_current_tab;
	_tmp37_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp35_, (gpointer) ((gintptr) _tmp36_));
	using_tab = (ChannelTab*) _tmp37_;
	_tmp38_ = using_tab;
	_tmp38_->needs_spacer = FALSE;
	_tmp39_ = main_window_items_sidebar;
	_tmp40_ = using_tab;
	_tmp41_ = _tmp40_->tab;
	_tmp42_ = granite_widgets_tab_get_label (_tmp41_);
	_tmp43_ = _tmp42_;
	_tmp44_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp39_, _tmp43_);
	if (_tmp44_) {
		GeeHashMap* _tmp45_ = NULL;
		ChannelTab* _tmp46_ = NULL;
		GraniteWidgetsTab* _tmp47_ = NULL;
		const gchar* _tmp48_ = NULL;
		const gchar* _tmp49_ = NULL;
		gpointer _tmp50_ = NULL;
		GraniteWidgetsSourceListItem* _tmp51_ = NULL;
		ChannelTab* _tmp52_ = NULL;
		gint _tmp53_ = 0;
		ChannelTab* _tmp54_ = NULL;
		GraniteWidgetsSourceList* _tmp55_ = NULL;
		GeeHashMap* _tmp56_ = NULL;
		ChannelTab* _tmp57_ = NULL;
		GraniteWidgetsTab* _tmp58_ = NULL;
		const gchar* _tmp59_ = NULL;
		const gchar* _tmp60_ = NULL;
		gpointer _tmp61_ = NULL;
		GraniteWidgetsSourceListItem* _tmp62_ = NULL;
		_tmp45_ = main_window_items_sidebar;
		_tmp46_ = using_tab;
		_tmp47_ = _tmp46_->tab;
		_tmp48_ = granite_widgets_tab_get_label (_tmp47_);
		_tmp49_ = _tmp48_;
		_tmp50_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp45_, _tmp49_);
		_tmp51_ = (GraniteWidgetsSourceListItem*) _tmp50_;
		granite_widgets_source_list_item_set_badge (_tmp51_, "");
		_g_object_unref0 (_tmp51_);
		_tmp52_ = using_tab;
		_tmp53_ = _tmp52_->message_count;
		main_window_refresh_icon (self, _tmp53_ * -1);
		_tmp54_ = using_tab;
		_tmp54_->message_count = 0;
		_tmp55_ = self->priv->servers;
		_tmp56_ = main_window_items_sidebar;
		_tmp57_ = using_tab;
		_tmp58_ = _tmp57_->tab;
		_tmp59_ = granite_widgets_tab_get_label (_tmp58_);
		_tmp60_ = _tmp59_;
		_tmp61_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp56_, _tmp60_);
		_tmp62_ = (GraniteWidgetsSourceListItem*) _tmp61_;
		granite_widgets_source_list_set_selected (_tmp55_, _tmp62_);
		_g_object_unref0 (_tmp62_);
	}
	_tmp63_ = using_tab;
	_tmp64_ = _tmp63_->has_subject;
	if (_tmp64_) {
		gchar* _tmp65_ = NULL;
		ChannelTab* _tmp66_ = NULL;
		const gchar* _tmp67_ = NULL;
		gboolean _tmp68_ = FALSE;
		gint _tmp75_ = 0;
		_tmp66_ = using_tab;
		_tmp67_ = _tmp66_->channel_subject;
		_tmp68_ = g_utf8_validate (_tmp67_, (gssize) -1, NULL);
		if (_tmp68_) {
			ChannelTab* _tmp69_ = NULL;
			const gchar* _tmp70_ = NULL;
			gchar* _tmp71_ = NULL;
			_tmp69_ = using_tab;
			_tmp70_ = _tmp69_->channel_subject;
			_tmp71_ = g_strdup (_tmp70_);
			_g_free0 (_tmp65_);
			_tmp65_ = _tmp71_;
		} else {
			ChannelTab* _tmp72_ = NULL;
			const gchar* _tmp73_ = NULL;
			gchar* _tmp74_ = NULL;
			_tmp72_ = using_tab;
			_tmp73_ = _tmp72_->channel_subject;
			_tmp74_ = g_strescape (_tmp73_, "");
			_g_free0 (_tmp65_);
			_tmp65_ = _tmp74_;
		}
		_tmp75_ = main_window_current_tab;
		main_window_new_subject (self, _tmp75_, _tmp65_);
		_g_free0 (_tmp65_);
	} else {
		GtkButton* _tmp76_ = NULL;
		_tmp76_ = self->priv->channel_subject;
		gtk_widget_hide ((GtkWidget*) _tmp76_);
	}
	_tmp77_ = using_tab;
	_tmp78_ = _tmp77_->is_server_tab;
	if (_tmp78_) {
		GtkHeaderBar* _tmp79_ = NULL;
		ChannelTab* _tmp80_ = NULL;
		GraniteWidgetsTab* _tmp81_ = NULL;
		const gchar* _tmp82_ = NULL;
		const gchar* _tmp83_ = NULL;
		GtkHeaderBar* _tmp84_ = NULL;
		GtkHeaderBar* _tmp85_ = NULL;
		GtkButton* _tmp86_ = NULL;
		GtkButton* _tmp87_ = NULL;
		_tmp79_ = self->priv->toolbar;
		_tmp80_ = using_tab;
		_tmp81_ = _tmp80_->tab;
		_tmp82_ = granite_widgets_tab_get_label (_tmp81_);
		_tmp83_ = _tmp82_;
		gtk_header_bar_set_title (_tmp79_, _tmp83_);
		_tmp84_ = self->priv->toolbar;
		gtk_header_bar_set_has_subtitle (_tmp84_, FALSE);
		_tmp85_ = self->priv->toolbar;
		gtk_header_bar_set_subtitle (_tmp85_, "");
		_tmp86_ = self->priv->channel_users;
		gtk_widget_hide ((GtkWidget*) _tmp86_);
		_tmp87_ = main_window_paste;
		gtk_widget_hide ((GtkWidget*) _tmp87_);
	} else {
		GtkButton* _tmp88_ = NULL;
		GtkHeaderBar* _tmp89_ = NULL;
		ChannelTab* _tmp90_ = NULL;
		GraniteWidgetsTab* _tmp91_ = NULL;
		const gchar* _tmp92_ = NULL;
		const gchar* _tmp93_ = NULL;
		GtkHeaderBar* _tmp94_ = NULL;
		ChannelTab* _tmp95_ = NULL;
		Connection* _tmp96_ = NULL;
		Connection* _tmp97_ = NULL;
		SqlClientServer* _tmp98_ = NULL;
		const gchar* _tmp99_ = NULL;
		GtkHeaderBar* _tmp100_ = NULL;
		ChannelTab* _tmp101_ = NULL;
		GraniteWidgetsTab* _tmp102_ = NULL;
		const gchar* _tmp103_ = NULL;
		const gchar* _tmp104_ = NULL;
		ChannelTab* _tmp105_ = NULL;
		Connection* _tmp106_ = NULL;
		Connection* _tmp107_ = NULL;
		SqlClientServer* _tmp108_ = NULL;
		const gchar* _tmp109_ = NULL;
		GtkEntry* _tmp110_ = NULL;
		ChannelTab* _tmp111_ = NULL;
		GraniteWidgetsTab* _tmp112_ = NULL;
		const gchar* _tmp113_ = NULL;
		const gchar* _tmp114_ = NULL;
		ChannelTab* _tmp115_ = NULL;
		GeeLinkedList* _tmp116_ = NULL;
		gint _tmp117_ = 0;
		gint _tmp118_ = 0;
		_tmp88_ = main_window_paste;
		gtk_widget_show ((GtkWidget*) _tmp88_);
		_tmp89_ = self->priv->toolbar;
		_tmp90_ = using_tab;
		_tmp91_ = _tmp90_->tab;
		_tmp92_ = granite_widgets_tab_get_label (_tmp91_);
		_tmp93_ = _tmp92_;
		gtk_header_bar_set_title (_tmp89_, _tmp93_);
		_tmp94_ = self->priv->toolbar;
		_tmp95_ = using_tab;
		_tmp96_ = channel_tab_get_connection (_tmp95_);
		_tmp97_ = _tmp96_;
		_tmp98_ = _tmp97_->server;
		_tmp99_ = _tmp98_->host;
		gtk_header_bar_set_subtitle (_tmp94_, _tmp99_);
		_tmp100_ = self->priv->toolbar;
		_tmp101_ = using_tab;
		_tmp102_ = _tmp101_->tab;
		_tmp103_ = granite_widgets_tab_get_label (_tmp102_);
		_tmp104_ = _tmp103_;
		_tmp105_ = using_tab;
		_tmp106_ = channel_tab_get_connection (_tmp105_);
		_tmp107_ = _tmp106_;
		_tmp108_ = _tmp107_->server;
		_tmp109_ = _tmp108_->host;
		gtk_header_bar_set_has_subtitle (_tmp100_, g_strcmp0 (_tmp104_, _tmp109_) != 0);
		_tmp110_ = main_window_input;
		_tmp111_ = using_tab;
		_tmp112_ = _tmp111_->tab;
		_tmp113_ = granite_widgets_tab_get_label (_tmp112_);
		_tmp114_ = _tmp113_;
		gtk_entry_set_placeholder_text (_tmp110_, _tmp114_);
		_tmp115_ = using_tab;
		_tmp116_ = _tmp115_->users;
		_tmp117_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp116_);
		_tmp118_ = _tmp117_;
		if (_tmp118_ < 1) {
			GtkButton* _tmp119_ = NULL;
			_tmp119_ = self->priv->channel_users;
			gtk_widget_hide ((GtkWidget*) _tmp119_);
		} else {
			GtkButton* _tmp120_ = NULL;
			_tmp120_ = self->priv->channel_users;
			gtk_widget_show_all ((GtkWidget*) _tmp120_);
		}
	}
	_g_object_unref0 (using_tab);
}


static Block5Data* block5_data_ref (Block5Data* _data5_) {
	g_atomic_int_inc (&_data5_->_ref_count_);
	return _data5_;
}


static void block5_data_unref (void * _userdata_) {
	Block5Data* _data5_;
	_data5_ = (Block5Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data5_->_ref_count_)) {
		MainWindow* self;
		self = _data5_->self;
		_g_free0 (_data5_->search_str);
		_g_object_unref0 (self);
		g_slice_free (Block5Data, _data5_);
	}
}


static gint __lambda47_ (Block5Data* _data5_) {
	MainWindow* self;
	gint result = 0;
	GeeHashMap* _tmp0_ = NULL;
	gint _tmp1_ = 0;
	gpointer _tmp2_ = NULL;
	ChannelTab* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	self = _data5_->self;
	_tmp0_ = self->priv->outputs;
	_tmp1_ = main_window_current_tab;
	_tmp2_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp0_, (gpointer) ((gintptr) _tmp1_));
	_tmp3_ = (ChannelTab*) _tmp2_;
	_tmp4_ = _data5_->search_str;
	main_window_make_user_popover_idle (self, _tmp3_, _tmp4_);
	_g_object_unref0 (_tmp3_);
	result = 0;
	return result;
}


static gpointer ___lambda47__gthread_func (gpointer self) {
	gpointer result;
	result = (gpointer) ((gintptr) __lambda47_ (self));
	block5_data_unref (self);
	return result;
}


static void main_window_make_user_popover (MainWindow* self, const gchar* search_str, gboolean need_show) {
	Block5Data* _data5_;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	GtkLabel* _tmp2_ = NULL;
	const gchar* _tmp3_ = NULL;
	gboolean _tmp4_ = FALSE;
	GtkBox* _tmp6_ = NULL;
	GThread* _tmp7_ = NULL;
	GThread* _tmp8_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (search_str != NULL);
	_data5_ = g_slice_new0 (Block5Data);
	_data5_->_ref_count_ = 1;
	_data5_->self = g_object_ref (self);
	_tmp0_ = search_str;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 (_data5_->search_str);
	_data5_->search_str = _tmp1_;
	_tmp2_ = self->priv->users_header;
	_tmp3_ = _ ("Loading...");
	gtk_label_set_text (_tmp2_, _tmp3_);
	_tmp4_ = need_show;
	if (_tmp4_) {
		GtkPopover* _tmp5_ = NULL;
		_tmp5_ = self->priv->users_popover;
		gtk_widget_show_all ((GtkWidget*) _tmp5_);
	}
	_tmp6_ = self->priv->users_list;
	gtk_widget_hide ((GtkWidget*) _tmp6_);
	_tmp7_ = g_thread_new ("User popover", ___lambda47__gthread_func, block5_data_ref (_data5_));
	_tmp8_ = _tmp7_;
	_g_thread_unref0 (_tmp8_);
	block5_data_unref (_data5_);
	_data5_ = NULL;
}


static Block6Data* block6_data_ref (Block6Data* _data6_) {
	g_atomic_int_inc (&_data6_->_ref_count_);
	return _data6_;
}


static void block6_data_unref (void * _userdata_) {
	Block6Data* _data6_;
	_data6_ = (Block6Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data6_->_ref_count_)) {
		MainWindow* self;
		self = _data6_->self;
		_g_object_unref0 (_data6_->lb_wrappers);
		_g_object_unref0 (self);
		g_slice_free (Block6Data, _data6_);
	}
}


static gboolean string_contains (const gchar* self, const gchar* needle) {
	gboolean result = FALSE;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (needle != NULL, FALSE);
	_tmp0_ = needle;
	_tmp1_ = strstr ((gchar*) self, (gchar*) _tmp0_);
	result = _tmp1_ != NULL;
	return result;
}


static gboolean __lambda51_ (Block6Data* _data6_) {
	MainWindow* self;
	gboolean result = FALSE;
	GtkBox* _tmp0_ = NULL;
	GList* _tmp1_ = NULL;
	GtkBox* _tmp17_ = NULL;
	GtkLabel* _tmp18_ = NULL;
	const gchar* _tmp19_ = NULL;
	gint _tmp20_ = 0;
	gchar* _tmp21_ = NULL;
	gchar* _tmp22_ = NULL;
	gchar* _tmp23_ = NULL;
	gchar* _tmp24_ = NULL;
	gint cols = 0;
	gint _tmp25_ = 0;
	gint _tmp26_ = 0;
	gfloat _tmp27_ = 0.0F;
	gint _tmp28_ = 0;
	gint _tmp29_ = 0;
	gint _tmp30_ = 0;
	GtkScrolledWindow* _tmp35_ = NULL;
	self = _data6_->self;
	_tmp0_ = self->priv->users_list;
	_tmp1_ = gtk_container_get_children ((GtkContainer*) _tmp0_);
	{
		GList* box_collection = NULL;
		GList* box_it = NULL;
		box_collection = _tmp1_;
		for (box_it = box_collection; box_it != NULL; box_it = box_it->next) {
			GtkWidget* box = NULL;
			box = (GtkWidget*) box_it->data;
			{
				GtkBox* _tmp2_ = NULL;
				GtkWidget* _tmp3_ = NULL;
				_tmp2_ = self->priv->users_list;
				_tmp3_ = box;
				gtk_container_remove ((GtkContainer*) _tmp2_, _tmp3_);
			}
		}
		_g_list_free0 (box_collection);
	}
	{
		GeeLinkedList* _wrapper_list = NULL;
		GeeLinkedList* _tmp4_ = NULL;
		GeeLinkedList* _tmp5_ = NULL;
		gint _wrapper_size = 0;
		GeeLinkedList* _tmp6_ = NULL;
		gint _tmp7_ = 0;
		gint _tmp8_ = 0;
		gint _wrapper_index = 0;
		_tmp4_ = _data6_->lb_wrappers;
		_tmp5_ = _g_object_ref0 (_tmp4_);
		_wrapper_list = _tmp5_;
		_tmp6_ = _wrapper_list;
		_tmp7_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp6_);
		_tmp8_ = _tmp7_;
		_wrapper_size = _tmp8_;
		_wrapper_index = -1;
		while (TRUE) {
			gint _tmp9_ = 0;
			gint _tmp10_ = 0;
			gint _tmp11_ = 0;
			GtkBox* wrapper = NULL;
			GeeLinkedList* _tmp12_ = NULL;
			gint _tmp13_ = 0;
			gpointer _tmp14_ = NULL;
			GtkBox* _tmp15_ = NULL;
			GtkBox* _tmp16_ = NULL;
			_tmp9_ = _wrapper_index;
			_wrapper_index = _tmp9_ + 1;
			_tmp10_ = _wrapper_index;
			_tmp11_ = _wrapper_size;
			if (!(_tmp10_ < _tmp11_)) {
				break;
			}
			_tmp12_ = _wrapper_list;
			_tmp13_ = _wrapper_index;
			_tmp14_ = gee_abstract_list_get ((GeeAbstractList*) _tmp12_, _tmp13_);
			wrapper = (GtkBox*) _tmp14_;
			_tmp15_ = self->priv->users_list;
			_tmp16_ = wrapper;
			gtk_box_pack_start (_tmp15_, (GtkWidget*) _tmp16_, TRUE, TRUE, (guint) 0);
			_g_object_unref0 (wrapper);
		}
		_g_object_unref0 (_wrapper_list);
	}
	_tmp17_ = self->priv->users_list;
	gtk_widget_show_all ((GtkWidget*) _tmp17_);
	_tmp18_ = self->priv->users_header;
	_tmp19_ = _ ("Total users: ");
	_tmp20_ = _data6_->i;
	_tmp21_ = g_strdup_printf ("%i", _tmp20_);
	_tmp22_ = _tmp21_;
	_tmp23_ = g_strconcat (_tmp19_, _tmp22_, NULL);
	_tmp24_ = _tmp23_;
	gtk_label_set_text (_tmp18_, _tmp24_);
	_g_free0 (_tmp24_);
	_g_free0 (_tmp22_);
	_tmp25_ = _data6_->i;
	_tmp26_ = _data6_->PER_BOX;
	_tmp27_ = ceilf (((gfloat) _tmp25_) / ((gfloat) _tmp26_));
	cols = (gint) _tmp27_;
	_tmp29_ = cols;
	_tmp30_ = _data6_->MAX_COLS;
	if (_tmp29_ > _tmp30_) {
		gint _tmp31_ = 0;
		gint _tmp32_ = 0;
		_tmp31_ = _data6_->BOX_WIDTH;
		_tmp32_ = _data6_->MAX_COLS;
		_tmp28_ = _tmp31_ * _tmp32_;
	} else {
		gint _tmp33_ = 0;
		gint _tmp34_ = 0;
		_tmp33_ = cols;
		_tmp34_ = _data6_->BOX_WIDTH;
		_tmp28_ = _tmp33_ * _tmp34_;
	}
	_tmp35_ = self->priv->users_scrolled;
	gtk_scrolled_window_set_min_content_width (_tmp35_, _tmp28_);
	result = FALSE;
	return result;
}


static gboolean ___lambda51__gsource_func (gpointer self) {
	gboolean result;
	result = __lambda51_ (self);
	return result;
}


static void main_window_make_user_popover_idle (MainWindow* self, ChannelTab* using_tab, const gchar* _search_str) {
	Block6Data* _data6_;
	const gchar* _tmp0_ = NULL;
	gchar* search_str = NULL;
	const gchar* _tmp7_ = NULL;
	gchar* _tmp8_ = NULL;
	gint type_change = 0;
	GeeLinkedList* user_types = NULL;
	const gchar* _tmp9_ = NULL;
	gint total_size = 0;
	ChannelTab* _tmp48_ = NULL;
	GeeLinkedList* _tmp49_ = NULL;
	gint _tmp50_ = 0;
	gint _tmp51_ = 0;
	ChannelTab* _tmp52_ = NULL;
	GeeLinkedList* _tmp53_ = NULL;
	gint _tmp54_ = 0;
	gint _tmp55_ = 0;
	ChannelTab* _tmp56_ = NULL;
	GeeLinkedList* _tmp57_ = NULL;
	gint _tmp58_ = 0;
	gint _tmp59_ = 0;
	ChannelTab* _tmp60_ = NULL;
	GeeLinkedList* _tmp61_ = NULL;
	gint _tmp62_ = 0;
	gint _tmp63_ = 0;
	GeeLinkedList* list_boxes = NULL;
	GeeLinkedList* _tmp64_ = NULL;
	GeeLinkedList* _tmp93_ = NULL;
	GtkBox* listbox = NULL;
	GtkBox* _tmp94_ = NULL;
	GtkBox* _tmp95_ = NULL;
	gint _tmp96_ = 0;
	GeeLinkedList* _tmp121_ = NULL;
	GtkBox* _tmp122_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (_search_str != NULL);
	_data6_ = g_slice_new0 (Block6Data);
	_data6_->_ref_count_ = 1;
	_data6_->self = g_object_ref (self);
	_tmp0_ = _search_str;
	if (g_strcmp0 (_tmp0_, "") == 0) {
		gint _tmp1_ = 0;
		_tmp1_ = self->priv->invoke_count;
		self->priv->invoke_count = _tmp1_ + 1;
	} else {
		gint _tmp2_ = 0;
		gint current_invoke_cnt = 0;
		gint _tmp3_ = 0;
		gint _tmp4_ = 0;
		gint _tmp5_ = 0;
		ChannelTab* _tmp6_ = NULL;
		_tmp2_ = self->priv->invoke_count;
		self->priv->invoke_count = _tmp2_ + 1;
		_tmp3_ = self->priv->invoke_count;
		current_invoke_cnt = _tmp3_;
		g_usleep ((gulong) 500000);
		_tmp4_ = current_invoke_cnt;
		_tmp5_ = self->priv->invoke_count;
		if (_tmp4_ != _tmp5_) {
			block6_data_unref (_data6_);
			_data6_ = NULL;
			return;
		}
		_tmp6_ = using_tab;
		if (_tmp6_ == NULL) {
			block6_data_unref (_data6_);
			_data6_ = NULL;
			return;
		}
	}
	_tmp7_ = _search_str;
	_tmp8_ = g_utf8_strdown (_tmp7_, (gssize) -1);
	search_str = _tmp8_;
	_data6_->PER_BOX = 15;
	_data6_->BOX_WIDTH = 140;
	_data6_->MAX_COLS = 4;
	type_change = 0;
	_tmp9_ = search_str;
	if (g_strcmp0 (_tmp9_, "") != 0) {
		GeeLinkedList* _user_types = NULL;
		ChannelTab* _tmp10_ = NULL;
		GeeLinkedList* _tmp11_ = NULL;
		GeeLinkedList* _tmp12_ = NULL;
		_tmp10_ = using_tab;
		_tmp11_ = channel_tab_get_all_user_lists (_tmp10_);
		_user_types = _tmp11_;
		_tmp12_ = gee_linked_list_new (GEE_TYPE_LINKED_LIST, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
		_g_object_unref0 (user_types);
		user_types = _tmp12_;
		{
			GeeLinkedList* __list_list = NULL;
			GeeLinkedList* _tmp13_ = NULL;
			GeeLinkedList* _tmp14_ = NULL;
			gint __list_size = 0;
			GeeLinkedList* _tmp15_ = NULL;
			gint _tmp16_ = 0;
			gint _tmp17_ = 0;
			gint __list_index = 0;
			_tmp13_ = _user_types;
			_tmp14_ = _g_object_ref0 (_tmp13_);
			__list_list = _tmp14_;
			_tmp15_ = __list_list;
			_tmp16_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp15_);
			_tmp17_ = _tmp16_;
			__list_size = _tmp17_;
			__list_index = -1;
			while (TRUE) {
				gint _tmp18_ = 0;
				gint _tmp19_ = 0;
				gint _tmp20_ = 0;
				GeeLinkedList* _list = NULL;
				GeeLinkedList* _tmp21_ = NULL;
				gint _tmp22_ = 0;
				gpointer _tmp23_ = NULL;
				GeeLinkedList* list = NULL;
				GeeLinkedList* _tmp24_ = NULL;
				GeeLinkedList* _tmp44_ = NULL;
				GeeLinkedList* _tmp45_ = NULL;
				_tmp18_ = __list_index;
				__list_index = _tmp18_ + 1;
				_tmp19_ = __list_index;
				_tmp20_ = __list_size;
				if (!(_tmp19_ < _tmp20_)) {
					break;
				}
				_tmp21_ = __list_list;
				_tmp22_ = __list_index;
				_tmp23_ = gee_abstract_list_get ((GeeAbstractList*) _tmp21_, _tmp22_);
				_list = (GeeLinkedList*) _tmp23_;
				_tmp24_ = gee_linked_list_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL);
				list = _tmp24_;
				{
					GeeLinkedList* _usr_list = NULL;
					GeeLinkedList* _tmp25_ = NULL;
					GeeLinkedList* _tmp26_ = NULL;
					gint _usr_size = 0;
					GeeLinkedList* _tmp27_ = NULL;
					gint _tmp28_ = 0;
					gint _tmp29_ = 0;
					gint _usr_index = 0;
					_tmp25_ = _list;
					_tmp26_ = _g_object_ref0 (_tmp25_);
					_usr_list = _tmp26_;
					_tmp27_ = _usr_list;
					_tmp28_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp27_);
					_tmp29_ = _tmp28_;
					_usr_size = _tmp29_;
					_usr_index = -1;
					while (TRUE) {
						gint _tmp30_ = 0;
						gint _tmp31_ = 0;
						gint _tmp32_ = 0;
						gchar* usr = NULL;
						GeeLinkedList* _tmp33_ = NULL;
						gint _tmp34_ = 0;
						gpointer _tmp35_ = NULL;
						const gchar* _tmp36_ = NULL;
						gchar* _tmp37_ = NULL;
						gchar* _tmp38_ = NULL;
						const gchar* _tmp39_ = NULL;
						gboolean _tmp40_ = FALSE;
						gboolean _tmp41_ = FALSE;
						_tmp30_ = _usr_index;
						_usr_index = _tmp30_ + 1;
						_tmp31_ = _usr_index;
						_tmp32_ = _usr_size;
						if (!(_tmp31_ < _tmp32_)) {
							break;
						}
						_tmp33_ = _usr_list;
						_tmp34_ = _usr_index;
						_tmp35_ = gee_abstract_list_get ((GeeAbstractList*) _tmp33_, _tmp34_);
						usr = (gchar*) _tmp35_;
						_tmp36_ = usr;
						_tmp37_ = g_utf8_strdown (_tmp36_, (gssize) -1);
						_tmp38_ = _tmp37_;
						_tmp39_ = search_str;
						_tmp40_ = string_contains (_tmp38_, _tmp39_);
						_tmp41_ = _tmp40_;
						_g_free0 (_tmp38_);
						if (_tmp41_) {
							GeeLinkedList* _tmp42_ = NULL;
							const gchar* _tmp43_ = NULL;
							_tmp42_ = list;
							_tmp43_ = usr;
							gee_abstract_collection_add ((GeeAbstractCollection*) _tmp42_, _tmp43_);
						}
						_g_free0 (usr);
					}
					_g_object_unref0 (_usr_list);
				}
				_tmp44_ = user_types;
				_tmp45_ = list;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp44_, _tmp45_);
				_g_object_unref0 (list);
				_g_object_unref0 (_list);
			}
			_g_object_unref0 (__list_list);
		}
		_g_object_unref0 (_user_types);
	} else {
		ChannelTab* _tmp46_ = NULL;
		GeeLinkedList* _tmp47_ = NULL;
		_tmp46_ = using_tab;
		_tmp47_ = channel_tab_get_all_user_lists (_tmp46_);
		_g_object_unref0 (user_types);
		user_types = _tmp47_;
	}
	_tmp48_ = using_tab;
	_tmp49_ = _tmp48_->users;
	_tmp50_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp49_);
	_tmp51_ = _tmp50_;
	_tmp52_ = using_tab;
	_tmp53_ = _tmp52_->owners;
	_tmp54_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp53_);
	_tmp55_ = _tmp54_;
	_tmp56_ = using_tab;
	_tmp57_ = _tmp56_->ops;
	_tmp58_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp57_);
	_tmp59_ = _tmp58_;
	_tmp60_ = using_tab;
	_tmp61_ = _tmp60_->half_ops;
	_tmp62_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp61_);
	_tmp63_ = _tmp62_;
	total_size = ((_tmp51_ + _tmp55_) + _tmp59_) + _tmp63_;
	_tmp64_ = gee_linked_list_new (gtk_event_box_get_type (), (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
	list_boxes = _tmp64_;
	{
		GeeLinkedList* _type_list = NULL;
		GeeLinkedList* _tmp65_ = NULL;
		GeeLinkedList* _tmp66_ = NULL;
		gint _type_size = 0;
		GeeLinkedList* _tmp67_ = NULL;
		gint _tmp68_ = 0;
		gint _tmp69_ = 0;
		gint _type_index = 0;
		_tmp65_ = user_types;
		_tmp66_ = _g_object_ref0 (_tmp65_);
		_type_list = _tmp66_;
		_tmp67_ = _type_list;
		_tmp68_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp67_);
		_tmp69_ = _tmp68_;
		_type_size = _tmp69_;
		_type_index = -1;
		while (TRUE) {
			gint _tmp70_ = 0;
			gint _tmp71_ = 0;
			gint _tmp72_ = 0;
			GeeList* type = NULL;
			GeeLinkedList* _tmp73_ = NULL;
			gint _tmp74_ = 0;
			gpointer _tmp75_ = NULL;
			gint _tmp92_ = 0;
			_tmp70_ = _type_index;
			_type_index = _tmp70_ + 1;
			_tmp71_ = _type_index;
			_tmp72_ = _type_size;
			if (!(_tmp71_ < _tmp72_)) {
				break;
			}
			_tmp73_ = _type_list;
			_tmp74_ = _type_index;
			_tmp75_ = gee_abstract_list_get ((GeeAbstractList*) _tmp73_, _tmp74_);
			type = (GeeList*) ((GeeLinkedList*) _tmp75_);
			{
				GeeList* _user_list = NULL;
				GeeList* _tmp76_ = NULL;
				GeeList* _tmp77_ = NULL;
				gint _user_size = 0;
				GeeList* _tmp78_ = NULL;
				gint _tmp79_ = 0;
				gint _tmp80_ = 0;
				gint _user_index = 0;
				_tmp76_ = type;
				_tmp77_ = _g_object_ref0 (_tmp76_);
				_user_list = _tmp77_;
				_tmp78_ = _user_list;
				_tmp79_ = gee_collection_get_size ((GeeCollection*) _tmp78_);
				_tmp80_ = _tmp79_;
				_user_size = _tmp80_;
				_user_index = -1;
				while (TRUE) {
					gint _tmp81_ = 0;
					gint _tmp82_ = 0;
					gint _tmp83_ = 0;
					gchar* user = NULL;
					GeeList* _tmp84_ = NULL;
					gint _tmp85_ = 0;
					gpointer _tmp86_ = NULL;
					GeeLinkedList* _tmp87_ = NULL;
					const gchar* _tmp88_ = NULL;
					gint _tmp89_ = 0;
					GtkEventBox* _tmp90_ = NULL;
					GtkEventBox* _tmp91_ = NULL;
					_tmp81_ = _user_index;
					_user_index = _tmp81_ + 1;
					_tmp82_ = _user_index;
					_tmp83_ = _user_size;
					if (!(_tmp82_ < _tmp83_)) {
						break;
					}
					_tmp84_ = _user_list;
					_tmp85_ = _user_index;
					_tmp86_ = gee_list_get (_tmp84_, _tmp85_);
					user = (gchar*) _tmp86_;
					_tmp87_ = list_boxes;
					_tmp88_ = user;
					_tmp89_ = type_change;
					_tmp90_ = main_window_make_user_eventbox (self, _tmp88_, _tmp89_);
					_tmp91_ = _tmp90_;
					gee_abstract_collection_add ((GeeAbstractCollection*) _tmp87_, _tmp91_);
					_g_object_unref0 (_tmp91_);
					_g_free0 (user);
				}
				_g_object_unref0 (_user_list);
			}
			_tmp92_ = type_change;
			type_change = _tmp92_ + 1;
			_g_object_unref0 (type);
		}
		_g_object_unref0 (_type_list);
	}
	_tmp93_ = gee_linked_list_new (gtk_box_get_type (), (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
	_data6_->lb_wrappers = _tmp93_;
	_tmp94_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, 0);
	g_object_ref_sink (_tmp94_);
	listbox = _tmp94_;
	_tmp95_ = listbox;
	_tmp96_ = _data6_->BOX_WIDTH;
	g_object_set ((GtkWidget*) _tmp95_, "width-request", _tmp96_, NULL);
	_data6_->i = 0;
	{
		GeeLinkedList* _box_list = NULL;
		GeeLinkedList* _tmp97_ = NULL;
		GeeLinkedList* _tmp98_ = NULL;
		gint _box_size = 0;
		GeeLinkedList* _tmp99_ = NULL;
		gint _tmp100_ = 0;
		gint _tmp101_ = 0;
		gint _box_index = 0;
		_tmp97_ = list_boxes;
		_tmp98_ = _g_object_ref0 (_tmp97_);
		_box_list = _tmp98_;
		_tmp99_ = _box_list;
		_tmp100_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp99_);
		_tmp101_ = _tmp100_;
		_box_size = _tmp101_;
		_box_index = -1;
		while (TRUE) {
			gint _tmp102_ = 0;
			gint _tmp103_ = 0;
			gint _tmp104_ = 0;
			GtkEventBox* box = NULL;
			GeeLinkedList* _tmp105_ = NULL;
			gint _tmp106_ = 0;
			gpointer _tmp107_ = NULL;
			gint _tmp108_ = 0;
			GtkBox* _tmp109_ = NULL;
			GtkEventBox* _tmp110_ = NULL;
			gboolean _tmp111_ = FALSE;
			gint _tmp112_ = 0;
			gint _tmp113_ = 0;
			_tmp102_ = _box_index;
			_box_index = _tmp102_ + 1;
			_tmp103_ = _box_index;
			_tmp104_ = _box_size;
			if (!(_tmp103_ < _tmp104_)) {
				break;
			}
			_tmp105_ = _box_list;
			_tmp106_ = _box_index;
			_tmp107_ = gee_abstract_list_get ((GeeAbstractList*) _tmp105_, _tmp106_);
			box = (GtkEventBox*) _tmp107_;
			_tmp108_ = _data6_->i;
			_data6_->i = _tmp108_ + 1;
			_tmp109_ = listbox;
			_tmp110_ = box;
			gtk_box_pack_start (_tmp109_, (GtkWidget*) _tmp110_, FALSE, FALSE, (guint) 0);
			_tmp112_ = _data6_->i;
			_tmp113_ = _data6_->PER_BOX;
			if ((_tmp112_ % _tmp113_) == 0) {
				gint _tmp114_ = 0;
				gint _tmp115_ = 0;
				_tmp114_ = total_size;
				_tmp115_ = _data6_->i;
				_tmp111_ = _tmp114_ >= _tmp115_;
			} else {
				_tmp111_ = FALSE;
			}
			if (_tmp111_) {
				GtkBox* _tmp116_ = NULL;
				gint _tmp117_ = 0;
				GeeLinkedList* _tmp118_ = NULL;
				GtkBox* _tmp119_ = NULL;
				GtkBox* _tmp120_ = NULL;
				_tmp116_ = listbox;
				_tmp117_ = _data6_->BOX_WIDTH;
				g_object_set ((GtkWidget*) _tmp116_, "width-request", _tmp117_, NULL);
				_tmp118_ = _data6_->lb_wrappers;
				_tmp119_ = listbox;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp118_, _tmp119_);
				_tmp120_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, 0);
				g_object_ref_sink (_tmp120_);
				_g_object_unref0 (listbox);
				listbox = _tmp120_;
			}
			_g_object_unref0 (box);
		}
		_g_object_unref0 (_box_list);
	}
	_tmp121_ = _data6_->lb_wrappers;
	_tmp122_ = listbox;
	gee_abstract_collection_add ((GeeAbstractCollection*) _tmp121_, _tmp122_);
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda51__gsource_func, block6_data_ref (_data6_), block6_data_unref);
	_g_object_unref0 (listbox);
	_g_object_unref0 (list_boxes);
	_g_object_unref0 (user_types);
	_g_free0 (search_str);
	block6_data_unref (_data6_);
	_data6_ = NULL;
}


static Block7Data* block7_data_ref (Block7Data* _data7_) {
	g_atomic_int_inc (&_data7_->_ref_count_);
	return _data7_;
}


static void block7_data_unref (void * _userdata_) {
	Block7Data* _data7_;
	_data7_ = (Block7Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data7_->_ref_count_)) {
		MainWindow* self;
		self = _data7_->self;
		_g_object_unref0 (_data7_->eb);
		_g_free0 (_data7_->user);
		_g_object_unref0 (self);
		g_slice_free (Block7Data, _data7_);
	}
}


static gboolean __lambda48_ (Block7Data* _data7_) {
	MainWindow* self;
	gboolean result = FALSE;
	GtkEventBox* _tmp0_ = NULL;
	self = _data7_->self;
	_tmp0_ = _data7_->eb;
	gtk_widget_set_state_flags ((GtkWidget*) _tmp0_, GTK_STATE_FLAG_PRELIGHT | GTK_STATE_FLAG_SELECTED, TRUE);
	result = FALSE;
	return result;
}


static gboolean ___lambda48__gtk_widget_enter_notify_event (GtkWidget* _sender, GdkEventCrossing* event, gpointer self) {
	gboolean result;
	result = __lambda48_ (self);
	return result;
}


static gboolean __lambda49_ (Block7Data* _data7_) {
	MainWindow* self;
	gboolean result = FALSE;
	GtkEventBox* _tmp0_ = NULL;
	self = _data7_->self;
	_tmp0_ = _data7_->eb;
	gtk_widget_set_state_flags ((GtkWidget*) _tmp0_, GTK_STATE_FLAG_NORMAL, TRUE);
	result = FALSE;
	return result;
}


static gboolean ___lambda49__gtk_widget_leave_notify_event (GtkWidget* _sender, GdkEventCrossing* event, gpointer self) {
	gboolean result;
	result = __lambda49_ (self);
	return result;
}


static gboolean __lambda50_ (Block7Data* _data7_, GdkEventButton* event) {
	MainWindow* self;
	gboolean result = FALSE;
	GdkEventButton* _tmp0_ = NULL;
	guint _tmp1_ = 0U;
	self = _data7_->self;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = event;
	_tmp1_ = _tmp0_->button;
	if (_tmp1_ == ((guint) 3)) {
		const gchar* _tmp2_ = NULL;
		gchar* _tmp3_ = NULL;
		GtkMenu* _tmp4_ = NULL;
		GdkEventButton* _tmp5_ = NULL;
		guint _tmp6_ = 0U;
		GdkEventButton* _tmp7_ = NULL;
		guint32 _tmp8_ = 0U;
		_tmp2_ = _data7_->user;
		_tmp3_ = g_strdup (_tmp2_);
		_g_free0 (self->priv->channel_user_selected);
		self->priv->channel_user_selected = _tmp3_;
		_tmp4_ = self->priv->user_menu;
		_tmp5_ = event;
		_tmp6_ = _tmp5_->button;
		_tmp7_ = event;
		_tmp8_ = _tmp7_->time;
		gtk_menu_popup (_tmp4_, NULL, NULL, NULL, NULL, _tmp6_, _tmp8_);
	} else {
		GdkEventButton* _tmp9_ = NULL;
		guint _tmp10_ = 0U;
		_tmp9_ = event;
		_tmp10_ = _tmp9_->button;
		if (_tmp10_ == ((guint) 1)) {
			const gchar* _tmp11_ = NULL;
			gchar* _tmp12_ = NULL;
			gchar* _tmp13_ = NULL;
			_tmp11_ = _data7_->user;
			_tmp12_ = g_strconcat (_tmp11_, ": ", NULL);
			_tmp13_ = _tmp12_;
			main_window_fill_input (_tmp13_);
			_g_free0 (_tmp13_);
		}
	}
	result = TRUE;
	return result;
}


static gboolean ___lambda50__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda50_ (self, event);
	return result;
}


static GtkEventBox* main_window_make_user_eventbox (MainWindow* self, const gchar* user, gint type) {
	GtkEventBox* result = NULL;
	Block7Data* _data7_;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	GtkEventBox* _tmp2_ = NULL;
	GtkEventBox* _tmp3_ = NULL;
	GtkEventBox* _tmp4_ = NULL;
	GtkLabel* label = NULL;
	GtkLabel* _tmp5_ = NULL;
	GdkRGBA color = {0};
	gint _tmp6_ = 0;
	GtkLabel* _tmp31_ = NULL;
	const gchar* _tmp32_ = NULL;
	GtkLabel* _tmp33_ = NULL;
	GtkLabel* _tmp34_ = NULL;
	GtkLabel* _tmp35_ = NULL;
	GtkEventBox* _tmp36_ = NULL;
	GtkLabel* _tmp37_ = NULL;
	GtkEventBox* _tmp38_ = NULL;
	GtkEventBox* _tmp39_ = NULL;
	GtkEventBox* _tmp40_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (user != NULL, NULL);
	_data7_ = g_slice_new0 (Block7Data);
	_data7_->_ref_count_ = 1;
	_data7_->self = g_object_ref (self);
	_tmp0_ = user;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 (_data7_->user);
	_data7_->user = _tmp1_;
	_tmp2_ = (GtkEventBox*) gtk_event_box_new ();
	g_object_ref_sink (_tmp2_);
	_data7_->eb = _tmp2_;
	_tmp3_ = _data7_->eb;
	g_signal_connect_data ((GtkWidget*) _tmp3_, "enter-notify-event", (GCallback) ___lambda48__gtk_widget_enter_notify_event, block7_data_ref (_data7_), (GClosureNotify) block7_data_unref, 0);
	_tmp4_ = _data7_->eb;
	g_signal_connect_data ((GtkWidget*) _tmp4_, "leave-notify-event", (GCallback) ___lambda49__gtk_widget_leave_notify_event, block7_data_ref (_data7_), (GClosureNotify) block7_data_unref, 0);
	_tmp5_ = (GtkLabel*) gtk_label_new ("");
	g_object_ref_sink (_tmp5_);
	label = _tmp5_;
	memset (&color, 0, sizeof (GdkRGBA));
	_tmp6_ = type;
	if (_tmp6_ == 0) {
		GtkLabel* _tmp7_ = NULL;
		const gchar* _tmp8_ = NULL;
		GtkLabel* _tmp9_ = NULL;
		GdkRGBA _tmp10_ = {0};
		gdk_rgba_parse (&color, "#00D901");
		_tmp7_ = label;
		_tmp8_ = _ ("Owner");
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp7_, _tmp8_);
		_tmp9_ = label;
		_tmp10_ = color;
		gtk_widget_override_color ((GtkWidget*) _tmp9_, GTK_STATE_FLAG_NORMAL, &_tmp10_);
	} else {
		gint _tmp11_ = 0;
		_tmp11_ = type;
		if (_tmp11_ == 1) {
			GtkLabel* _tmp12_ = NULL;
			const gchar* _tmp13_ = NULL;
			GtkLabel* _tmp14_ = NULL;
			GdkRGBA _tmp15_ = {0};
			gdk_rgba_parse (&color, "#F5E219");
			_tmp12_ = label;
			_tmp13_ = _ ("Operator");
			gtk_widget_set_tooltip_text ((GtkWidget*) _tmp12_, _tmp13_);
			_tmp14_ = label;
			_tmp15_ = color;
			gtk_widget_override_color ((GtkWidget*) _tmp14_, GTK_STATE_FLAG_NORMAL, &_tmp15_);
		} else {
			gint _tmp16_ = 0;
			_tmp16_ = type;
			if (_tmp16_ == 2) {
				GtkLabel* _tmp17_ = NULL;
				const gchar* _tmp18_ = NULL;
				GtkLabel* _tmp19_ = NULL;
				GdkRGBA _tmp20_ = {0};
				gdk_rgba_parse (&color, "#9A19F5");
				_tmp17_ = label;
				_tmp18_ = _ ("Half Operator");
				gtk_widget_set_tooltip_text ((GtkWidget*) _tmp17_, _tmp18_);
				_tmp19_ = label;
				_tmp20_ = color;
				gtk_widget_override_color ((GtkWidget*) _tmp19_, GTK_STATE_FLAG_NORMAL, &_tmp20_);
			} else {
				GeeHashMap* _tmp21_ = NULL;
				gint _tmp22_ = 0;
				gpointer _tmp23_ = NULL;
				ChannelTab* _tmp24_ = NULL;
				GeeLinkedList* _tmp25_ = NULL;
				const gchar* _tmp26_ = NULL;
				gboolean _tmp27_ = FALSE;
				gboolean _tmp28_ = FALSE;
				_tmp21_ = self->priv->outputs;
				_tmp22_ = main_window_current_tab;
				_tmp23_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp21_, (gpointer) ((gintptr) _tmp22_));
				_tmp24_ = (ChannelTab*) _tmp23_;
				_tmp25_ = _tmp24_->blocked_users;
				_tmp26_ = _data7_->user;
				_tmp27_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp25_, _tmp26_);
				_tmp28_ = _tmp27_;
				_g_object_unref0 (_tmp24_);
				if (_tmp28_) {
					GtkLabel* _tmp29_ = NULL;
					GdkRGBA _tmp30_ = {0};
					gdk_rgba_parse (&color, "#FF0000");
					_tmp29_ = label;
					_tmp30_ = color;
					gtk_widget_override_color ((GtkWidget*) _tmp29_, GTK_STATE_FLAG_NORMAL, &_tmp30_);
				}
			}
		}
	}
	_tmp31_ = label;
	_tmp32_ = _data7_->user;
	gtk_label_set_text (_tmp31_, _tmp32_);
	_tmp33_ = label;
	gtk_label_set_width_chars (_tmp33_, IRC_USER_LENGTH);
	_tmp34_ = label;
	_tmp35_ = label;
	gtk_widget_set_margin_bottom ((GtkWidget*) _tmp35_, 4);
	gtk_widget_set_margin_top ((GtkWidget*) _tmp34_, 4);
	_tmp36_ = _data7_->eb;
	_tmp37_ = label;
	gtk_container_add ((GtkContainer*) _tmp36_, (GtkWidget*) _tmp37_);
	_tmp38_ = _data7_->eb;
	g_signal_connect_data ((GtkWidget*) _tmp38_, "button-press-event", (GCallback) ___lambda50__gtk_widget_button_press_event, block7_data_ref (_data7_), (GClosureNotify) block7_data_unref, 0);
	_tmp39_ = _data7_->eb;
	_tmp40_ = _g_object_ref0 (_tmp39_);
	result = _tmp40_;
	_g_object_unref0 (label);
	block7_data_unref (_data7_);
	_data7_ = NULL;
	return result;
}


static gboolean main_window_click_private_message (MainWindow* self, GdkEventButton* event) {
	gboolean result = FALSE;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	gchar* _tmp2_ = NULL;
	GtkMenu* _tmp3_ = NULL;
	GtkPopover* _tmp4_ = NULL;
	ChannelTab* using_tab = NULL;
	GeeHashMap* _tmp5_ = NULL;
	gint _tmp6_ = 0;
	gpointer _tmp7_ = NULL;
	ChannelTab* user_tab = NULL;
	Connection* _tmp8_ = NULL;
	Connection* _tmp9_ = NULL;
	const gchar* _tmp10_ = NULL;
	gchar* _tmp11_ = NULL;
	gchar* _tmp12_ = NULL;
	ChannelTab* _tmp13_ = NULL;
	ChannelTab* _tmp14_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp15_ = NULL;
	GraniteWidgetsTab* _tmp16_ = NULL;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = self->priv->channel_user_selected;
	_tmp1_ = g_strconcat ("Selected user is ", _tmp0_, NULL);
	_tmp2_ = _tmp1_;
	g_info ("main_window.vala:698: %s", _tmp2_);
	_g_free0 (_tmp2_);
	_tmp3_ = self->priv->user_menu;
	gtk_menu_popdown (_tmp3_);
	_tmp4_ = self->priv->users_popover;
	gtk_widget_set_visible ((GtkWidget*) _tmp4_, FALSE);
	_tmp5_ = self->priv->outputs;
	_tmp6_ = main_window_current_tab;
	_tmp7_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp5_, (gpointer) ((gintptr) _tmp6_));
	using_tab = (ChannelTab*) _tmp7_;
	_tmp8_ = channel_tab_get_connection (using_tab);
	_tmp9_ = _tmp8_;
	_tmp10_ = self->priv->channel_user_selected;
	_tmp11_ = irc_remove_user_prefix (_tmp10_);
	_tmp12_ = _tmp11_;
	_tmp13_ = connection_add_channel_tab (_tmp9_, _tmp12_, FALSE);
	_tmp14_ = _tmp13_;
	_g_free0 (_tmp12_);
	user_tab = _tmp14_;
	_tmp15_ = self->priv->tabs;
	_tmp16_ = user_tab->tab;
	granite_widgets_dynamic_notebook_set_current (_tmp15_, _tmp16_);
	result = FALSE;
	_g_object_unref0 (user_tab);
	_g_object_unref0 (using_tab);
	return result;
}


static gboolean main_window_click_block (MainWindow* self, GdkEventButton* event) {
	gboolean result = FALSE;
	GtkMenu* _tmp0_ = NULL;
	ChannelTab* using_tab = NULL;
	GeeHashMap* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	gpointer _tmp3_ = NULL;
	ChannelTab* _tmp4_ = NULL;
	GeeLinkedList* _tmp5_ = NULL;
	const gchar* _tmp6_ = NULL;
	gboolean _tmp7_ = FALSE;
	GtkPopover* _tmp12_ = NULL;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = self->priv->user_menu;
	gtk_menu_popdown (_tmp0_);
	_tmp1_ = self->priv->outputs;
	_tmp2_ = main_window_current_tab;
	_tmp3_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp1_, (gpointer) ((gintptr) _tmp2_));
	using_tab = (ChannelTab*) _tmp3_;
	_tmp4_ = using_tab;
	_tmp5_ = _tmp4_->blocked_users;
	_tmp6_ = self->priv->channel_user_selected;
	_tmp7_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp5_, _tmp6_);
	if (_tmp7_) {
		ChannelTab* _tmp8_ = NULL;
		const gchar* _tmp9_ = NULL;
		_tmp8_ = using_tab;
		_tmp9_ = self->priv->channel_user_selected;
		channel_tab_remove_block_list (_tmp8_, _tmp9_);
	} else {
		ChannelTab* _tmp10_ = NULL;
		const gchar* _tmp11_ = NULL;
		_tmp10_ = using_tab;
		_tmp11_ = self->priv->channel_user_selected;
		channel_tab_add_block_list (_tmp10_, _tmp11_);
	}
	_tmp12_ = self->priv->users_popover;
	gtk_widget_set_visible ((GtkWidget*) _tmp12_, FALSE);
	result = FALSE;
	_g_object_unref0 (using_tab);
	return result;
}


static void _main_window_add_tab_connection_new_tab (Connection* _sender, ChannelTab* tab, const gchar* name, gpointer self) {
	main_window_add_tab ((MainWindow*) self, tab, name);
}


static void _main_window_add_text_connection_new_message (Connection* _sender, ChannelTab* tab, Message* message, gboolean is_error, gpointer self) {
	main_window_add_text ((MainWindow*) self, tab, message, is_error);
}


static void _main_window_sidebar_state_connection_change_channel_state (Connection* _sender, const gchar* chan_name, const gchar* state, gpointer self) {
	main_window_sidebar_state ((MainWindow*) self, chan_name, state);
}


void main_window_add_server (MainWindow* self, SqlClientServer* server, GeeLinkedList* connect_channels) {
	Connection* connection = NULL;
	Connection* _tmp0_ = NULL;
	GeeHashMap* _tmp1_ = NULL;
	SqlClientServer* _tmp2_ = NULL;
	const gchar* _tmp3_ = NULL;
	Connection* _tmp4_ = NULL;
	Connection* _tmp5_ = NULL;
	Connection* _tmp6_ = NULL;
	Connection* _tmp7_ = NULL;
	GeeLinkedList* _tmp8_ = NULL;
	Connection* _tmp12_ = NULL;
	SqlClientServer* _tmp13_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (server != NULL);
	_tmp0_ = connection_new ();
	connection = _tmp0_;
	_tmp1_ = self->priv->clients;
	_tmp2_ = server;
	_tmp3_ = _tmp2_->host;
	_tmp4_ = connection;
	gee_abstract_map_set ((GeeAbstractMap*) _tmp1_, _tmp3_, _tmp4_);
	_tmp5_ = connection;
	g_signal_connect_object (_tmp5_, "new-tab", (GCallback) _main_window_add_tab_connection_new_tab, self, 0);
	_tmp6_ = connection;
	g_signal_connect_object (_tmp6_, "new-message", (GCallback) _main_window_add_text_connection_new_message, self, 0);
	_tmp7_ = connection;
	g_signal_connect_object (_tmp7_, "change-channel-state", (GCallback) _main_window_sidebar_state_connection_change_channel_state, self, 0);
	_tmp8_ = connect_channels;
	if (_tmp8_ != NULL) {
		Connection* _tmp9_ = NULL;
		GeeLinkedList* _tmp10_ = NULL;
		GeeLinkedList* _tmp11_ = NULL;
		_tmp9_ = connection;
		_tmp10_ = connect_channels;
		_tmp11_ = _g_object_ref0 (_tmp10_);
		_g_object_unref0 (_tmp9_->channel_autoconnect);
		_tmp9_->channel_autoconnect = _tmp11_;
	}
	_tmp12_ = connection;
	_tmp13_ = server;
	connection_connect_to_server (_tmp12_, _tmp13_);
	_g_object_unref0 (connection);
}


static void main_window_sidebar_state (MainWindow* self, const gchar* name, const gchar* state) {
	GeeHashMap* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	gboolean _tmp2_ = FALSE;
	GIcon* pixbuf = NULL;
	GIcon* _tmp3_ = NULL;
	GIcon* _tmp4_ = NULL;
	const gchar* _tmp5_ = NULL;
	const gchar* _tmp6_ = NULL;
	GQuark _tmp8_ = 0U;
	static GQuark _tmp7_label0 = 0;
	static GQuark _tmp7_label1 = 0;
	static GQuark _tmp7_label2 = 0;
	GeeHashMap* _tmp23_ = NULL;
	const gchar* _tmp24_ = NULL;
	gpointer _tmp25_ = NULL;
	GraniteWidgetsSourceListItem* _tmp26_ = NULL;
	GIcon* _tmp27_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (name != NULL);
	g_return_if_fail (state != NULL);
	_tmp0_ = main_window_items_sidebar;
	_tmp1_ = name;
	_tmp2_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp0_, _tmp1_);
	if (!_tmp2_) {
		return;
	}
	_tmp3_ = main_window_inactive_channel;
	_tmp4_ = _g_object_ref0 (_tmp3_);
	pixbuf = _tmp4_;
	_tmp5_ = state;
	_tmp6_ = _tmp5_;
	_tmp8_ = (NULL == _tmp6_) ? 0 : g_quark_from_string (_tmp6_);
	if (_tmp8_ == ((0 != _tmp7_label0) ? _tmp7_label0 : (_tmp7_label0 = g_quark_from_static_string ("active")))) {
		switch (0) {
			default:
			{
				GIcon* _tmp9_ = NULL;
				GIcon* _tmp10_ = NULL;
				_tmp9_ = main_window_active_channel;
				_tmp10_ = _g_object_ref0 (_tmp9_);
				_g_object_unref0 (pixbuf);
				pixbuf = _tmp10_;
				break;
			}
		}
	} else if (_tmp8_ == ((0 != _tmp7_label1) ? _tmp7_label1 : (_tmp7_label1 = g_quark_from_static_string ("loading")))) {
		switch (0) {
			default:
			{
				GIcon* _tmp11_ = NULL;
				GIcon* _tmp12_ = NULL;
				_tmp11_ = main_window_loading_channel;
				_tmp12_ = _g_object_ref0 (_tmp11_);
				_g_object_unref0 (pixbuf);
				pixbuf = _tmp12_;
				break;
			}
		}
	} else if (_tmp8_ == ((0 != _tmp7_label2) ? _tmp7_label2 : (_tmp7_label2 = g_quark_from_static_string ("stuck")))) {
		switch (0) {
			default:
			{
				GeeHashMap* _tmp13_ = NULL;
				const gchar* _tmp14_ = NULL;
				gpointer _tmp15_ = NULL;
				GraniteWidgetsSourceListItem* _tmp16_ = NULL;
				GIcon* _tmp17_ = NULL;
				GIcon* _tmp18_ = NULL;
				GIcon* _tmp19_ = NULL;
				gboolean _tmp20_ = FALSE;
				GIcon* _tmp21_ = NULL;
				GIcon* _tmp22_ = NULL;
				_tmp13_ = main_window_items_sidebar;
				_tmp14_ = name;
				_tmp15_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp13_, _tmp14_);
				_tmp16_ = (GraniteWidgetsSourceListItem*) _tmp15_;
				_tmp17_ = granite_widgets_source_list_item_get_icon (_tmp16_);
				_tmp18_ = _tmp17_;
				_tmp19_ = main_window_loading_channel;
				_tmp20_ = _tmp18_ != _tmp19_;
				_g_object_unref0 (_tmp16_);
				if (_tmp20_) {
					_g_object_unref0 (pixbuf);
					return;
				}
				_tmp21_ = main_window_inactive_channel;
				_tmp22_ = _g_object_ref0 (_tmp21_);
				_g_object_unref0 (pixbuf);
				pixbuf = _tmp22_;
				break;
			}
		}
	}
	_tmp23_ = main_window_items_sidebar;
	_tmp24_ = name;
	_tmp25_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp23_, _tmp24_);
	_tmp26_ = (GraniteWidgetsSourceListItem*) _tmp25_;
	_tmp27_ = pixbuf;
	granite_widgets_source_list_item_set_icon (_tmp26_, _tmp27_);
	_g_object_unref0 (_tmp26_);
	_g_object_unref0 (pixbuf);
}


static gpointer _sql_client_server_ref0 (gpointer self) {
	return self ? sql_client_server_ref (self) : NULL;
}


static gpointer _sql_client_channel_ref0 (gpointer self) {
	return self ? sql_client_channel_ref (self) : NULL;
}


static void _main_window_sidebar_item_activated_granite_widgets_source_list_item_activated (GraniteWidgetsSourceListItem* _sender, gpointer self) {
	main_window_sidebar_item_activated ((MainWindow*) self);
}


void main_window_refresh_server_list (MainWindow* self) {
	GraniteWidgetsSourceListExpandableItem* root = NULL;
	GraniteWidgetsSourceList* _tmp0_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp1_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp2_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp3_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp4_ = NULL;
	GeeHashMap* new_items_sidebar = NULL;
	GeeHashMap* _tmp5_ = NULL;
	GeeHashMap* _tmp104_ = NULL;
	GeeHashMap* _tmp105_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->servers;
	_tmp1_ = granite_widgets_source_list_get_root (_tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = _g_object_ref0 (_tmp2_);
	root = _tmp3_;
	_tmp4_ = root;
	granite_widgets_source_list_expandable_item_clear (_tmp4_);
	_tmp5_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, GRANITE_WIDGETS_SOURCE_LIST_TYPE_ITEM, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
	new_items_sidebar = _tmp5_;
	{
		GeeIterator* _svr_it = NULL;
		GeeHashMap* _tmp6_ = NULL;
		GeeSet* _tmp7_ = NULL;
		GeeSet* _tmp8_ = NULL;
		GeeSet* _tmp9_ = NULL;
		GeeIterator* _tmp10_ = NULL;
		GeeIterator* _tmp11_ = NULL;
		_tmp6_ = sql_client_servers;
		_tmp7_ = gee_abstract_map_get_entries ((GeeMap*) _tmp6_);
		_tmp8_ = _tmp7_;
		_tmp9_ = _tmp8_;
		_tmp10_ = gee_iterable_iterator ((GeeIterable*) _tmp9_);
		_tmp11_ = _tmp10_;
		_g_object_unref0 (_tmp9_);
		_svr_it = _tmp11_;
		while (TRUE) {
			GeeIterator* _tmp12_ = NULL;
			gboolean _tmp13_ = FALSE;
			GeeMapEntry* svr = NULL;
			GeeIterator* _tmp14_ = NULL;
			gpointer _tmp15_ = NULL;
			GraniteWidgetsSourceListExpandableItem* s = NULL;
			GeeMapEntry* _tmp16_ = NULL;
			gconstpointer _tmp17_ = NULL;
			SqlClientServer* _tmp18_ = NULL;
			const gchar* _tmp19_ = NULL;
			GraniteWidgetsSourceListExpandableItem* _tmp20_ = NULL;
			GraniteWidgetsSourceListExpandableItem* _tmp21_ = NULL;
			GraniteWidgetsSourceListExpandableItem* _tmp22_ = NULL;
			GraniteWidgetsSourceListItem* chn = NULL;
			GeeMapEntry* _tmp23_ = NULL;
			gconstpointer _tmp24_ = NULL;
			SqlClientServer* _tmp25_ = NULL;
			const gchar* _tmp26_ = NULL;
			GraniteWidgetsSourceListItem* _tmp27_ = NULL;
			GraniteWidgetsSourceListItem* _tmp28_ = NULL;
			gchar* _tmp29_ = NULL;
			GraniteWidgetsSourceListItem* _tmp30_ = NULL;
			GeeMapEntry* _tmp31_ = NULL;
			gconstpointer _tmp32_ = NULL;
			SqlClientServer* _tmp33_ = NULL;
			SqlClientServer* _tmp34_ = NULL;
			GIcon* _tmp35_ = NULL;
			GeeHashMap* _tmp36_ = NULL;
			GeeMapEntry* _tmp37_ = NULL;
			gconstpointer _tmp38_ = NULL;
			SqlClientServer* _tmp39_ = NULL;
			const gchar* _tmp40_ = NULL;
			gboolean _tmp41_ = FALSE;
			GraniteWidgetsSourceListItem* _tmp52_ = NULL;
			GraniteWidgetsSourceListExpandableItem* _tmp53_ = NULL;
			GraniteWidgetsSourceListItem* _tmp54_ = NULL;
			GeeHashMap* _tmp55_ = NULL;
			GeeMapEntry* _tmp56_ = NULL;
			gconstpointer _tmp57_ = NULL;
			SqlClientServer* _tmp58_ = NULL;
			const gchar* _tmp59_ = NULL;
			GraniteWidgetsSourceListItem* _tmp60_ = NULL;
			_tmp12_ = _svr_it;
			_tmp13_ = gee_iterator_next (_tmp12_);
			if (!_tmp13_) {
				break;
			}
			_tmp14_ = _svr_it;
			_tmp15_ = gee_iterator_get (_tmp14_);
			svr = (GeeMapEntry*) _tmp15_;
			_tmp16_ = svr;
			_tmp17_ = gee_map_entry_get_value (_tmp16_);
			_tmp18_ = _tmp17_;
			_tmp19_ = ((SqlClientServer*) _tmp18_)->host;
			_tmp20_ = granite_widgets_source_list_expandable_item_new (_tmp19_);
			s = _tmp20_;
			_tmp21_ = root;
			_tmp22_ = s;
			granite_widgets_source_list_expandable_item_add (_tmp21_, (GraniteWidgetsSourceListItem*) _tmp22_);
			_tmp23_ = svr;
			_tmp24_ = gee_map_entry_get_value (_tmp23_);
			_tmp25_ = _tmp24_;
			_tmp26_ = ((SqlClientServer*) _tmp25_)->host;
			_tmp27_ = granite_widgets_source_list_item_new (_tmp26_);
			chn = _tmp27_;
			_tmp28_ = chn;
			_tmp29_ = g_strdup ("server");
			g_object_set_data_full ((GObject*) _tmp28_, "type", _tmp29_, g_free);
			_tmp30_ = chn;
			_tmp31_ = svr;
			_tmp32_ = gee_map_entry_get_value (_tmp31_);
			_tmp33_ = _tmp32_;
			_tmp34_ = _sql_client_server_ref0 ((SqlClientServer*) _tmp33_);
			g_object_set_data_full ((GObject*) _tmp30_, "server", _tmp34_, sql_client_server_unref);
			_tmp36_ = main_window_items_sidebar;
			_tmp37_ = svr;
			_tmp38_ = gee_map_entry_get_value (_tmp37_);
			_tmp39_ = _tmp38_;
			_tmp40_ = ((SqlClientServer*) _tmp39_)->host;
			_tmp41_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp36_, _tmp40_);
			if (_tmp41_) {
				GeeHashMap* _tmp42_ = NULL;
				GeeMapEntry* _tmp43_ = NULL;
				gconstpointer _tmp44_ = NULL;
				SqlClientServer* _tmp45_ = NULL;
				const gchar* _tmp46_ = NULL;
				gpointer _tmp47_ = NULL;
				GraniteWidgetsSourceListItem* _tmp48_ = NULL;
				GIcon* _tmp49_ = NULL;
				GIcon* _tmp50_ = NULL;
				_tmp42_ = main_window_items_sidebar;
				_tmp43_ = svr;
				_tmp44_ = gee_map_entry_get_value (_tmp43_);
				_tmp45_ = _tmp44_;
				_tmp46_ = ((SqlClientServer*) _tmp45_)->host;
				_tmp47_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp42_, _tmp46_);
				_tmp48_ = (GraniteWidgetsSourceListItem*) _tmp47_;
				_tmp49_ = granite_widgets_source_list_item_get_icon (_tmp48_);
				_tmp50_ = _tmp49_;
				_tmp35_ = _tmp50_;
				_g_object_unref0 (_tmp48_);
			} else {
				GIcon* _tmp51_ = NULL;
				_tmp51_ = main_window_inactive_channel;
				_tmp35_ = _tmp51_;
			}
			_tmp52_ = chn;
			granite_widgets_source_list_item_set_icon (_tmp52_, _tmp35_);
			_tmp53_ = s;
			_tmp54_ = chn;
			granite_widgets_source_list_expandable_item_add (_tmp53_, _tmp54_);
			_tmp55_ = new_items_sidebar;
			_tmp56_ = svr;
			_tmp57_ = gee_map_entry_get_value (_tmp56_);
			_tmp58_ = _tmp57_;
			_tmp59_ = ((SqlClientServer*) _tmp58_)->host;
			_tmp60_ = chn;
			gee_abstract_map_set ((GeeAbstractMap*) _tmp55_, _tmp59_, _tmp60_);
			{
				GeeLinkedList* _c_list = NULL;
				GeeMapEntry* _tmp61_ = NULL;
				gconstpointer _tmp62_ = NULL;
				SqlClientServer* _tmp63_ = NULL;
				GeeLinkedList* _tmp64_ = NULL;
				GeeLinkedList* _tmp65_ = NULL;
				gint _c_size = 0;
				GeeLinkedList* _tmp66_ = NULL;
				gint _tmp67_ = 0;
				gint _tmp68_ = 0;
				gint _c_index = 0;
				_tmp61_ = svr;
				_tmp62_ = gee_map_entry_get_value (_tmp61_);
				_tmp63_ = _tmp62_;
				_tmp64_ = ((SqlClientServer*) _tmp63_)->channels;
				_tmp65_ = _g_object_ref0 (_tmp64_);
				_c_list = _tmp65_;
				_tmp66_ = _c_list;
				_tmp67_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp66_);
				_tmp68_ = _tmp67_;
				_c_size = _tmp68_;
				_c_index = -1;
				while (TRUE) {
					gint _tmp69_ = 0;
					gint _tmp70_ = 0;
					gint _tmp71_ = 0;
					SqlClientChannel* c = NULL;
					GeeLinkedList* _tmp72_ = NULL;
					gint _tmp73_ = 0;
					gpointer _tmp74_ = NULL;
					SqlClientChannel* _tmp75_ = NULL;
					const gchar* _tmp76_ = NULL;
					GraniteWidgetsSourceListItem* _tmp77_ = NULL;
					GraniteWidgetsSourceListItem* _tmp78_ = NULL;
					gchar* _tmp79_ = NULL;
					GraniteWidgetsSourceListItem* _tmp80_ = NULL;
					SqlClientChannel* _tmp81_ = NULL;
					SqlClientChannel* _tmp82_ = NULL;
					GraniteWidgetsSourceListItem* _tmp83_ = NULL;
					GIcon* _tmp84_ = NULL;
					GeeHashMap* _tmp85_ = NULL;
					SqlClientChannel* _tmp86_ = NULL;
					const gchar* _tmp87_ = NULL;
					gboolean _tmp88_ = FALSE;
					GraniteWidgetsSourceListItem* _tmp97_ = NULL;
					GraniteWidgetsSourceListExpandableItem* _tmp98_ = NULL;
					GraniteWidgetsSourceListItem* _tmp99_ = NULL;
					GeeHashMap* _tmp100_ = NULL;
					SqlClientChannel* _tmp101_ = NULL;
					const gchar* _tmp102_ = NULL;
					GraniteWidgetsSourceListItem* _tmp103_ = NULL;
					_tmp69_ = _c_index;
					_c_index = _tmp69_ + 1;
					_tmp70_ = _c_index;
					_tmp71_ = _c_size;
					if (!(_tmp70_ < _tmp71_)) {
						break;
					}
					_tmp72_ = _c_list;
					_tmp73_ = _c_index;
					_tmp74_ = gee_abstract_list_get ((GeeAbstractList*) _tmp72_, _tmp73_);
					c = (SqlClientChannel*) _tmp74_;
					_tmp75_ = c;
					_tmp76_ = _tmp75_->channel;
					_tmp77_ = granite_widgets_source_list_item_new (_tmp76_);
					_g_object_unref0 (chn);
					chn = _tmp77_;
					_tmp78_ = chn;
					_tmp79_ = g_strdup ("channel");
					g_object_set_data_full ((GObject*) _tmp78_, "type", _tmp79_, g_free);
					_tmp80_ = chn;
					_tmp81_ = c;
					_tmp82_ = _sql_client_channel_ref0 (_tmp81_);
					g_object_set_data_full ((GObject*) _tmp80_, "channel", _tmp82_, sql_client_channel_unref);
					_tmp83_ = chn;
					g_signal_connect_object (_tmp83_, "activated", (GCallback) _main_window_sidebar_item_activated_granite_widgets_source_list_item_activated, self, 0);
					_tmp85_ = main_window_items_sidebar;
					_tmp86_ = c;
					_tmp87_ = _tmp86_->channel;
					_tmp88_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp85_, _tmp87_);
					if (_tmp88_) {
						GeeHashMap* _tmp89_ = NULL;
						SqlClientChannel* _tmp90_ = NULL;
						const gchar* _tmp91_ = NULL;
						gpointer _tmp92_ = NULL;
						GraniteWidgetsSourceListItem* _tmp93_ = NULL;
						GIcon* _tmp94_ = NULL;
						GIcon* _tmp95_ = NULL;
						_tmp89_ = main_window_items_sidebar;
						_tmp90_ = c;
						_tmp91_ = _tmp90_->channel;
						_tmp92_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp89_, _tmp91_);
						_tmp93_ = (GraniteWidgetsSourceListItem*) _tmp92_;
						_tmp94_ = granite_widgets_source_list_item_get_icon (_tmp93_);
						_tmp95_ = _tmp94_;
						_tmp84_ = _tmp95_;
						_g_object_unref0 (_tmp93_);
					} else {
						GIcon* _tmp96_ = NULL;
						_tmp96_ = main_window_inactive_channel;
						_tmp84_ = _tmp96_;
					}
					_tmp97_ = chn;
					granite_widgets_source_list_item_set_icon (_tmp97_, _tmp84_);
					_tmp98_ = s;
					_tmp99_ = chn;
					granite_widgets_source_list_expandable_item_add (_tmp98_, _tmp99_);
					_tmp100_ = new_items_sidebar;
					_tmp101_ = c;
					_tmp102_ = _tmp101_->channel;
					_tmp103_ = chn;
					gee_abstract_map_set ((GeeAbstractMap*) _tmp100_, _tmp102_, _tmp103_);
					_sql_client_channel_unref0 (c);
				}
				_g_object_unref0 (_c_list);
			}
			_g_object_unref0 (chn);
			_g_object_unref0 (s);
			_g_object_unref0 (svr);
		}
		_g_object_unref0 (_svr_it);
	}
	_tmp104_ = new_items_sidebar;
	_tmp105_ = _g_object_ref0 (_tmp104_);
	_g_object_unref0 (main_window_items_sidebar);
	main_window_items_sidebar = _tmp105_;
	_g_object_unref0 (new_items_sidebar);
	_g_object_unref0 (root);
}


static void main_window_sidebar_item_activated (MainWindow* self) {
	gchar* type = NULL;
	GraniteWidgetsSourceListItem* _tmp0_ = NULL;
	gconstpointer _tmp1_ = NULL;
	gchar* _tmp2_ = NULL;
	const gchar* _tmp3_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = main_window_current_selected_item;
	_tmp1_ = g_object_get_data ((GObject*) _tmp0_, "type");
	_tmp2_ = g_strdup ((const gchar*) _tmp1_);
	type = _tmp2_;
	_tmp3_ = type;
	if (g_strcmp0 (_tmp3_, "server") == 0) {
		SqlClientServer* server = NULL;
		GraniteWidgetsSourceListItem* _tmp4_ = NULL;
		gconstpointer _tmp5_ = NULL;
		SqlClientServer* _tmp6_ = NULL;
		SqlClientServer* _tmp34_ = NULL;
		_tmp4_ = main_window_current_selected_item;
		_tmp5_ = g_object_get_data ((GObject*) _tmp4_, "server");
		_tmp6_ = _sql_client_server_ref0 ((SqlClientServer*) _tmp5_);
		server = _tmp6_;
		{
			GeeIterator* _tab_it = NULL;
			GeeHashMap* _tmp7_ = NULL;
			GeeSet* _tmp8_ = NULL;
			GeeSet* _tmp9_ = NULL;
			GeeSet* _tmp10_ = NULL;
			GeeIterator* _tmp11_ = NULL;
			GeeIterator* _tmp12_ = NULL;
			_tmp7_ = self->priv->outputs;
			_tmp8_ = gee_abstract_map_get_entries ((GeeMap*) _tmp7_);
			_tmp9_ = _tmp8_;
			_tmp10_ = _tmp9_;
			_tmp11_ = gee_iterable_iterator ((GeeIterable*) _tmp10_);
			_tmp12_ = _tmp11_;
			_g_object_unref0 (_tmp10_);
			_tab_it = _tmp12_;
			while (TRUE) {
				GeeIterator* _tmp13_ = NULL;
				gboolean _tmp14_ = FALSE;
				GeeMapEntry* tab = NULL;
				GeeIterator* _tmp15_ = NULL;
				gpointer _tmp16_ = NULL;
				gboolean _tmp17_ = FALSE;
				GeeMapEntry* _tmp18_ = NULL;
				gconstpointer _tmp19_ = NULL;
				ChannelTab* _tmp20_ = NULL;
				gboolean _tmp21_ = FALSE;
				_tmp13_ = _tab_it;
				_tmp14_ = gee_iterator_next (_tmp13_);
				if (!_tmp14_) {
					break;
				}
				_tmp15_ = _tab_it;
				_tmp16_ = gee_iterator_get (_tmp15_);
				tab = (GeeMapEntry*) _tmp16_;
				_tmp18_ = tab;
				_tmp19_ = gee_map_entry_get_value (_tmp18_);
				_tmp20_ = _tmp19_;
				_tmp21_ = ((ChannelTab*) _tmp20_)->is_server_tab;
				if (_tmp21_) {
					GeeMapEntry* _tmp22_ = NULL;
					gconstpointer _tmp23_ = NULL;
					ChannelTab* _tmp24_ = NULL;
					const gchar* _tmp25_ = NULL;
					const gchar* _tmp26_ = NULL;
					SqlClientServer* _tmp27_ = NULL;
					const gchar* _tmp28_ = NULL;
					_tmp22_ = tab;
					_tmp23_ = gee_map_entry_get_value (_tmp22_);
					_tmp24_ = _tmp23_;
					_tmp25_ = channel_tab_get_channel_name ((ChannelTab*) _tmp24_);
					_tmp26_ = _tmp25_;
					_tmp27_ = server;
					_tmp28_ = _tmp27_->host;
					_tmp17_ = g_strcmp0 (_tmp26_, _tmp28_) == 0;
				} else {
					_tmp17_ = FALSE;
				}
				if (_tmp17_) {
					GraniteWidgetsDynamicNotebook* _tmp29_ = NULL;
					GeeMapEntry* _tmp30_ = NULL;
					gconstpointer _tmp31_ = NULL;
					ChannelTab* _tmp32_ = NULL;
					GraniteWidgetsTab* _tmp33_ = NULL;
					_tmp29_ = self->priv->tabs;
					_tmp30_ = tab;
					_tmp31_ = gee_map_entry_get_value (_tmp30_);
					_tmp32_ = _tmp31_;
					_tmp33_ = ((ChannelTab*) _tmp32_)->tab;
					granite_widgets_dynamic_notebook_set_current (_tmp29_, _tmp33_);
					_g_object_unref0 (tab);
					_g_object_unref0 (_tab_it);
					_sql_client_server_unref0 (server);
					_g_free0 (type);
					return;
				}
				_g_object_unref0 (tab);
			}
			_g_object_unref0 (_tab_it);
		}
		_tmp34_ = server;
		main_window_add_server (self, _tmp34_, NULL);
		_sql_client_server_unref0 (server);
	} else {
		SqlClientChannel* channel = NULL;
		GraniteWidgetsSourceListItem* _tmp35_ = NULL;
		gconstpointer _tmp36_ = NULL;
		SqlClientChannel* _tmp37_ = NULL;
		SqlClientServer* server = NULL;
		GeeHashMap* _tmp38_ = NULL;
		SqlClientChannel* _tmp39_ = NULL;
		gint _tmp40_ = 0;
		gpointer _tmp41_ = NULL;
		GeeHashMap* _tmp124_ = NULL;
		SqlClientChannel* _tmp125_ = NULL;
		const gchar* _tmp126_ = NULL;
		gpointer _tmp127_ = NULL;
		GraniteWidgetsSourceListItem* _tmp128_ = NULL;
		GIcon* _tmp129_ = NULL;
		GeeLinkedList* channels = NULL;
		GeeLinkedList* _tmp130_ = NULL;
		GeeLinkedList* _tmp131_ = NULL;
		SqlClientChannel* _tmp132_ = NULL;
		const gchar* _tmp133_ = NULL;
		GeeHashMap* _tmp134_ = NULL;
		SqlClientChannel* _tmp135_ = NULL;
		gint _tmp136_ = 0;
		gpointer _tmp137_ = NULL;
		SqlClientServer* _tmp138_ = NULL;
		GeeLinkedList* _tmp139_ = NULL;
		_tmp35_ = main_window_current_selected_item;
		_tmp36_ = g_object_get_data ((GObject*) _tmp35_, "channel");
		_tmp37_ = _sql_client_channel_ref0 ((SqlClientChannel*) _tmp36_);
		channel = _tmp37_;
		_tmp38_ = sql_client_servers;
		_tmp39_ = channel;
		_tmp40_ = _tmp39_->server_id;
		_tmp41_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp38_, (gpointer) ((gintptr) _tmp40_));
		server = (SqlClientServer*) _tmp41_;
		{
			GeeIterator* _tab_it = NULL;
			GeeHashMap* _tmp42_ = NULL;
			GeeSet* _tmp43_ = NULL;
			GeeSet* _tmp44_ = NULL;
			GeeSet* _tmp45_ = NULL;
			GeeIterator* _tmp46_ = NULL;
			GeeIterator* _tmp47_ = NULL;
			_tmp42_ = self->priv->outputs;
			_tmp43_ = gee_abstract_map_get_entries ((GeeMap*) _tmp42_);
			_tmp44_ = _tmp43_;
			_tmp45_ = _tmp44_;
			_tmp46_ = gee_iterable_iterator ((GeeIterable*) _tmp45_);
			_tmp47_ = _tmp46_;
			_g_object_unref0 (_tmp45_);
			_tab_it = _tmp47_;
			while (TRUE) {
				GeeIterator* _tmp48_ = NULL;
				gboolean _tmp49_ = FALSE;
				GeeMapEntry* tab = NULL;
				GeeIterator* _tmp50_ = NULL;
				gpointer _tmp51_ = NULL;
				gboolean _tmp52_ = FALSE;
				gboolean _tmp53_ = FALSE;
				GeeMapEntry* _tmp54_ = NULL;
				gconstpointer _tmp55_ = NULL;
				ChannelTab* _tmp56_ = NULL;
				gboolean _tmp57_ = FALSE;
				_tmp48_ = _tab_it;
				_tmp49_ = gee_iterator_next (_tmp48_);
				if (!_tmp49_) {
					break;
				}
				_tmp50_ = _tab_it;
				_tmp51_ = gee_iterator_get (_tmp50_);
				tab = (GeeMapEntry*) _tmp51_;
				_tmp54_ = tab;
				_tmp55_ = gee_map_entry_get_value (_tmp54_);
				_tmp56_ = _tmp55_;
				_tmp57_ = ((ChannelTab*) _tmp56_)->is_server_tab;
				if (!_tmp57_) {
					GeeMapEntry* _tmp58_ = NULL;
					gconstpointer _tmp59_ = NULL;
					ChannelTab* _tmp60_ = NULL;
					GraniteWidgetsTab* _tmp61_ = NULL;
					const gchar* _tmp62_ = NULL;
					const gchar* _tmp63_ = NULL;
					SqlClientChannel* _tmp64_ = NULL;
					const gchar* _tmp65_ = NULL;
					_tmp58_ = tab;
					_tmp59_ = gee_map_entry_get_value (_tmp58_);
					_tmp60_ = _tmp59_;
					_tmp61_ = ((ChannelTab*) _tmp60_)->tab;
					_tmp62_ = granite_widgets_tab_get_label (_tmp61_);
					_tmp63_ = _tmp62_;
					_tmp64_ = channel;
					_tmp65_ = _tmp64_->channel;
					_tmp53_ = g_strcmp0 (_tmp63_, _tmp65_) == 0;
				} else {
					_tmp53_ = FALSE;
				}
				if (_tmp53_) {
					SqlClientServer* _tmp66_ = NULL;
					const gchar* _tmp67_ = NULL;
					GeeMapEntry* _tmp68_ = NULL;
					gconstpointer _tmp69_ = NULL;
					ChannelTab* _tmp70_ = NULL;
					Connection* _tmp71_ = NULL;
					Connection* _tmp72_ = NULL;
					SqlClientServer* _tmp73_ = NULL;
					const gchar* _tmp74_ = NULL;
					_tmp66_ = server;
					_tmp67_ = _tmp66_->host;
					_tmp68_ = tab;
					_tmp69_ = gee_map_entry_get_value (_tmp68_);
					_tmp70_ = _tmp69_;
					_tmp71_ = channel_tab_get_connection ((ChannelTab*) _tmp70_);
					_tmp72_ = _tmp71_;
					_tmp73_ = _tmp72_->server;
					_tmp74_ = _tmp73_->host;
					_tmp52_ = g_strcmp0 (_tmp67_, _tmp74_) == 0;
				} else {
					_tmp52_ = FALSE;
				}
				if (_tmp52_) {
					GraniteWidgetsDynamicNotebook* _tmp75_ = NULL;
					GeeMapEntry* _tmp76_ = NULL;
					gconstpointer _tmp77_ = NULL;
					ChannelTab* _tmp78_ = NULL;
					GraniteWidgetsTab* _tmp79_ = NULL;
					_tmp75_ = self->priv->tabs;
					_tmp76_ = tab;
					_tmp77_ = gee_map_entry_get_value (_tmp76_);
					_tmp78_ = _tmp77_;
					_tmp79_ = ((ChannelTab*) _tmp78_)->tab;
					granite_widgets_dynamic_notebook_set_current (_tmp75_, _tmp79_);
					_g_object_unref0 (tab);
					_g_object_unref0 (_tab_it);
					_sql_client_server_unref0 (server);
					_sql_client_channel_unref0 (channel);
					_g_free0 (type);
					return;
				}
				_g_object_unref0 (tab);
			}
			_g_object_unref0 (_tab_it);
		}
		{
			GeeIterator* _con_it = NULL;
			GeeHashMap* _tmp80_ = NULL;
			GeeSet* _tmp81_ = NULL;
			GeeSet* _tmp82_ = NULL;
			GeeSet* _tmp83_ = NULL;
			GeeIterator* _tmp84_ = NULL;
			GeeIterator* _tmp85_ = NULL;
			_tmp80_ = self->priv->clients;
			_tmp81_ = gee_abstract_map_get_entries ((GeeMap*) _tmp80_);
			_tmp82_ = _tmp81_;
			_tmp83_ = _tmp82_;
			_tmp84_ = gee_iterable_iterator ((GeeIterable*) _tmp83_);
			_tmp85_ = _tmp84_;
			_g_object_unref0 (_tmp83_);
			_con_it = _tmp85_;
			while (TRUE) {
				GeeIterator* _tmp86_ = NULL;
				gboolean _tmp87_ = FALSE;
				GeeMapEntry* con = NULL;
				GeeIterator* _tmp88_ = NULL;
				gpointer _tmp89_ = NULL;
				GeeMapEntry* _tmp90_ = NULL;
				gconstpointer _tmp91_ = NULL;
				const gchar* _tmp92_ = NULL;
				SqlClientServer* _tmp93_ = NULL;
				const gchar* _tmp94_ = NULL;
				_tmp86_ = _con_it;
				_tmp87_ = gee_iterator_next (_tmp86_);
				if (!_tmp87_) {
					break;
				}
				_tmp88_ = _con_it;
				_tmp89_ = gee_iterator_get (_tmp88_);
				con = (GeeMapEntry*) _tmp89_;
				_tmp90_ = con;
				_tmp91_ = gee_map_entry_get_key (_tmp90_);
				_tmp92_ = _tmp91_;
				_tmp93_ = server;
				_tmp94_ = _tmp93_->host;
				if (g_strcmp0 ((const gchar*) _tmp92_, _tmp94_) == 0) {
					gboolean _tmp95_ = FALSE;
					GeeMapEntry* _tmp96_ = NULL;
					gconstpointer _tmp97_ = NULL;
					Connection* _tmp98_ = NULL;
					gboolean _tmp99_ = FALSE;
					_tmp96_ = con;
					_tmp97_ = gee_map_entry_get_value (_tmp96_);
					_tmp98_ = _tmp97_;
					_tmp99_ = ((Connection*) _tmp98_)->autoconnect_ran;
					if (!_tmp99_) {
						GeeMapEntry* _tmp100_ = NULL;
						gconstpointer _tmp101_ = NULL;
						Connection* _tmp102_ = NULL;
						GeeLinkedList* _tmp103_ = NULL;
						SqlClientChannel* _tmp104_ = NULL;
						const gchar* _tmp105_ = NULL;
						gboolean _tmp106_ = FALSE;
						_tmp100_ = con;
						_tmp101_ = gee_map_entry_get_value (_tmp100_);
						_tmp102_ = _tmp101_;
						_tmp103_ = ((Connection*) _tmp102_)->channel_autoconnect;
						_tmp104_ = channel;
						_tmp105_ = _tmp104_->channel;
						_tmp106_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp103_, _tmp105_);
						_tmp95_ = !_tmp106_;
					} else {
						_tmp95_ = FALSE;
					}
					if (_tmp95_) {
						GeeHashMap* _tmp107_ = NULL;
						SqlClientChannel* _tmp108_ = NULL;
						const gchar* _tmp109_ = NULL;
						gpointer _tmp110_ = NULL;
						GraniteWidgetsSourceListItem* _tmp111_ = NULL;
						GIcon* _tmp112_ = NULL;
						GeeMapEntry* _tmp113_ = NULL;
						gconstpointer _tmp114_ = NULL;
						Connection* _tmp115_ = NULL;
						GeeLinkedList* _tmp116_ = NULL;
						SqlClientChannel* _tmp117_ = NULL;
						const gchar* _tmp118_ = NULL;
						_tmp107_ = main_window_items_sidebar;
						_tmp108_ = channel;
						_tmp109_ = _tmp108_->channel;
						_tmp110_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp107_, _tmp109_);
						_tmp111_ = (GraniteWidgetsSourceListItem*) _tmp110_;
						_tmp112_ = main_window_loading_channel;
						granite_widgets_source_list_item_set_icon (_tmp111_, _tmp112_);
						_g_object_unref0 (_tmp111_);
						_tmp113_ = con;
						_tmp114_ = gee_map_entry_get_value (_tmp113_);
						_tmp115_ = _tmp114_;
						_tmp116_ = ((Connection*) _tmp115_)->channel_autoconnect;
						_tmp117_ = channel;
						_tmp118_ = _tmp117_->channel;
						gee_abstract_collection_add ((GeeAbstractCollection*) _tmp116_, _tmp118_);
					} else {
						GeeMapEntry* _tmp119_ = NULL;
						gconstpointer _tmp120_ = NULL;
						Connection* _tmp121_ = NULL;
						SqlClientChannel* _tmp122_ = NULL;
						const gchar* _tmp123_ = NULL;
						_tmp119_ = con;
						_tmp120_ = gee_map_entry_get_value (_tmp119_);
						_tmp121_ = _tmp120_;
						_tmp122_ = channel;
						_tmp123_ = _tmp122_->channel;
						connection_join ((Connection*) _tmp121_, _tmp123_);
					}
					_g_object_unref0 (con);
					_g_object_unref0 (_con_it);
					_sql_client_server_unref0 (server);
					_sql_client_channel_unref0 (channel);
					_g_free0 (type);
					return;
				}
				_g_object_unref0 (con);
			}
			_g_object_unref0 (_con_it);
		}
		_tmp124_ = main_window_items_sidebar;
		_tmp125_ = channel;
		_tmp126_ = _tmp125_->channel;
		_tmp127_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp124_, _tmp126_);
		_tmp128_ = (GraniteWidgetsSourceListItem*) _tmp127_;
		_tmp129_ = main_window_loading_channel;
		granite_widgets_source_list_item_set_icon (_tmp128_, _tmp129_);
		_g_object_unref0 (_tmp128_);
		_tmp130_ = gee_linked_list_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL);
		channels = _tmp130_;
		_tmp131_ = channels;
		_tmp132_ = channel;
		_tmp133_ = _tmp132_->channel;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp131_, _tmp133_);
		_tmp134_ = sql_client_servers;
		_tmp135_ = channel;
		_tmp136_ = _tmp135_->server_id;
		_tmp137_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp134_, (gpointer) ((gintptr) _tmp136_));
		_tmp138_ = (SqlClientServer*) _tmp137_;
		_tmp139_ = channels;
		main_window_add_server (self, _tmp138_, _tmp139_);
		_sql_client_server_unref0 (_tmp138_);
		_g_object_unref0 (channels);
		_sql_client_server_unref0 (server);
		_sql_client_channel_unref0 (channel);
	}
	_g_free0 (type);
}


static Block8Data* block8_data_ref (Block8Data* _data8_) {
	g_atomic_int_inc (&_data8_->_ref_count_);
	return _data8_;
}


static void block8_data_unref (void * _userdata_) {
	Block8Data* _data8_;
	_data8_ = (Block8Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data8_->_ref_count_)) {
		MainWindow* self;
		self = _data8_->self;
		_g_object_unref0 (_data8_->tab);
		_g_object_unref0 (self);
		g_slice_free (Block8Data, _data8_);
	}
}


static gchar string_get (const gchar* self, glong index) {
	gchar result = '\0';
	glong _tmp0_ = 0L;
	gchar _tmp1_ = '\0';
	g_return_val_if_fail (self != NULL, '\0');
	_tmp0_ = index;
	_tmp1_ = ((gchar*) self)[_tmp0_];
	result = _tmp1_;
	return result;
}


static gboolean ___lambda39_ (Block8Data* _data8_) {
	MainWindow* self;
	gboolean result = FALSE;
	GeeHashMap* _tmp0_ = NULL;
	ChannelTab* _tmp1_ = NULL;
	GraniteWidgetsTab* _tmp2_ = NULL;
	const gchar* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	gboolean _tmp5_ = FALSE;
	ChannelTab* _tmp17_ = NULL;
	GraniteWidgetsTab* _tmp18_ = NULL;
	GIcon* _tmp19_ = NULL;
	self = _data8_->self;
	_tmp0_ = main_window_items_sidebar;
	_tmp1_ = _data8_->tab;
	_tmp2_ = _tmp1_->tab;
	_tmp3_ = granite_widgets_tab_get_label (_tmp2_);
	_tmp4_ = _tmp3_;
	_tmp5_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp0_, _tmp4_);
	if (_tmp5_) {
		GeeHashMap* _tmp6_ = NULL;
		ChannelTab* _tmp7_ = NULL;
		GraniteWidgetsTab* _tmp8_ = NULL;
		const gchar* _tmp9_ = NULL;
		const gchar* _tmp10_ = NULL;
		gpointer _tmp11_ = NULL;
		GraniteWidgetsSourceListItem* _tmp12_ = NULL;
		ChannelTab* _tmp13_ = NULL;
		gint _tmp14_ = 0;
		gchar* _tmp15_ = NULL;
		gchar* _tmp16_ = NULL;
		_tmp6_ = main_window_items_sidebar;
		_tmp7_ = _data8_->tab;
		_tmp8_ = _tmp7_->tab;
		_tmp9_ = granite_widgets_tab_get_label (_tmp8_);
		_tmp10_ = _tmp9_;
		_tmp11_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp6_, _tmp10_);
		_tmp12_ = (GraniteWidgetsSourceListItem*) _tmp11_;
		_tmp13_ = _data8_->tab;
		_tmp14_ = _tmp13_->message_count;
		_tmp15_ = g_strdup_printf ("%i", _tmp14_);
		_tmp16_ = _tmp15_;
		granite_widgets_source_list_item_set_badge (_tmp12_, _tmp16_);
		_g_free0 (_tmp16_);
		_g_object_unref0 (_tmp12_);
	}
	_tmp17_ = _data8_->tab;
	_tmp18_ = _tmp17_->tab;
	_tmp19_ = main_window_channel_tab_icon_new_msg;
	granite_widgets_tab_set_icon (_tmp18_, _tmp19_);
	result = FALSE;
	return result;
}


static gboolean ____lambda39__gsource_func (gpointer self) {
	gboolean result;
	result = ___lambda39_ (self);
	return result;
}


void main_window_add_text (MainWindow* self, ChannelTab* tab, Message* message, gboolean _error_) {
	Block8Data* _data8_;
	ChannelTab* _tmp0_ = NULL;
	ChannelTab* _tmp1_ = NULL;
	ChannelTab* _tmp2_ = NULL;
	gboolean _tmp3_ = FALSE;
	gboolean _tmp15_ = FALSE;
	gint _tmp16_ = 0;
	ChannelTab* _tmp17_ = NULL;
	gint _tmp18_ = 0;
	gint _tmp19_ = 0;
	g_return_if_fail (self != NULL);
	g_return_if_fail (message != NULL);
	_data8_ = g_slice_new0 (Block8Data);
	_data8_->_ref_count_ = 1;
	_data8_->self = g_object_ref (self);
	_tmp0_ = tab;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (_data8_->tab);
	_data8_->tab = _tmp1_;
	_tmp2_ = _data8_->tab;
	if (_tmp2_ == NULL) {
		block8_data_unref (_data8_);
		_data8_ = NULL;
		return;
	}
	_tmp3_ = _error_;
	if (_tmp3_) {
		Message* _tmp4_ = NULL;
		const gchar* _tmp5_ = NULL;
		Message* _tmp6_ = NULL;
		const gchar* _tmp7_ = NULL;
		const gchar* _tmp8_ = NULL;
		gchar* _tmp9_ = NULL;
		gchar* _tmp10_ = NULL;
		ChannelTab* _tmp11_ = NULL;
		Message* _tmp12_ = NULL;
		_tmp4_ = message;
		_tmp5_ = _ ("Error: ");
		_tmp6_ = message;
		_tmp7_ = message_get_message (_tmp6_);
		_tmp8_ = _tmp7_;
		_tmp9_ = g_strconcat (_tmp5_, _tmp8_, NULL);
		_tmp10_ = _tmp9_;
		message_set_message (_tmp4_, _tmp10_);
		_g_free0 (_tmp10_);
		_tmp11_ = _data8_->tab;
		_tmp12_ = message;
		channel_tab_display_error (_tmp11_, _tmp12_);
	} else {
		ChannelTab* _tmp13_ = NULL;
		Message* _tmp14_ = NULL;
		_tmp13_ = _data8_->tab;
		_tmp14_ = message;
		channel_tab_display_message (_tmp13_, _tmp14_);
	}
	_tmp16_ = main_window_current_tab;
	_tmp17_ = _data8_->tab;
	_tmp18_ = channel_tab_get_tab_index (_tmp17_);
	_tmp19_ = _tmp18_;
	if (_tmp16_ != _tmp19_) {
		ChannelTab* _tmp20_ = NULL;
		gboolean _tmp21_ = FALSE;
		_tmp20_ = _data8_->tab;
		_tmp21_ = _tmp20_->is_server_tab;
		_tmp15_ = !_tmp21_;
	} else {
		_tmp15_ = FALSE;
	}
	if (_tmp15_) {
		ChannelTab* _tmp22_ = NULL;
		gint _tmp23_ = 0;
		gboolean _tmp24_ = FALSE;
		Message* _tmp25_ = NULL;
		const gchar* _tmp26_ = NULL;
		const gchar* _tmp27_ = NULL;
		_tmp22_ = _data8_->tab;
		_tmp23_ = _tmp22_->message_count;
		_tmp22_->message_count = _tmp23_ + 1;
		_tmp25_ = message;
		_tmp26_ = message_get_command (_tmp25_);
		_tmp27_ = _tmp26_;
		if (g_strcmp0 (_tmp27_, IRC_PRIVATE_MESSAGE) == 0) {
			Message* _tmp28_ = NULL;
			gchar** _tmp29_ = NULL;
			gint _tmp29__length1 = 0;
			gchar** _tmp30_ = NULL;
			gint _tmp30__length1 = 0;
			const gchar* _tmp31_ = NULL;
			gchar _tmp32_ = '\0';
			_tmp28_ = message;
			_tmp29_ = message_get_parameters (_tmp28_, &_tmp29__length1);
			_tmp30_ = _tmp29_;
			_tmp30__length1 = _tmp29__length1;
			_tmp31_ = _tmp30_[0];
			_tmp32_ = string_get (_tmp31_, (glong) 0);
			_tmp24_ = _tmp32_ != '#';
		} else {
			_tmp24_ = FALSE;
		}
		if (_tmp24_) {
		}
		g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ____lambda39__gsource_func, block8_data_ref (_data8_), block8_data_unref);
	}
	block8_data_unref (_data8_);
	_data8_ = NULL;
}


void main_window_refresh_icon (MainWindow* self, gint add) {
	UnityLauncherEntry* _tmp0_ = NULL;
	UnityLauncherEntry* _tmp1_ = NULL;
	gint64 _tmp2_ = 0LL;
	gint64 _tmp3_ = 0LL;
	gint _tmp4_ = 0;
	UnityLauncherEntry* _tmp5_ = NULL;
	UnityLauncherEntry* _tmp6_ = NULL;
	gint64 _tmp7_ = 0LL;
	gint64 _tmp8_ = 0LL;
	UnityLauncherEntry* _tmp9_ = NULL;
	UnityLauncherEntry* _tmp10_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = main_window_launcher;
	_tmp1_ = main_window_launcher;
	_tmp2_ = unity_launcher_entry_get_count (_tmp1_);
	_tmp3_ = _tmp2_;
	_tmp4_ = add;
	unity_launcher_entry_set_count (_tmp1_, _tmp3_ + _tmp4_);
	_tmp5_ = main_window_launcher;
	_tmp6_ = main_window_launcher;
	_tmp7_ = unity_launcher_entry_get_count (_tmp6_);
	_tmp8_ = _tmp7_;
	unity_launcher_entry_set_count_visible (_tmp5_, _tmp8_ > ((gint64) 0));
	_tmp9_ = main_window_launcher;
	unity_launcher_entry_set_urgent (_tmp9_, TRUE);
	_tmp10_ = main_window_launcher;
	unity_launcher_entry_set_urgent (_tmp10_, FALSE);
}


void main_window_send_text_out (MainWindow* self, const gchar* text) {
	gboolean _tmp0_ = FALSE;
	gboolean _tmp1_ = FALSE;
	gint _tmp2_ = 0;
	ChannelTab* output = NULL;
	GeeHashMap* _tmp7_ = NULL;
	gint _tmp8_ = 0;
	gpointer _tmp9_ = NULL;
	ChannelTab* _tmp10_ = NULL;
	const gchar* _tmp11_ = NULL;
	Message* message = NULL;
	Message* _tmp12_ = NULL;
	Message* _tmp13_ = NULL;
	ChannelTab* _tmp14_ = NULL;
	Connection* _tmp15_ = NULL;
	Connection* _tmp16_ = NULL;
	SqlClientServer* _tmp17_ = NULL;
	const gchar* _tmp18_ = NULL;
	Message* _tmp19_ = NULL;
	const gchar* _tmp20_ = NULL;
	Message* _tmp21_ = NULL;
	Message* _tmp22_ = NULL;
	ChannelTab* _tmp23_ = NULL;
	Message* _tmp24_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (text != NULL);
	_tmp2_ = main_window_current_tab;
	if (_tmp2_ == -1) {
		_tmp1_ = TRUE;
	} else {
		GeeHashMap* _tmp3_ = NULL;
		gint _tmp4_ = 0;
		gboolean _tmp5_ = FALSE;
		_tmp3_ = self->priv->outputs;
		_tmp4_ = main_window_current_tab;
		_tmp5_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp3_, (gpointer) ((gintptr) _tmp4_));
		_tmp1_ = !_tmp5_;
	}
	if (_tmp1_) {
		_tmp0_ = TRUE;
	} else {
		const gchar* _tmp6_ = NULL;
		_tmp6_ = text;
		_tmp0_ = g_strcmp0 (_tmp6_, "") == 0;
	}
	if (_tmp0_) {
		return;
	}
	_tmp7_ = self->priv->outputs;
	_tmp8_ = main_window_current_tab;
	_tmp9_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp7_, (gpointer) ((gintptr) _tmp8_));
	output = (ChannelTab*) _tmp9_;
	_tmp10_ = output;
	_tmp11_ = text;
	channel_tab_send_text_out (_tmp10_, _tmp11_);
	_tmp12_ = message_new ("");
	message = _tmp12_;
	_tmp13_ = message;
	_tmp14_ = output;
	_tmp15_ = channel_tab_get_connection (_tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = _tmp16_->server;
	_tmp18_ = _tmp17_->nickname;
	message_user_name_set (_tmp13_, _tmp18_);
	_tmp19_ = message;
	_tmp20_ = text;
	message_set_message (_tmp19_, _tmp20_);
	_tmp21_ = message;
	message_set_command (_tmp21_, "PRIVMSG");
	_tmp22_ = message;
	_tmp22_->internal = TRUE;
	_tmp23_ = output;
	_tmp24_ = message;
	main_window_add_text (self, _tmp23_, _tmp24_, FALSE);
	_g_object_unref0 (message);
	_g_object_unref0 (output);
	return;
}


static gpointer _main_window_move_slider_t_gthread_func (gpointer self) {
	gpointer result;
	result = (gpointer) ((gintptr) main_window_move_slider_t ((MainWindow*) self));
	g_object_unref (self);
	return result;
}


gboolean main_window_slide_panel (MainWindow* self) {
	gboolean result = FALSE;
	Settings* _tmp0_ = NULL;
	gboolean _tmp1_ = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = main_window_settings;
	_tmp1_ = settings_get_bool (_tmp0_, "show_animations");
	if (_tmp1_) {
		gint _tmp2_ = 0;
		GThread* _tmp3_ = NULL;
		GThread* _tmp4_ = NULL;
		_tmp2_ = self->priv->sliding;
		if (_tmp2_ > 1) {
			result = FALSE;
			return result;
		}
		_tmp3_ = g_thread_new ("slider_move", _main_window_move_slider_t_gthread_func, g_object_ref (self));
		_tmp4_ = _tmp3_;
		_g_thread_unref0 (_tmp4_);
	} else {
		gint _tmp5_ = 0;
		GtkPaned* _tmp6_ = NULL;
		gint _tmp7_ = 0;
		gint _tmp8_ = 0;
		GtkPaned* _tmp9_ = NULL;
		_tmp6_ = self->priv->panel;
		_tmp7_ = gtk_paned_get_position (_tmp6_);
		_tmp8_ = _tmp7_;
		if (_tmp8_ < 10) {
			_tmp5_ = 180;
		} else {
			_tmp5_ = 0;
		}
		_tmp9_ = self->priv->panel;
		gtk_paned_set_position (_tmp9_, _tmp5_);
	}
	result = FALSE;
	return result;
}


gint main_window_move_slider_t (MainWindow* self) {
	gint result = 0;
	gint _tmp0_ = 0;
	gint add = 0;
	gint end = 0;
	gint go_to = 0;
	gint pos = 0;
	gboolean opening = FALSE;
	GtkPaned* _tmp2_ = NULL;
	gint _tmp3_ = 0;
	gint _tmp4_ = 0;
	gint _tmp5_ = 0;
	gboolean _tmp6_ = FALSE;
	gint _tmp28_ = 0;
	g_return_val_if_fail (self != NULL, 0);
	_tmp0_ = self->priv->sliding;
	self->priv->sliding = _tmp0_ + 1;
	while (TRUE) {
		gint _tmp1_ = 0;
		_tmp1_ = self->priv->sliding;
		if (!(_tmp1_ > 1)) {
			break;
		}
		g_usleep ((gulong) 1000);
	}
	_tmp2_ = self->priv->panel;
	_tmp3_ = gtk_paned_get_position (_tmp2_);
	_tmp4_ = _tmp3_;
	opening = _tmp4_ < 10;
	_tmp6_ = opening;
	if (_tmp6_) {
		_tmp5_ = 550;
	} else {
		_tmp5_ = 618;
	}
	end = _tmp5_;
	add = 1;
	go_to = 180;
	{
		gint i = 0;
		GtkPaned* _tmp7_ = NULL;
		gint _tmp8_ = 0;
		gint _tmp9_ = 0;
		_tmp7_ = self->priv->panel;
		_tmp8_ = gtk_paned_get_position (_tmp7_);
		_tmp9_ = _tmp8_;
		i = _tmp9_;
		{
			gboolean _tmp10_ = FALSE;
			_tmp10_ = TRUE;
			while (TRUE) {
				gint _tmp13_ = 0;
				gint _tmp14_ = 0;
				gboolean _tmp15_ = FALSE;
				GtkPaned* _tmp26_ = NULL;
				gint _tmp27_ = 0;
				if (!_tmp10_) {
					gint _tmp11_ = 0;
					gint _tmp12_ = 0;
					_tmp11_ = i;
					_tmp12_ = add;
					i = _tmp11_ + _tmp12_;
				}
				_tmp10_ = FALSE;
				_tmp13_ = i;
				_tmp14_ = end;
				if (!(_tmp13_ < _tmp14_)) {
					break;
				}
				_tmp15_ = opening;
				if (_tmp15_) {
					gint _tmp16_ = 0;
					gint _tmp17_ = 0;
					gint _tmp18_ = 0;
					gdouble _tmp19_ = 0.0;
					gint _tmp20_ = 0;
					_tmp16_ = i;
					_tmp17_ = go_to;
					_tmp18_ = end;
					_tmp19_ = relay_ease_out_elastic ((gfloat) _tmp16_, 0.0F, (gfloat) _tmp17_, (gfloat) _tmp18_);
					pos = (gint) _tmp19_;
					_tmp20_ = i;
					if (_tmp20_ > 420) {
						break;
					}
				} else {
					gint _tmp21_ = 0;
					gint _tmp22_ = 0;
					gint _tmp23_ = 0;
					gint _tmp24_ = 0;
					gfloat _tmp25_ = 0.0F;
					_tmp21_ = end;
					_tmp22_ = i;
					_tmp23_ = go_to;
					_tmp24_ = end;
					_tmp25_ = relay_ease_in_bounce ((gfloat) (_tmp21_ - _tmp22_), 0.0F, (gfloat) _tmp23_, (gfloat) _tmp24_);
					pos = (gint) _tmp25_;
				}
				_tmp26_ = self->priv->panel;
				_tmp27_ = pos;
				gtk_paned_set_position (_tmp26_, _tmp27_);
				g_usleep ((gulong) 3600);
			}
		}
	}
	_tmp28_ = self->priv->sliding;
	self->priv->sliding = _tmp28_ - 1;
	result = 0;
	return result;
}


gint main_window_lookup_channel_id (MainWindow* self, GraniteWidgetsTab* tab) {
	gint result = 0;
	g_return_val_if_fail (self != NULL, 0);
	g_return_val_if_fail (tab != NULL, 0);
	{
		GeeIterator* _output_it = NULL;
		GeeHashMap* _tmp0_ = NULL;
		GeeSet* _tmp1_ = NULL;
		GeeSet* _tmp2_ = NULL;
		GeeSet* _tmp3_ = NULL;
		GeeIterator* _tmp4_ = NULL;
		GeeIterator* _tmp5_ = NULL;
		_tmp0_ = self->priv->outputs;
		_tmp1_ = gee_abstract_map_get_entries ((GeeMap*) _tmp0_);
		_tmp2_ = _tmp1_;
		_tmp3_ = _tmp2_;
		_tmp4_ = gee_iterable_iterator ((GeeIterable*) _tmp3_);
		_tmp5_ = _tmp4_;
		_g_object_unref0 (_tmp3_);
		_output_it = _tmp5_;
		while (TRUE) {
			GeeIterator* _tmp6_ = NULL;
			gboolean _tmp7_ = FALSE;
			GeeMapEntry* output = NULL;
			GeeIterator* _tmp8_ = NULL;
			gpointer _tmp9_ = NULL;
			GeeMapEntry* _tmp10_ = NULL;
			gconstpointer _tmp11_ = NULL;
			ChannelTab* _tmp12_ = NULL;
			GraniteWidgetsTab* _tmp13_ = NULL;
			GraniteWidgetsTab* _tmp14_ = NULL;
			_tmp6_ = _output_it;
			_tmp7_ = gee_iterator_next (_tmp6_);
			if (!_tmp7_) {
				break;
			}
			_tmp8_ = _output_it;
			_tmp9_ = gee_iterator_get (_tmp8_);
			output = (GeeMapEntry*) _tmp9_;
			_tmp10_ = output;
			_tmp11_ = gee_map_entry_get_value (_tmp10_);
			_tmp12_ = _tmp11_;
			_tmp13_ = ((ChannelTab*) _tmp12_)->tab;
			_tmp14_ = tab;
			if (_tmp13_ == _tmp14_) {
				GeeMapEntry* _tmp15_ = NULL;
				gconstpointer _tmp16_ = NULL;
				ChannelTab* _tmp17_ = NULL;
				gint _tmp18_ = 0;
				gint _tmp19_ = 0;
				_tmp15_ = output;
				_tmp16_ = gee_map_entry_get_value (_tmp15_);
				_tmp17_ = _tmp16_;
				_tmp18_ = channel_tab_get_tab_index ((ChannelTab*) _tmp17_);
				_tmp19_ = _tmp18_;
				result = _tmp19_;
				_g_object_unref0 (output);
				_g_object_unref0 (_output_it);
				return result;
			}
			_g_object_unref0 (output);
		}
		_g_object_unref0 (_output_it);
	}
	result = -1;
	return result;
}


static void main_window_new_subject (MainWindow* self, gint tab_id, const gchar* message) {
	gboolean _tmp0_ = FALSE;
	gint _tmp1_ = 0;
	gint _tmp2_ = 0;
	gchar* _tmp8_ = NULL;
	GeeHashMap* _tmp9_ = NULL;
	gint _tmp10_ = 0;
	gpointer _tmp11_ = NULL;
	ChannelTab* _tmp12_ = NULL;
	const gchar* _tmp13_ = NULL;
	gboolean _tmp14_ = FALSE;
	gchar* url = NULL;
	gchar* _tmp22_ = NULL;
	GtkLabel* _tmp23_ = NULL;
	const gchar* _tmp24_ = NULL;
	const gchar* _tmp25_ = NULL;
	gchar* _tmp26_ = NULL;
	gchar* _tmp27_ = NULL;
	GtkButton* _tmp28_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (message != NULL);
	_tmp1_ = tab_id;
	_tmp2_ = main_window_current_tab;
	if (_tmp1_ != _tmp2_) {
		_tmp0_ = TRUE;
	} else {
		const gchar* _tmp3_ = NULL;
		gchar* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		gint _tmp6_ = 0;
		gint _tmp7_ = 0;
		_tmp3_ = message;
		_tmp4_ = string_strip (_tmp3_);
		_tmp5_ = _tmp4_;
		_tmp6_ = strlen (_tmp5_);
		_tmp7_ = _tmp6_;
		_tmp0_ = _tmp7_ == 0;
		_g_free0 (_tmp5_);
	}
	if (_tmp0_) {
		return;
	}
	_tmp9_ = self->priv->outputs;
	_tmp10_ = tab_id;
	_tmp11_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp9_, (gpointer) ((gintptr) _tmp10_));
	_tmp12_ = (ChannelTab*) _tmp11_;
	_tmp13_ = _tmp12_->channel_url;
	_tmp14_ = g_strcmp0 (_tmp13_, "") != 0;
	_g_object_unref0 (_tmp12_);
	if (_tmp14_) {
		GeeHashMap* _tmp15_ = NULL;
		gint _tmp16_ = 0;
		gpointer _tmp17_ = NULL;
		ChannelTab* _tmp18_ = NULL;
		const gchar* _tmp19_ = NULL;
		gchar* _tmp20_ = NULL;
		_tmp15_ = self->priv->outputs;
		_tmp16_ = tab_id;
		_tmp17_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp15_, (gpointer) ((gintptr) _tmp16_));
		_tmp18_ = (ChannelTab*) _tmp17_;
		_tmp19_ = _tmp18_->channel_url;
		_tmp20_ = g_strconcat ("\n\n", _tmp19_, NULL);
		_g_free0 (_tmp8_);
		_tmp8_ = _tmp20_;
		_g_object_unref0 (_tmp18_);
	} else {
		gchar* _tmp21_ = NULL;
		_tmp21_ = g_strdup ("");
		_g_free0 (_tmp8_);
		_tmp8_ = _tmp21_;
	}
	_tmp22_ = g_strdup (_tmp8_);
	url = _tmp22_;
	_tmp23_ = self->priv->subject_text;
	_tmp24_ = message;
	_tmp25_ = url;
	_tmp26_ = g_strconcat (_tmp24_, _tmp25_, NULL);
	_tmp27_ = _tmp26_;
	gtk_label_set_text (_tmp23_, _tmp27_);
	_g_free0 (_tmp27_);
	_tmp28_ = self->priv->channel_subject;
	gtk_widget_show ((GtkWidget*) _tmp28_);
	_g_free0 (url);
	_g_free0 (_tmp8_);
}


void main_window_fill_input (const gchar* message) {
	GtkEntry* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	GtkEntry* _tmp2_ = NULL;
	GtkEntry* _tmp3_ = NULL;
	const gchar* _tmp4_ = NULL;
	gint _tmp5_ = 0;
	gint _tmp6_ = 0;
	const gchar* _tmp7_ = NULL;
	gint _tmp8_ = 0;
	gint _tmp9_ = 0;
	g_return_if_fail (message != NULL);
	_tmp0_ = main_window_input;
	_tmp1_ = message;
	gtk_entry_set_text (_tmp0_, _tmp1_);
	_tmp2_ = main_window_input;
	g_object_set ((GtkWidget*) _tmp2_, "is-focus", TRUE, NULL);
	_tmp3_ = main_window_input;
	_tmp4_ = message;
	_tmp5_ = strlen (_tmp4_);
	_tmp6_ = _tmp5_;
	_tmp7_ = message;
	_tmp8_ = strlen (_tmp7_);
	_tmp9_ = _tmp8_;
	gtk_editable_select_region ((GtkEditable*) _tmp3_, _tmp6_, _tmp9_);
}


void main_window_file_uploaded (MainWindow* self, const gchar* url) {
	GtkEntry* _tmp0_ = NULL;
	GtkEntry* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	gchar* _tmp4_ = NULL;
	const gchar* _tmp5_ = NULL;
	gchar* _tmp6_ = NULL;
	gchar* _tmp7_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (url != NULL);
	_tmp0_ = main_window_input;
	_tmp1_ = main_window_input;
	_tmp2_ = gtk_entry_get_text (_tmp1_);
	_tmp3_ = g_strconcat (_tmp2_, " ", NULL);
	_tmp4_ = _tmp3_;
	_tmp5_ = url;
	_tmp6_ = g_strconcat (_tmp4_, _tmp5_, NULL);
	_tmp7_ = _tmp6_;
	gtk_entry_set_text (_tmp0_, _tmp7_);
	_g_free0 (_tmp7_);
	_g_free0 (_tmp4_);
}


static void main_window_load_autoconnect (MainWindow* self) {
	gboolean opened_tab = FALSE;
	g_return_if_fail (self != NULL);
	opened_tab = FALSE;
	{
		GeeIterator* _server_it = NULL;
		GeeHashMap* _tmp0_ = NULL;
		GeeSet* _tmp1_ = NULL;
		GeeSet* _tmp2_ = NULL;
		GeeSet* _tmp3_ = NULL;
		GeeIterator* _tmp4_ = NULL;
		GeeIterator* _tmp5_ = NULL;
		_tmp0_ = sql_client_servers;
		_tmp1_ = gee_abstract_map_get_entries ((GeeMap*) _tmp0_);
		_tmp2_ = _tmp1_;
		_tmp3_ = _tmp2_;
		_tmp4_ = gee_iterable_iterator ((GeeIterable*) _tmp3_);
		_tmp5_ = _tmp4_;
		_g_object_unref0 (_tmp3_);
		_server_it = _tmp5_;
		while (TRUE) {
			GeeIterator* _tmp6_ = NULL;
			gboolean _tmp7_ = FALSE;
			GeeMapEntry* server = NULL;
			GeeIterator* _tmp8_ = NULL;
			gpointer _tmp9_ = NULL;
			GeeLinkedList* to_connect = NULL;
			GeeMapEntry* _tmp10_ = NULL;
			gconstpointer _tmp11_ = NULL;
			SqlClientServer* _tmp12_ = NULL;
			GeeLinkedList* _tmp13_ = NULL;
			GeeLinkedList* _tmp14_ = NULL;
			gint _tmp15_ = 0;
			gint _tmp16_ = 0;
			_tmp6_ = _server_it;
			_tmp7_ = gee_iterator_next (_tmp6_);
			if (!_tmp7_) {
				break;
			}
			_tmp8_ = _server_it;
			_tmp9_ = gee_iterator_get (_tmp8_);
			server = (GeeMapEntry*) _tmp9_;
			_tmp10_ = server;
			_tmp11_ = gee_map_entry_get_value (_tmp10_);
			_tmp12_ = _tmp11_;
			_tmp13_ = sql_client_server_get_autoconnect_channels ((SqlClientServer*) _tmp12_);
			to_connect = _tmp13_;
			_tmp14_ = to_connect;
			_tmp15_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp14_);
			_tmp16_ = _tmp15_;
			if (_tmp16_ > 0) {
				GeeMapEntry* _tmp17_ = NULL;
				gconstpointer _tmp18_ = NULL;
				SqlClientServer* _tmp19_ = NULL;
				GeeLinkedList* _tmp20_ = NULL;
				opened_tab = TRUE;
				_tmp17_ = server;
				_tmp18_ = gee_map_entry_get_value (_tmp17_);
				_tmp19_ = _tmp18_;
				_tmp20_ = to_connect;
				main_window_add_server (self, (SqlClientServer*) _tmp19_, _tmp20_);
			}
			_g_object_unref0 (to_connect);
			_g_object_unref0 (server);
		}
		_g_object_unref0 (_server_it);
	}
}


static void __lambda42_ (MainWindow* self, gint index) {
	gint _tmp0_ = 0;
	_tmp0_ = index;
	switch (_tmp0_) {
		case 0:
		{
			ServerManager* _tmp1_ = NULL;
			_tmp1_ = main_window_server_manager;
			server_manager_open_window (_tmp1_);
			return;
		}
		case 1:
		{
			main_window_new_tab_requested (self);
			return;
		}
		case 2:
		{
			main_window_slide_panel (self);
			return;
		}
		default:
		break;
	}
}


static void ___lambda42__granite_widgets_welcome_activated (GraniteWidgetsWelcome* _sender, gint index, gpointer self) {
	__lambda42_ ((MainWindow*) self, index);
}


static void main_window_show_welcome_screen (MainWindow* self) {
	gchar* title = NULL;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	gchar* message = NULL;
	const gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	GraniteWidgetsWelcome* welcome = NULL;
	const gchar* _tmp4_ = NULL;
	const gchar* _tmp5_ = NULL;
	GraniteWidgetsWelcome* _tmp6_ = NULL;
	GraniteWidgetsWelcome* _tmp7_ = NULL;
	gchar* _tmp8_ = NULL;
	gchar* _tmp9_ = NULL;
	GtkImage* _tmp10_ = NULL;
	GtkImage* _tmp11_ = NULL;
	const gchar* _tmp12_ = NULL;
	const gchar* _tmp13_ = NULL;
	GraniteWidgetsWelcome* _tmp14_ = NULL;
	gchar* _tmp15_ = NULL;
	gchar* _tmp16_ = NULL;
	GtkImage* _tmp17_ = NULL;
	GtkImage* _tmp18_ = NULL;
	const gchar* _tmp19_ = NULL;
	const gchar* _tmp20_ = NULL;
	const gchar* _tmp21_ = NULL;
	Settings* _tmp22_ = NULL;
	gboolean _tmp23_ = FALSE;
	GraniteWidgetsWelcome* _tmp26_ = NULL;
	gchar* _tmp27_ = NULL;
	gchar* _tmp28_ = NULL;
	GtkImage* _tmp29_ = NULL;
	GtkImage* _tmp30_ = NULL;
	const gchar* _tmp31_ = NULL;
	const gchar* _tmp32_ = NULL;
	GraniteWidgetsTab* tab = NULL;
	GraniteWidgetsTab* _tmp33_ = NULL;
	const gchar* _tmp34_ = NULL;
	GtkHeaderBar* _tmp35_ = NULL;
	Relay* _tmp36_ = NULL;
	const gchar* _tmp37_ = NULL;
	GtkHeaderBar* _tmp38_ = NULL;
	GtkHeaderBar* _tmp39_ = NULL;
	GraniteWidgetsWelcome* _tmp40_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp41_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp42_ = NULL;
	Settings* _tmp43_ = NULL;
	gboolean _tmp44_ = FALSE;
	GraniteWidgetsWelcome* _tmp45_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = _ ("Welcome to Relay");
	_tmp1_ = g_strdup (_tmp0_);
	title = _tmp1_;
	_tmp2_ = _ ("Lets get started");
	_tmp3_ = g_strdup (_tmp2_);
	message = _tmp3_;
	_tmp4_ = title;
	_tmp5_ = message;
	_tmp6_ = granite_widgets_welcome_new (_tmp4_, _tmp5_);
	g_object_ref_sink (_tmp6_);
	welcome = _tmp6_;
	_tmp7_ = welcome;
	_tmp8_ = relay_get_asset_file ("assets/manage-servers.png");
	_tmp9_ = _tmp8_;
	_tmp10_ = (GtkImage*) gtk_image_new_from_file (_tmp9_);
	g_object_ref_sink (_tmp10_);
	_tmp11_ = _tmp10_;
	_tmp12_ = _ ("Manage");
	_tmp13_ = _ ("Manage the servers you use");
	granite_widgets_welcome_append_with_image (_tmp7_, _tmp11_, _tmp12_, _tmp13_);
	_g_object_unref0 (_tmp11_);
	_g_free0 (_tmp9_);
	_tmp14_ = welcome;
	_tmp15_ = relay_get_asset_file ("assets/connect-server.png");
	_tmp16_ = _tmp15_;
	_tmp17_ = (GtkImage*) gtk_image_new_from_file (_tmp16_);
	g_object_ref_sink (_tmp17_);
	_tmp18_ = _tmp17_;
	_tmp19_ = _ ("Connect");
	_tmp20_ = _ ("Connect to a single server");
	granite_widgets_welcome_append_with_image (_tmp14_, _tmp18_, _tmp19_, _tmp20_);
	_g_object_unref0 (_tmp18_);
	_g_free0 (_tmp16_);
	_tmp22_ = main_window_settings;
	_tmp23_ = settings_get_bool (_tmp22_, "show_sidebar");
	if (_tmp23_) {
		const gchar* _tmp24_ = NULL;
		_tmp24_ = _ ("Your sidepanel is already open");
		_tmp21_ = _tmp24_;
	} else {
		const gchar* _tmp25_ = NULL;
		_tmp25_ = _ ("Connect to a saved server");
		_tmp21_ = _tmp25_;
	}
	_tmp26_ = welcome;
	_tmp27_ = relay_get_asset_file ("assets/saved-server.png");
	_tmp28_ = _tmp27_;
	_tmp29_ = (GtkImage*) gtk_image_new_from_file (_tmp28_);
	g_object_ref_sink (_tmp29_);
	_tmp30_ = _tmp29_;
	_tmp31_ = _ ("Saved");
	_tmp32_ = _ (_tmp21_);
	granite_widgets_welcome_append_with_image (_tmp26_, _tmp30_, _tmp31_, _tmp32_);
	_g_object_unref0 (_tmp30_);
	_g_free0 (_tmp28_);
	_tmp33_ = granite_widgets_tab_new ("", NULL, NULL);
	g_object_ref_sink (_tmp33_);
	tab = _tmp33_;
	granite_widgets_tab_set_icon (tab, NULL);
	_tmp34_ = _ ("Welcome");
	granite_widgets_tab_set_label (tab, _tmp34_);
	_tmp35_ = self->priv->toolbar;
	_tmp36_ = self->priv->app;
	_tmp37_ = ((GraniteApplication*) _tmp36_)->program_name;
	gtk_header_bar_set_title (_tmp35_, _tmp37_);
	_tmp38_ = self->priv->toolbar;
	gtk_header_bar_set_subtitle (_tmp38_, "");
	_tmp39_ = self->priv->toolbar;
	gtk_header_bar_set_has_subtitle (_tmp39_, FALSE);
	_tmp40_ = welcome;
	granite_widgets_tab_set_page (tab, (GtkWidget*) _tmp40_);
	_tmp41_ = self->priv->tabs;
	granite_widgets_dynamic_notebook_insert_tab (_tmp41_, tab, -1);
	_tmp42_ = self->priv->tabs;
	_tmp43_ = main_window_settings;
	_tmp44_ = settings_get_bool (_tmp43_, "show_tabs");
	granite_widgets_dynamic_notebook_set_show_tabs (_tmp42_, _tmp44_);
	_tmp45_ = welcome;
	g_signal_connect_object (_tmp45_, "activated", (GCallback) ___lambda42__granite_widgets_welcome_activated, self, 0);
	_g_object_unref0 (tab);
	_g_object_unref0 (welcome);
	_g_free0 (message);
	_g_free0 (title);
}


static gboolean __lambda41_ (MainWindow* self, GdkEventButton* event) {
	gboolean result = FALSE;
	ServerManager* _tmp0_ = NULL;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = main_window_server_manager;
	server_manager_open_window (_tmp0_);
	result = FALSE;
	return result;
}


static gboolean ___lambda41__gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda41_ ((MainWindow*) self, event);
	return result;
}


void main_window_set_up_add_sever (MainWindow* self, GtkBuilder* builder) {
	GtkButton* add_server_button = NULL;
	GtkBuilder* _tmp0_ = NULL;
	GObject* _tmp1_ = NULL;
	GtkButton* _tmp2_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (builder != NULL);
	_tmp0_ = builder;
	_tmp1_ = gtk_builder_get_object (_tmp0_, "manage_servers");
	_tmp2_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp1_, gtk_button_get_type ()) ? ((GtkButton*) _tmp1_) : NULL);
	add_server_button = _tmp2_;
	g_signal_connect_object ((GtkWidget*) add_server_button, "button-release-event", (GCallback) ___lambda41__gtk_widget_button_release_event, self, 0);
	_g_object_unref0 (add_server_button);
}


static gboolean __lambda29_ (MainWindow* self, GeeMapEntry* tab) {
	gboolean result = FALSE;
	GeeMapEntry* usetab = NULL;
	GeeMapEntry* _tmp0_ = NULL;
	GeeMapEntry* _tmp1_ = NULL;
	gconstpointer _tmp2_ = NULL;
	ChannelTab* _tmp3_ = NULL;
	g_return_val_if_fail (tab != NULL, FALSE);
	_tmp0_ = tab;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	usetab = _tmp1_;
	_tmp2_ = gee_map_entry_get_value (usetab);
	_tmp3_ = _tmp2_;
	channel_tab_update_tag_table ((ChannelTab*) _tmp3_);
	result = TRUE;
	_g_object_unref0 (usetab);
	_g_object_unref0 (tab);
	return result;
}


static gboolean ___lambda29__gee_forall_func (gpointer g, gpointer self) {
	gboolean result;
	result = __lambda29_ ((MainWindow*) self, (GeeMapEntry*) g);
	return result;
}


void main_window_tags_refresh (MainWindow* self) {
	GeeHashMap* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->outputs;
	gee_abstract_map_foreach ((GeeAbstractMap*) _tmp0_, ___lambda29__gee_forall_func, self);
}


static void main_window_save_output_to_file (MainWindow* self, const gchar* text) {
	GtkFileChooserDialog* chooser = NULL;
	const gchar* _tmp0_ = NULL;
	GtkWindow* _tmp1_ = NULL;
	GtkFileChooserDialog* _tmp2_ = NULL;
	GtkFileChooserDialog* _tmp3_ = NULL;
	GtkFileChooserDialog* _tmp4_ = NULL;
	GeeHashMap* _tmp5_ = NULL;
	gint _tmp6_ = 0;
	gpointer _tmp7_ = NULL;
	ChannelTab* _tmp8_ = NULL;
	const gchar* _tmp9_ = NULL;
	const gchar* _tmp10_ = NULL;
	GtkFileChooserDialog* _tmp11_ = NULL;
	const gchar* _tmp12_ = NULL;
	gint resp = 0;
	GtkFileChooserDialog* _tmp13_ = NULL;
	gint _tmp14_ = 0;
	gint _tmp15_ = 0;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (text != NULL);
	_tmp0_ = _ ("Save the conversation");
	_tmp1_ = main_window_window;
	_tmp2_ = (GtkFileChooserDialog*) gtk_file_chooser_dialog_new (_tmp0_, _tmp1_, GTK_FILE_CHOOSER_ACTION_SAVE, "_Cancel", GTK_RESPONSE_CANCEL, "_Save", GTK_RESPONSE_ACCEPT, NULL, NULL);
	g_object_ref_sink (_tmp2_);
	chooser = _tmp2_;
	_tmp3_ = chooser;
	gtk_file_chooser_set_do_overwrite_confirmation ((GtkFileChooser*) _tmp3_, TRUE);
	_tmp4_ = chooser;
	_tmp5_ = self->priv->outputs;
	_tmp6_ = main_window_current_tab;
	_tmp7_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp5_, (gpointer) ((gintptr) _tmp6_));
	_tmp8_ = (ChannelTab*) _tmp7_;
	_tmp9_ = channel_tab_get_channel_name (_tmp8_);
	_tmp10_ = _tmp9_;
	gtk_file_chooser_set_filename ((GtkFileChooser*) _tmp4_, _tmp10_);
	_g_object_unref0 (_tmp8_);
	_tmp11_ = chooser;
	_tmp12_ = g_get_home_dir ();
	gtk_file_chooser_set_current_folder ((GtkFileChooser*) _tmp11_, _tmp12_);
	_tmp13_ = chooser;
	_tmp14_ = gtk_dialog_run ((GtkDialog*) _tmp13_);
	resp = _tmp14_;
	_tmp15_ = resp;
	if (_tmp15_ == ((gint) GTK_RESPONSE_ACCEPT)) {
		GtkFileChooserDialog* _tmp22_ = NULL;
		{
			GtkFileChooserDialog* _tmp16_ = NULL;
			gchar* _tmp17_ = NULL;
			gchar* _tmp18_ = NULL;
			const gchar* _tmp19_ = NULL;
			_tmp16_ = chooser;
			_tmp17_ = gtk_file_chooser_get_filename ((GtkFileChooser*) _tmp16_);
			_tmp18_ = _tmp17_;
			_tmp19_ = text;
			g_file_set_contents (_tmp18_, _tmp19_, (gssize) -1, &_inner_error_);
			_g_free0 (_tmp18_);
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				if (_inner_error_->domain == G_FILE_ERROR) {
					goto __catch1_g_file_error;
				}
				_g_object_unref0 (chooser);
				g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
				g_clear_error (&_inner_error_);
				return;
			}
		}
		goto __finally1;
		__catch1_g_file_error:
		{
			GError* e = NULL;
			GError* _tmp20_ = NULL;
			const gchar* _tmp21_ = NULL;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp20_ = e;
			_tmp21_ = _tmp20_->message;
			relay_show_error_window (_tmp21_);
			_g_error_free0 (e);
		}
		__finally1:
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_object_unref0 (chooser);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return;
		}
		_tmp22_ = chooser;
		g_signal_emit_by_name ((GtkDialog*) _tmp22_, "close");
	} else {
		GtkFileChooserDialog* _tmp23_ = NULL;
		_tmp23_ = chooser;
		g_signal_emit_by_name ((GtkDialog*) _tmp23_, "close");
	}
	_g_object_unref0 (chooser);
}


void main_window_relay_close_program (MainWindow* self) {
	g_return_if_fail (self != NULL);
	{
		GeeIterator* _client_it = NULL;
		GeeHashMap* _tmp0_ = NULL;
		GeeSet* _tmp1_ = NULL;
		GeeSet* _tmp2_ = NULL;
		GeeSet* _tmp3_ = NULL;
		GeeIterator* _tmp4_ = NULL;
		GeeIterator* _tmp5_ = NULL;
		_tmp0_ = self->priv->clients;
		_tmp1_ = gee_abstract_map_get_entries ((GeeMap*) _tmp0_);
		_tmp2_ = _tmp1_;
		_tmp3_ = _tmp2_;
		_tmp4_ = gee_iterable_iterator ((GeeIterable*) _tmp3_);
		_tmp5_ = _tmp4_;
		_g_object_unref0 (_tmp3_);
		_client_it = _tmp5_;
		while (TRUE) {
			GeeIterator* _tmp6_ = NULL;
			gboolean _tmp7_ = FALSE;
			GeeMapEntry* client = NULL;
			GeeIterator* _tmp8_ = NULL;
			gpointer _tmp9_ = NULL;
			GeeMapEntry* _tmp10_ = NULL;
			gconstpointer _tmp11_ = NULL;
			Connection* _tmp12_ = NULL;
			_tmp6_ = _client_it;
			_tmp7_ = gee_iterator_next (_tmp6_);
			if (!_tmp7_) {
				break;
			}
			_tmp8_ = _client_it;
			_tmp9_ = gee_iterator_get (_tmp8_);
			client = (GeeMapEntry*) _tmp9_;
			_tmp10_ = client;
			_tmp11_ = gee_map_entry_get_value (_tmp10_);
			_tmp12_ = _tmp11_;
			connection_do_exit ((Connection*) _tmp12_);
			_g_object_unref0 (client);
		}
		_g_object_unref0 (_client_it);
	}
	exit (0);
}


void main_window_on_destroy (GtkWidget* window, MainWindow* self) {
	g_return_if_fail (self != NULL);
	g_return_if_fail (window != NULL);
	gtk_main_quit ();
}


static void main_window_class_init (MainWindowClass * klass) {
	GeeHashMap* _tmp0_ = NULL;
	GtkButton* _tmp1_ = NULL;
	GtkBox* _tmp2_ = NULL;
	SqlClient* _tmp3_ = NULL;
	Settings* _tmp4_ = NULL;
	ServerManager* _tmp5_ = NULL;
	UnityLauncherEntry* _tmp6_ = NULL;
	main_window_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (MainWindowPrivate));
	G_OBJECT_CLASS (klass)->finalize = main_window_finalize;
	_tmp0_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, GRANITE_WIDGETS_SOURCE_LIST_TYPE_ITEM, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
	main_window_items_sidebar = _tmp0_;
	_tmp1_ = (GtkButton*) gtk_button_new ();
	g_object_ref_sink (_tmp1_);
	main_window_paste = _tmp1_;
	_tmp2_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_HORIZONTAL, 0);
	g_object_ref_sink (_tmp2_);
	main_window_paste_box = _tmp2_;
	_tmp3_ = sql_client_get_instance ();
	main_window_sql_client = _tmp3_;
	_tmp4_ = settings_new ();
	main_window_settings = _tmp4_;
	_tmp5_ = server_manager_new ();
	main_window_server_manager = _tmp5_;
	_tmp6_ = unity_launcher_entry_get_for_desktop_id (PACKAGE_NAME ".desktop");
	main_window_launcher = _tmp6_;
}


static void main_window_instance_init (MainWindow * self) {
	GtkMenu* _tmp0_ = NULL;
	GtkMenu* _tmp1_ = NULL;
	DragFile* _tmp2_ = NULL;
	GtkButton* _tmp3_ = NULL;
	GtkLabel* _tmp4_ = NULL;
	GtkButton* _tmp5_ = NULL;
	GtkHeaderBar* _tmp6_ = NULL;
	GtkLabel* _tmp7_ = NULL;
	GtkBox* _tmp8_ = NULL;
	GtkScrolledWindow* _tmp9_ = NULL;
	GtkMenu* _tmp10_ = NULL;
	gchar* _tmp11_ = NULL;
	GtkSearchEntry* _tmp12_ = NULL;
	GraniteWidgetsDynamicNotebook* _tmp13_ = NULL;
	GeeHashMap* _tmp14_ = NULL;
	GeeHashMap* _tmp15_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp16_ = NULL;
	GraniteWidgetsSourceListExpandableItem* _tmp17_ = NULL;
	GraniteWidgetsSourceList* _tmp18_ = NULL;
	self->priv = MAIN_WINDOW_GET_PRIVATE (self);
	_tmp0_ = (GtkMenu*) gtk_menu_new ();
	g_object_ref_sink (_tmp0_);
	self->priv->tab_rightclick = _tmp0_;
	_tmp1_ = (GtkMenu*) gtk_menu_new ();
	g_object_ref_sink (_tmp1_);
	self->priv->tab_channel_list = _tmp1_;
	_tmp2_ = drag_file_new ();
	self->priv->drag_file = _tmp2_;
	_tmp3_ = (GtkButton*) gtk_button_new ();
	g_object_ref_sink (_tmp3_);
	self->priv->channel_users = _tmp3_;
	_tmp4_ = (GtkLabel*) gtk_label_new ("");
	g_object_ref_sink (_tmp4_);
	self->priv->subject_text = _tmp4_;
	_tmp5_ = (GtkButton*) gtk_button_new ();
	g_object_ref_sink (_tmp5_);
	self->priv->channel_subject = _tmp5_;
	_tmp6_ = (GtkHeaderBar*) gtk_header_bar_new ();
	g_object_ref_sink (_tmp6_);
	self->priv->toolbar = _tmp6_;
	_tmp7_ = (GtkLabel*) gtk_label_new ("");
	g_object_ref_sink (_tmp7_);
	self->priv->users_header = _tmp7_;
	_tmp8_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_HORIZONTAL, 0);
	g_object_ref_sink (_tmp8_);
	self->priv->users_list = _tmp8_;
	_tmp9_ = (GtkScrolledWindow*) gtk_scrolled_window_new (NULL, NULL);
	g_object_ref_sink (_tmp9_);
	self->priv->users_scrolled = _tmp9_;
	_tmp10_ = (GtkMenu*) gtk_menu_new ();
	g_object_ref_sink (_tmp10_);
	self->priv->user_menu = _tmp10_;
	_tmp11_ = g_strdup ("");
	self->priv->channel_user_selected = _tmp11_;
	_tmp12_ = (GtkSearchEntry*) gtk_search_entry_new ();
	g_object_ref_sink (_tmp12_);
	self->priv->users_search = _tmp12_;
	_tmp13_ = granite_widgets_dynamic_notebook_new ();
	g_object_ref_sink (_tmp13_);
	self->priv->tabs = _tmp13_;
	_tmp14_ = gee_hash_map_new (G_TYPE_INT, NULL, NULL, TYPE_CHANNEL_TAB, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
	self->priv->outputs = _tmp14_;
	_tmp15_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, TYPE_CONNECTION, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
	self->priv->clients = _tmp15_;
	_tmp16_ = granite_widgets_source_list_expandable_item_new ("");
	_tmp17_ = _tmp16_;
	_tmp18_ = granite_widgets_source_list_new (_tmp17_);
	g_object_ref_sink (_tmp18_);
	self->priv->servers = _tmp18_;
	_g_object_unref0 (_tmp17_);
	self->priv->invoke_count = 0;
	self->priv->sliding = 0;
}


static void main_window_finalize (GObject* obj) {
	MainWindow * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, TYPE_MAIN_WINDOW, MainWindow);
	_g_object_unref0 (self->priv->app);
	_g_object_unref0 (self->priv->panel);
	_g_object_unref0 (self->priv->tab_rightclick);
	_g_object_unref0 (self->priv->tab_channel_list);
	_g_object_unref0 (self->priv->drag_file);
	_g_object_unref0 (self->priv->channel_users);
	_g_object_unref0 (self->priv->subject_text);
	_g_object_unref0 (self->priv->channel_subject);
	_g_object_unref0 (self->priv->toolbar);
	_g_object_unref0 (self->priv->users_popover);
	_g_object_unref0 (self->priv->users_header);
	_g_object_unref0 (self->priv->users_list);
	_g_object_unref0 (self->priv->users_scrolled);
	_g_object_unref0 (self->priv->user_menu);
	_g_free0 (self->priv->channel_user_selected);
	_g_object_unref0 (self->priv->users_search);
	_g_object_unref0 (self->priv->tabs);
	_g_object_unref0 (self->priv->outputs);
	_g_object_unref0 (self->priv->clients);
	_g_object_unref0 (self->priv->servers);
	G_OBJECT_CLASS (main_window_parent_class)->finalize (obj);
}


GType main_window_get_type (void) {
	static volatile gsize main_window_type_id__volatile = 0;
	if (g_once_init_enter (&main_window_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (MainWindowClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) main_window_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MainWindow), 0, (GInstanceInitFunc) main_window_instance_init, NULL };
		GType main_window_type_id;
		main_window_type_id = g_type_register_static (G_TYPE_OBJECT, "MainWindow", &g_define_type_info, 0);
		g_once_init_leave (&main_window_type_id__volatile, main_window_type_id);
	}
	return main_window_type_id__volatile;
}



